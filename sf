warning: LF will be replaced by CRLF in .idea/compiler.xml.
The file will have its original line endings in your working directory.
[1mdiff --git a/.gitignore b/.gitignore[m
[1mindex c9c2248..4556cd7 100644[m
[1m--- a/.gitignore[m
[1m+++ b/.gitignore[m
[36m@@ -1,3 +1,15 @@[m
[32m+[m[32m<<<<<<< HEAD[m
[32m+[m[32m*.iml[m
[32m+[m[32m.gradle[m
[32m+[m[32m/local.properties[m
[32m+[m[32m/.idea/workspace.xml[m
[32m+[m[32m/.idea/libraries[m
[32m+[m[32m.DS_Store[m
[32m+[m[32m/build[m
[32m+[m[32m/captures[m
[32m+[m[32m/bin[m
[32m+[m[32m/gen[m
[32m+[m[32m=======[m
 # Built application files[m
 *.apk[m
 *.ap_[m
[36m@@ -30,3 +42,4 @@[m [mproguard/[m
 [m
 # Android Studio captures folder[m
 captures/[m
[32m+[m[32m>>>>>>> 313513110c50cee2c21e70f3590413d871feb8d9[m
[1mdiff --git a/.idea/.name b/.idea/.name[m
[1mnew file mode 100644[m
[1mindex 0000000..deee449[m
[1m--- /dev/null[m
[1m+++ b/.idea/.name[m
[36m@@ -0,0 +1 @@[m
[32m+[m[32mCoordinateMap[m
\ No newline at end of file[m
[1mdiff --git a/.idea/compiler.xml b/.idea/compiler.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..96cc43e[m
[1m--- /dev/null[m
[1m+++ b/.idea/compiler.xml[m
[36m@@ -0,0 +1,22 @@[m
[32m+[m[32m<?xml version="1.0" encoding="UTF-8"?>[m
[32m+[m[32m<project version="4">[m
[32m+[m[32m  <component name="CompilerConfiguration">[m
[32m+[m[32m    <resourceExtensions />[m
[32m+[m[32m    <wildcardResourcePatterns>[m
[32m+[m[32m      <entry name="!?*.java" />[m
[32m+[m[32m      <entry name="!?*.form" />[m
[32m+[m[32m      <entry name="!?*.class" />[m
[32m+[m[32m      <entry name="!?*.groovy" />[m
[32m+[m[32m      <entry name="!?*.scala" />[m
[32m+[m[32m      <entry name="!?*.flex" />[m
[32m+[m[32m      <entry name="!?*.kt" />[m
[32m+[m[32m      <entry name="!?*.clj" />[m
[32m+[m[32m      <entry name="!?*.aj" />[m
[32m+[m[32m    </wildcardResourcePatterns>[m
[32m+[m[32m    <annotationProcessing>[m
[32m+[m[32m      <profile default="true" name="Default" enabled="false">[m
[32m+[m[32m        <processorPath useClasspath="true" />[m
[32m+[m[32m      </profile>[m
[32m+[m[32m    </annotationProcessing>[m
[32m+[m[32m  </component>[m
[32m+[m[32m</project>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/copyright/profiles_settings.xml b/.idea/copyright/profiles_settings.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..e7bedf3[m
[1m--- /dev/null[m
[1m+++ b/.idea/copyright/profiles_settings.xml[m
[36m@@ -0,0 +1,3 @@[m
[32m+[m[32m<component name="CopyrightManager">[m
[32m+[m[32m  <settings default="" />[m
[32m+[m[32m</component>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/dictionaries/Administrator.xml b/.idea/dictionaries/Administrator.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..fe3cdca[m
[1m--- /dev/null[m
[1m+++ b/.idea/dictionaries/Administrator.xml[m
[36m@@ -0,0 +1,8 @@[m
[32m+[m[32m<component name="ProjectDictionaryState">[m
[32m+[m[32m  <dictionary name="Administrator">[m
[32m+[m[32m    <words>[m
[32m+[m[32m      <w>coord</w>[m
[32m+[m[32m      <w>stye</w>[m
[32m+[m[32m    </words>[m
[32m+[m[32m  </dictionary>[m
[32m+[m[32m</component>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/encodings.xml b/.idea/encodings.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..fcb4a28[m
[1m--- /dev/null[m
[1m+++ b/.idea/encodings.xml[m
[36m@@ -0,0 +1,11 @@[m
[32m+[m[32m<?xml version="1.0" encoding="UTF-8"?>[m
[32m+[m[32m<project version="4">[m
[32m+[m[32m  <component name="Encoding">[m
[32m+[m[32m    <file url="file://$PROJECT_DIR$/app/src/main/res/mipmap-hdpi/ex_doc.png" charset="GBK" />[m
[32m+[m[32m    <file url="file://$PROJECT_DIR$/app/src/main/res/mipmap-hdpi/ex_folder.png" charset="GBK" />[m
[32m+[m[32m    <file url="file://$PROJECT_DIR$/app/src/main/res/mipmap-mdpi/actionbar_add_icon.png" charset="GBK" />[m
[32m+[m[32m    <file url="file://$PROJECT_DIR$/app/src/main/res/mipmap-mdpi/actionbar_more_icon.png" charset="GBK" />[m
[32m+[m[32m    <file url="file://$PROJECT_DIR$/app/src/main/res/warning: LF will be replaced by CRLF in .idea/encodings.xml.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in .idea/gradle.xml.
The file will have its original line endings in your working directory.
mipmap-mdpi/actionbar_search_icon.png" charset="GBK" />[m
[32m+[m[32m    <file url="PROJECT" charset="UTF-8" />[m
[32m+[m[32m  </component>[m
[32m+[m[32m</project>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/gradle.xml b/.idea/gradle.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..751c7f0[m
[1m--- /dev/null[m
[1m+++ b/.idea/gradle.xml[m
[36m@@ -0,0 +1,20 @@[m
[32m+[m[32m<?xml version="1.0" encoding="UTF-8"?>[m
[32m+[m[32m<project version="4">[m
[32m+[m[32m  <component name="GradleSettings">[m
[32m+[m[32m    <option name="linkedExternalProjectsSettings">[m
[32m+[m[32m      <GradleProjectSettings>[m
[32m+[m[32m        <option name="distributionType" value="LOCAL" />[m
[32m+[m[32m        <option name="externalProjectPath" value="$PROJECT_DIR$" />[m
[32m+[m[32m        <option name="gradleHome" value="D:\Program Files\Android Studio\gradle\gradle-2.8" />[m
[32m+[m[32m        <option name="gradleJvm" value="1.7" />[m
[32m+[m[32m        <option name="modules">[m
[32m+[m[32m          <set>[m
[32m+[m[32m            <option value="$PROJECT_DIR$" />[m
[32m+[m[32m            <option value="$PROJECT_DIR$/app" />[m
[32m+[m[32m            <option value="$PROJECT_DIR$/daogenerator" />[m
[32m+[m[32m          </set>[m
[32m+[m[32m        </option>[m
[32m+[m[32m      </GradleProjectSettings>[m
[32m+[m[32m    </option>[m
[32m+[m[32m  </component>[m
[32m+[m[32m</project>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/misc.xml b/.idea/misc.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..1a3eaff[m
[1m--- /dev/null[m
[1m+++ b/.idea/misc.xml[m
[36m@@ -0,0 +1,46 @@[m
[32m+[m[32m<?xml version="1.0" encoding="UTF-8"?>[m
[32m+[m[32m<project version="4">[m
[32m+[m[32m  <component name="EntryPointsManager">[m
[32m+[m[32m    <entry_points version="2.0" />[m
[32m+[m[32m  </component>[m
[32m+[m[32m  <component name="NullableNotNullManager">[m
[32m+[m[32m    <option name="myDefaultNullable" value="android.support.annotation.Nullable" />[m
[32m+[m[32m    <option name="myDefaultNotNull" value="android.support.annotation.NonNull" />[m
[32m+[m[32m    <option name="myNullables">[m
[32m+[m[32m      <value>[m
[32m+[m[32m        <list size="4">[m
[32m+[m[32m          <item index="0" class="java.lang.String" itemvalue="org.jetbrains.annotations.Nullable" />[m
[32m+[m[32m          <item index="1" class="java.lang.String" itemvalue="javax.annotation.Nullable" />[m
[32m+[m[32m          <item index="2" class="java.lang.String" itemvalue="edu.umd.cs.findbugs.annotations.Nullable" />[m
[32m+[m[32m          <item index="3" class="java.lang.String" itemvalue="android.support.annotation.Nullable" />[m
[32m+[m[32m        </list>[m
[32m+[m[32m      </value>[m
[32m+[m[32m    </option>[m
[32m+[m[32m    <option name="myNotNulls">[m
[32m+[m[32m      <value>[m
[32m+[m[32m        <list size="4">[m
[32m+[m[32m          <item index="0" class="java.lang.String" itemvalue="org.jetbrains.annotations.NotNull" />[m
[32m+[m[32m          <item index="1" class="java.lang.String" itemvalue="javax.annotation.Nonnull" />[m
[32m+[m[32m          <item index="2" class="java.lang.String" itemvalue="edu.umd.cs.findbugs.annotations.NonNull" />[m
[32m+[m[32m          <item index="3" class="java.lang.String" itemvalue="android.support.annotation.NonNull" />[m
[32m+[m[32m        </list>[m
[32m+[m[32m      </value>[m
[32m+[m[32m    </option>[m
[32m+[m[32m  </component>[m
[32m+[m[32m  <component name="ProjectLevelVcsManager" settingsEditedManually="false">[m
[32m+[m[32m    <OptionsSetting value="true" id="Add" />[m
[32m+[m[32m    <OptionsSetting value="true" id="Remove" />[m
[32m+[m[32m    <OptionsSetting value="true" id="Checkout" />[m
[32m+[m[32m    <OptionsSetting value="true" id="Update" />[m
[32m+[m[32m    <OptionsSetting value="true" id="Status" />[m
[32m+[m[32m    <OptionsSetting value="true" id="Edit" />[m
[32m+[m[3warning: LF will be replaced by CRLF in .idea/misc.xml.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in .idea/modules.xml.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in .idea/runConfigurations.xml.
The file will have its original line endings in your working directory.
2m    <ConfirmationsSetting value="0" id="Add" />[m
[32m+[m[32m    <ConfirmationsSetting value="0" id="Remove" />[m
[32m+[m[32m  </component>[m
[32m+[m[32m  <component name="ProjectRootManager" version="2" languageLevel="JDK_1_7" default="true" assert-keyword="true" jdk-15="true" project-jdk-name="1.7" project-jdk-type="JavaSDK">[m
[32m+[m[32m    <output url="file://$PROJECT_DIR$/build/classes" />[m
[32m+[m[32m  </component>[m
[32m+[m[32m  <component name="ProjectType">[m
[32m+[m[32m    <option name="id" value="Android" />[m
[32m+[m[32m  </component>[m
[32m+[m[32m</project>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/modules.xml b/.idea/modules.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..71ad0bb[m
[1m--- /dev/null[m
[1m+++ b/.idea/modules.xml[m
[36m@@ -0,0 +1,10 @@[m
[32m+[m[32m<?xml version="1.0" encoding="UTF-8"?>[m
[32m+[m[32m<project version="4">[m
[32m+[m[32m  <component name="ProjectModuleManager">[m
[32m+[m[32m    <modules>[m
[32m+[m[32m      <module fileurl="file://$PROJECT_DIR$/CoordinateMap.iml" filepath="$PROJECT_DIR$/CoordinateMap.iml" />[m
[32m+[m[32m      <module fileurl="file://$PROJECT_DIR$/app/app.iml" filepath="$PROJECT_DIR$/app/app.iml" />[m
[32m+[m[32m      <module fileurl="file://$PROJECT_DIR$/daogenerator/daogenerator.iml" filepath="$PROJECT_DIR$/daogenerator/daogenerator.iml" />[m
[32m+[m[32m    </modules>[m
[32m+[m[32m  </component>[m
[32m+[m[32m</project>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/runConfigurations.xml b/.idea/runConfigurations.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..7f68460[m
[1m--- /dev/null[m
[1m+++ b/.idea/runConfigurations.xml[m
[36m@@ -0,0 +1,12 @@[m
[32m+[m[32m<?xml version="1.0" encoding="UTF-8"?>[m
[32m+[m[32m<project version="4">[m
[32m+[m[32m  <component name="RunConfigurationProducerService">[m
[32m+[m[32m    <option name="ignoredProducers">[m
[32m+[m[32m      <set>[m
[32m+[m[32m        <option value="org.jetbrains.plugins.gradle.execution.test.runner.AllInPackageGradleConfigurationProducer" />[m
[32m+[m[32m        <option value="org.jetbrains.plugins.gradle.execution.test.runner.TestClassGradleConfigurationProducer" />[m
[32m+[m[32m        <option value="org.jetbrains.plugins.gradle.execution.test.runner.TestMethodGradleConfigurationProducer" />[m
[32m+[m[32m      </set>[m
[32m+[m[32m    </option>[m
[32m+[m[32m  </component>[m
[32m+[m[32m</project>[m
\ No newline at end of file[m
[1mdiff --git a/.idea/vcs.xml b/.idea/vcs.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..830a534[m
[1m--- /dev/null[m
[1m+++ b/.idea/vcs.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<?xml version="1.0" encoding="UTF-8"?>[m
[32m+[m[32m<project version="4">[m
[32m+[m[32m  <component name="VcsDirectoryMappings">[m
[32m+[m[32m    <mapping directory="$PROJECT_DIR$" vcs="" />[m
[32m+[m[32m  </component>[m
[32m+[m[32m</project>[m
\ No newline at end of file[m
[1mdiff --git a/CoordinateMap b/CoordinateMap[m
[1mnew file mode 160000[m
[1mindex 0000000..3135131[m
[1m--- /dev/null[m
[1m+++ b/CoordinateMap[m
[36m@@ -0,0 +1 @@[m
[32m+[m[32mSubproject commit 313513110c50cee2c21e70f3590413d871feb8d9[m
[1mdiff --git a/app/.gitignore b/app/.gitignore[m
[1mnew file mode 100644[m
[1mindex 0000000..796b96d[m
[1m--- /dev/null[m
[1m+++ b/app/.gitignore[m
[36m@@ -0,0 +1 @@[m
[32m+[m[32m/build[m
[1mdiff --git a/app/build.gradle b/app/build.gradle[m
[1mnew file mode 100644[m
[1mindex 0000000..632a3ee[m
[1m--- /dev/null[m
[1m+++ b/app/build.gradle[m
[36m@@ -0,0 +1,40 @@[m
[32m+[m[32mapply plugin: 'com.android.application'[m
[32m+[m
[32m+[m[32mandroid {[m
[32m+[m[32m    compileSdkVersion 23[m
[32m+[m[32m    buildToolsVersion "23.0.2"[m
[32m+[m
[32m+[m[32m    defaultConfig {[m
[32m+[m[32m        applicationId "com.fanweilin.coordinatemap"[m
[32m+[m[32m        minSdkVersion 15[m
[32m+[m[32m        targetSdkVersion 23[m
[32m+[m[32m        versionCode 1[m
[32m+[m[32m        versionName "1.0"[m
[32m+[m[32m    }[m
[32m+[m[32m    buildTypes {[m
[32m+[m[32m        release {[m
[32m+[m[32m            minifyEnabled false[m
[32m+[m[32m            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m[32m    sourceSets {[m
[32m+[m[32m        main {[m
[32m+[m[32m            java.srcDirs = ['src/main/java', 'src/main/java-gen'][m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32mdependencies {[m
[32m+[m[32m    compile fileTree(dir: 'libs', include: ['*.jar'])[m
[32m+[m[32m    testCompile 'junit:junit:4.12'[m
[32m+[m[32m    compile 'com.google.android.gms:play-services-appindexing:8.1.0'[m
[32m+[m[32m    compile 'com.android.support:cardview-v7:23.0.1'[m
[32m+[m[32m    compile 'de.greenrobot:greendao:1.3.7'[m
[32m+[m[32m    compile 'com.android.support:appcompat-v7:23.1.1'[m
[32m+[m[32m    compile 'de.hdodenhof:circleimageview:1.3.0'[m
[32m+[m[32m    compile 'com.android.support:design:23.1.1'[m
[32m+[m[32m    compile 'com.github.nirhart:parallaxscroll:1.0'[m
[32m+[m[32m    compile files('libs/BaiduLBS_Android.jar')[m
[32m+[m[32m    compile 'info.hoang8f:android-segmented:1.0.6'[m
[32m+[m[32m}[m
[1mdiff --git a/app/libs/BaiduLBS_Android.jar b/app/libs/BaiduLBS_Android.jar[m
[1mnew file mode 100644[m
[1mindex 0000000..6377736[m
Binary files /dev/null and b/app/libs/BaiduLBS_Android.jar differ
[1mdiff --git a/app/libs/httpmime-4.1.2.jar b/app/libs/httpmime-4.1.2.jar[m
[1mnew file mode 100644[m
[1mindex 0000000..eea3b3f[m
Binary files /dev/null and b/app/libs/httpmime-4.1.2.jar differ
[1mdiff --git a/app/proguard-rules.pro b/app/proguard-rules.pro[m
[1mnew file mode 100644[m
[1mindex 0000000..1cee92c[m
[1m--- /dev/null[m
[1m+++ b/app/proguard-rules.pro[m
[36m@@ -0,0 +1,17 @@[m
[32m+[m[32m# Add project specific ProGuard rules here.[m
[32m+[m[32m# By default, the flags in this file are appended to flags specified[m
[32m+[m[32m# in e:\Android\sdk/tools/proguard/proguard-android.txt[m
[32m+[m[32m# You can edit the include path and order by changing the proguardFiles[m
[32m+[m[32m# directive in build.gradle.[m
[32m+[m[32m#[m
[32m+[m[32m# For more details, see[m
[32m+[m[32m#   http://developer.android.com/guide/developing/tools/proguard.html[m
[32m+[m
[32m+[m[32m# Add any project specific keep options here:[m
[32m+[m
[32m+[m[32m# If your project uses WebView with JS, uncomment the following[m
[32m+[m[32m# and specify the fully qualified class name to the JavaScript interface[m
[32m+[m[32m# class:[m
[32m+[m[32m#-keepclassmembers class fqcn.of.javascript.interface.for.webview {[m
[32m+[m[32m#   public *;[m
[32m+[m[32m#}[m
[1mdiff --git a/app/src/androidTest/java/com/fanweilin/coordinatemap/ApplicationTest.java b/app/src/androidTest/java/com/fanweilin/coordinatemap/ApplicationTest.java[m
[1mnew file mode 100644[m
[1mindex 0000000..02fa509[m
[1m--- /dev/null[m
[1m+++ b/app/src/androidTest/java/com/fanweilin/coordinatemap/ApplicationTest.java[m
[36m@@ -0,0 +1,13 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap;[m
[32m+[m
[32m+[m[32mimport android.app.Application;[m
[32m+[m[32mimport android.test.ApplicationTestCase;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * <a href="http://d.android.com/tools/testing/testing_android.html">Testing Fundamentals</a>[m
[32m+[m[32m */[m
[32m+[m[32mpublic class ApplicationTest extends ApplicationTestCase<Application> {[m
[32m+[m[32m    public ApplicationTest() {[m
[32m+[m[32m        super(Application.class);[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..3b31aec[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/AndroidManifest.xml[m
[36m@@ -0,0 +1,83 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<manifest xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    package="com.fanweilin.coordinatemap">[m
[32m+[m
[32m+[m[32m    <uses-permission android:name="com.android.launcher.permission.READ_SETTINGS" />[m
[32m+[m[32m    <uses-permission android:name="android.permission.WAKE_LOCK" />[m
[32m+[m[32m    <uses-permission android:name="android.permission.GET_TASKS" />[m
[32m+[m[32m    <uses-permission android:name="android.permission.WRITE_SETTINGS" />[m
[32m+[m[32m    <!-- 这个权限用于进行网络定位 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />[m
[32m+[m[32m    <!-- 这个权限用于访问GPS定位 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />[m
[32m+[m[32m    <!-- 用于访问wifi网络信息，wifi信息会用于进行网络定位 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />[m
[32m+[m[32m    <!-- 获取运营商信息，用于支持提供运营商信息相关的接口 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />[m
[32m+[m[32m    <!-- 这个权限用于获取wifi的获取权限，wifi信息会用来进行网络定位 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />[m
[32m+[m[32m    <!-- 用于读取手机当前的状态 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.READ_PHONE_STATE" />[m
[32m+[m[32m    <!-- 写入扩展存储，向扩展卡写入数据，用于写入离线定位数据 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />[m
[32m+[m[32m    <!-- 访问网络，网络定位需要上网 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.INTERNET" />[m
[32m+[m[32m    <!-- SD卡读取权限，用户写入离线定位数据 -->[m
[32m+[m[32m    <uses-permission android:name="android.permission.MOUNT_UNMOUNT_FILESYSTEMS" />[m
[32m+[m
[32m+[m[32m    <application[m
[32m+[m[32m        android:name=".Activity.data"[m
[32m+[m[32m        android:allowBackup="true"[m
[32m+[m[32m        android:icon="@mipmap/earth_global"[m
[32m+[m[32m        android:label="@string/app_name"[m
[32m+[m[32m        android:screenOrientation="landscape"[m
[32m+[m[32m        android:supportsRtl="true"[m
[32m+[m[32m        android:theme="@style/AppTheme">[m
[32m+[m[32m        <activity[m
[32m+[m[32m            android:name=".Activity.MainActivity"[m
[32m+[m[32m            android:launchMode="singleTask">[m
[32m+[m[32m            <intent-filter>[m
[32m+[m[32m                <action android:name="android.intent.action.MAIN" />[m
[32m+[m
[32m+[m[32m                <category android:name="android.intent.category.LAUNCHER" />[m
[32m+[m[32m            </intent-filter>[m
[32m+[m[32m        </activity>[m
[32m+[m
[32m+[m[32m        <meta-data[m
[32m+[m[32m            android:name="com.baidu.lbsapi.API_KEY"[m
[32m+[m[32m            android:value="t5l4jnPgxw29QXFeVVv4LF0k" />[m
[32m+[m
[32m+[m[32m        <service[m
[32m+[m[32m            android:name="com.baidu.location.f"[m
[32m+[m[32m            android:enabled="true"[m
[32m+[m[32m            android:process=":remote" />[m
[32m+[m
[32m+[m[32m        <!--[m
[32m+[m[32m             ATTENTION: This was auto-generated to add Google Play services to your project for[m
[32m+[m[32m             App Indexing.  See https://g.co/AppIndexing/AndroidStudio for more information.[m
[32m+[m[32m        -->[m
[32m+[m[32m        <meta-data[m
[32m+[m[32m            android:name="com.google.android.gms.version"[m
[32m+[m[32m            android:value="@integer/google_play_services_version" />[m
[32m+[m
[32m+[m[32m        <actiwarning: LF will be replaced by CRLF in .idea/vcs.xml.
The file will have its original line endings in your working directory.
vity android:name=".Activity.AddFileActivity" />[m
[32m+[m[32m        <activity android:name=".Activity.FileManagerActivity" />[m
[32m+[m[32m        <activity[m
[32m+[m[32m            android:name=".Activity.DataManagerActivity"[m
[32m+[m[32m            android:launchMode="singleTop">[m
[32m+[m[32m            <intent-filter>[m
[32m+[m[32m                <action android:name="android.intent.action.SEARCH" />[m
[32m+[m[32m            </intent-filter>[m
[32m+[m
[32m+[m[32m            <meta-data[m
[32m+[m[32m                android:name="android.app.searchable"[m
[32m+[m[32m                android:resource="@xml/searchable" />[m
[32m+[m[32m            <meta-data[m
[32m+[m[32m                android:name="android.app.default_searchable"[m
[32m+[m[32m                android:value=".Activity.DataManagerActivity" />[m
[32m+[m[32m        </activity>[m
[32m+[m[32m        <activity android:name=".Activity.Bdoffilin_activity" />[m
[32m+[m[32m        <activity android:name=".Activity.ConvertActivity"></activity>[m
[32m+[m[32m    </application>[m
[32m+[m
[32m+[m[32m</manifest>[m
[1mdiff --git a/app/src/main/java-gen/com/fanweilin/greendao/DaoMaster.java b/app/src/main/java-gen/com/fanweilin/greendao/DaoMaster.java[m
[1mnew file mode 100644[m
[1mindex 0000000..213732c[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java-gen/com/fanweilin/greendao/DaoMaster.java[m
[36m@@ -0,0 +1,74 @@[m
[32m+[m[32mpackage com.fanweilin.greendao;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase.CursorFactory;[m
[32m+[m[32mimport android.database.sqlite.SQLiteOpenHelper;[m
[32m+[m[32mimport android.util.Log;[m
[32m+[m[32mimport de.greenrobot.dao.AbstractDaoMaster;[m
[32m+[m[32mimport de.greenrobot.dao.identityscope.IdentityScopeType;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.greendao.FilesDao;[m
[32m+[m[32mimport com.fanweilin.greendao.ShowDataDao;[m
[32m+[m
[32m+[m[32m// THIS CODE IS GENERATED BY greenDAO, DO NOT EDIT.[m
[32m+[m[32m/**[m[41m [m
[32m+[m[32m * Master of DAO (schema version 1): knows all DAOs.[m
[32m+[m[32m*/[m
[32m+[m[32mpublic class DaoMaster extends AbstractDaoMaster {[m
[32m+[m[32m    public static final int SCHEMA_VERSION = 1;[m
[32m+[m
[32m+[m[32m    /** Creates underlying database table using DAOs. */[m
[32m+[m[32m    public static void createAllTables(SQLiteDatabase db, boolean ifNotExists) {[m
[32m+[m[32m        FilesDao.createTable(db, ifNotExists);[m
[32m+[m[32m        ShowDataDao.createTable(db, ifNotExists);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    /** Drops underlying database table using DAOs. */[m
[32m+[m[32m    public static void dropAllTables(SQLiteDatabase db, boolean ifExists) {[m
[32m+[m[32m        FilesDao.dropTable(db, ifExists);[m
[32m+[m[32m        ShowDataDao.dropTable(db, ifExists);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    public static abstract class OpenHelper extends SQLiteOpenHelper {[m
[32m+[m
[32m+[m[32m        public OpenHelper(Context context, String name, CursorFactory factory) {[m
[32m+[m[32m            super(context, name, factory, SCHEMA_VERSION);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void onCreate(SQLiteDatabase db) {[m
[32m+[m[32m            Log.i("greenDAO", "Creating tables for schema version " + SCHEMA_VERSION);[m
[32m+[m[32m            createAllTables(db, false);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    /** WARNING: Drops all table on Upgrade! Use only during development. */[m
[32m+[m[32m    public static class DevOpenHelper extends OpenHelper {[m
[32m+[m[32m        public DevOpenHelper(Context context, String name, CursorFactory factory) {[m
[32m+[m[32m            super(context, name, factory);[m
warning: LF will be replaced by CRLF in app/src/main/java-gen/com/fanweilin/greendao/DaoMaster.java.
The file will have its original line endings in your working directory.
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {[m
[32m+[m[32m            Log.i("greenDAO", "Upgrading schema from version " + oldVersion + " to " + newVersion + " by dropping all tables");[m
[32m+[m[32m            dropAllTables(db, true);[m
[32m+[m[32m            onCreate(db);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public DaoMaster(SQLiteDatabase db) {[m
[32m+[m[32m        super(db, SCHEMA_VERSION);[m
[32m+[m[32m        registerDaoClass(FilesDao.class);[m
[32m+[m[32m        registerDaoClass(ShowDataDao.class);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    public DaoSession newSession() {[m
[32m+[m[32m        return new DaoSession(db, IdentityScopeType.Session, daoConfigMap);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    public DaoSession newSession(IdentityScopeType type) {[m
[32m+[m[32m        return new DaoSession(db, type, daoConfigMap);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java-gen/com/fanweilin/greendao/DaoSession.java b/app/src/main/java-gen/com/fanweilin/greendao/DaoSession.java[m
[1mnew file mode 100644[m
[1mindex 0000000..ab39cdc[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java-gen/com/fanweilin/greendao/DaoSession.java[m
[36m@@ -0,0 +1,63 @@[m
[32m+[m[32mpackage com.fanweilin.greendao;[m
[32m+[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m
[32m+[m[32mimport de.greenrobot.dao.AbstractDao;[m
[32m+[m[32mimport de.greenrobot.dao.AbstractDaoSession;[m
[32m+[m[32mimport de.greenrobot.dao.identityscope.IdentityScopeType;[m
[32m+[m[32mimport de.greenrobot.dao.internal.DaoConfig;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.greendao.Files;[m
[32m+[m[32mimport com.fanweilin.greendao.ShowData;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.greendao.FilesDao;[m
[32m+[m[32mimport com.fanweilin.greendao.ShowDataDao;[m
[32m+[m
[32m+[m[32m// THIS CODE IS GENERATED BY greenDAO, DO NOT EDIT.[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * {@inheritDoc}[m
[32m+[m[32m *[m[41m [m
[32m+[m[32m * @see de.greenrobot.dao.AbstractDaoSession[m
[32m+[m[32m */[m
[32m+[m[32mpublic class DaoSession extends AbstractDaoSession {[m
[32m+[m
[32m+[m[32m    private final DaoConfig filesDaoConfig;[m
[32m+[m[32m    private final DaoConfig showDataDaoConfig;[m
[32m+[m
[32m+[m[32m    private final FilesDao filesDao;[m
[32m+[m[32m    private final ShowDataDao showDataDao;[m
[32m+[m
[32m+[m[32m    public DaoSession(SQLiteDatabase db, IdentityScopeType type, Map<Class<? extends AbstractDao<?, ?>>, DaoConfig>[m
[32m+[m[32m            daoConfigMap) {[m
[32m+[m[32m        super(db);[m
[32m+[m
[32m+[m[32m        filesDaoConfig = daoConfigMap.get(FilesDao.class).clone();[m
[32m+[m[32m        filesDaoConfig.initIdentityScope(type);[m
[32m+[m
[32m+[m[32m        showDataDaoConfig = daoConfigMap.get(ShowDataDao.class).clone();[m
[32m+[m[32m        showDataDaoConfig.initIdentityScope(type);[m
[32m+[m
[32m+[m[32m        filesDao = new FilesDao(filesDaoConfig, this);[m
[32m+[m[32m        showDataDao = new ShowDataDao(showDataDaoConfig, this);[m
[32m+[m
[32m+[m[32m        registerDao(Files.class, filesDao);[m
[32m+[m[32m        registerDao(ShowData.class, showDataDao);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    public void clear() {[m
[32m+[m[32m        filesDaoConfig.getIdentityScope().clear();[m
[32m+[m[32m        showDataDaoConfig.getIdentityScope().clear();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public FilesDao getFilesDao() {[m
[32m+[m[32m        return filesDao;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public ShowDataDao getShowDataDao() {[m
[32m+[m[32m        return showDataDao;[m
[32m+warning: LF will be replaced by CRLF in app/src/main/java-gen/com/fanweilin/greendao/DaoSession.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/java-gen/com/fanweilin/greendao/Files.java.
The file will have its original line endings in your working directory.
[m[32m    }[m
[32m+[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java-gen/com/fanweilin/greendao/Files.java b/app/src/main/java-gen/com/fanweilin/greendao/Files.java[m
[1mnew file mode 100644[m
[1mindex 0000000..59a3938[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java-gen/com/fanweilin/greendao/Files.java[m
[36m@@ -0,0 +1,83 @@[m
[32m+[m[32mpackage com.fanweilin.greendao;[m
[32m+[m
[32m+[m[32m// THIS CODE IS GENERATED BY greenDAO, DO NOT EDIT. Enable "keep" sections if you want to edit.[m[41m [m
[32m+[m[32m/**[m
[32m+[m[32m * Entity mapped to table FILES.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class Files {[m
[32m+[m
[32m+[m[32m    private Long id;[m
[32m+[m[32m    /** Not-null value. */[m
[32m+[m[32m    private String title;[m
[32m+[m[32m    private String path;[m
[32m+[m[32m    private String date;[m
[32m+[m[32m    private Integer cdstyle;[m
[32m+[m[32m    private Integer datastyle;[m
[32m+[m
[32m+[m[32m    public Files() {[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Files(Long id) {[m
[32m+[m[32m        this.id = id;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Files(Long id, String title, String path, String date, Integer cdstyle, Integer datastyle) {[m
[32m+[m[32m        this.id = id;[m
[32m+[m[32m        this.title = title;[m
[32m+[m[32m        this.path = path;[m
[32m+[m[32m        this.date = date;[m
[32m+[m[32m        this.cdstyle = cdstyle;[m
[32m+[m[32m        this.datastyle = datastyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Long getId() {[m
[32m+[m[32m        return id;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setId(Long id) {[m
[32m+[m[32m        this.id = id;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Not-null value. */[m
[32m+[m[32m    public String getTitle() {[m
[32m+[m[32m        return title;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Not-null value; ensure this value is available before it is saved to the database. */[m
[32m+[m[32m    public void setTitle(String title) {[m
[32m+[m[32m        this.title = title;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public String getPath() {[m
[32m+[m[32m        return path;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setPath(String path) {[m
[32m+[m[32m        this.path = path;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public String getDate() {[m
[32m+[m[32m        return date;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setDate(String date) {[m
[32m+[m[32m        this.date = date;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Integer getCdstyle() {[m
[32m+[m[32m        return cdstyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setCdstyle(Integer cdstyle) {[m
[32m+[m[32m        this.cdstyle = cdstyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Integer getDatastyle() {[m
[32m+[m[32m        return datastyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setDatastyle(Integer datastyle) {[m
[32m+[m[32m        this.datastyle = datastyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java-gen/com/fanweilin/greendao/FilesDao.java b/app/src/main/java-gen/com/fanweilin/greendao/FilesDao.java[m
[1mnew file mode 100644[m
[1mindex 0000000..58dff88[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java-gen/com/fanweilin/greendao/FilesDao.java[m
[36m@@ -0,0 +1,147 @@[m
[32m+[m[32mpackage com.fanweilin.greendao;[m
[32m+[m
[32m+[m[32mimport android.database.Cursor;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m[32mimport android.database.sqlite.SQLiteStatement;[m
[32m+[m
[32m+[m[32mimport de.greenrobot.dao.AbstractDao;[m
[32m+[m[32mimport de.greenrobot.dao.Property;[m
[32m+[m[32mimport de.greenrobot.dao.internal.DaoConfig;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.greendao.Files;[m
[32m+[m
[32m+[m[32m// THIS CODE IS GENERATED BY greenDAO, DO NOT EDIT.[m
[32m+[m[32m/**[m[41m [m
[32m+[m[32m * DAO for table FILES.[m
[32m+[m[32m*/[m
[32m+[m[32mpublic class FilesDao extends AbstractDao<Files, Long> {[m
[32m+[m
[32m+[m[32m    public static final String TABLENAME = "FILES";[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Properties of entity Files.<br/>[m
[32m+[m[32m     * Can be used for QueryBuilder and for referencing column names.[m
[32m+[m[32m    */[m
[32m+[m[32m    public static class Properties {[m
[32m+[m[32m        public final static Property Id = new Property(0, Long.class, "id", true, "_id");[m
[32m+[m[32m        public final static Property Title = new Property(1, String.class, "title", false, "TITLE");[m
[32m+[m[32m        public final static Property Path = new Property(2, String.class, "path", false, "PATH");[m
[32m+[m[32m        public final static Property Date = new Property(3, String.class, "date", false, "DATE");[m
[32m+[m[32m        public final static Property Cdstyle = new Property(4, Integer.class, "cdstyle", false, "CDSTYLE");[m
[32m+[m[32m        public final static Property Datastyle = new Property(5, Integer.class, "datastyle", false, "DATASTYLE");[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public FilesDao(DaoConfig config) {[m
[32m+[m[32m        super(config);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    public FilesDao(DaoConfig config, DaoSession daoSession) {[m
[32m+[m[32m        super(config, daoSession);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Creates the underlying database table. */[m
[32m+[m[32m    public static void createTable(SQLiteDatabase db, boolean ifNotExists) {[m
[32m+[m[32m        String constraint = ifNotExists? "IF NOT EXISTS ": "";[m
[32m+[m[32m        db.execSQL("CREATE TABLE " + constraint + "'FILES' (" + //[m
[32m+[m[32m                "'_id' INTEGER PRIMARY KEY ," + // 0: id[m
[32m+[m[32m                "'TITLE' TEXT NOT NULL ," + // 1: title[m
[32m+[m[32m                "'PATH' TEXT," + // 2: path[m
[32m+[m[32m                "'DATE' TEXT," + // 3: date[m
[32m+[m[32m                "'CDSTYLE' INTEGER," + // 4: cdstyle[m
[32m+[m[32m                "'DATASTYLE' INTEGER);"); // 5: datastyle[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Drops the underlying database table. */[m
[32m+[m[32m    public static void dropTable(SQLiteDatabase db, boolean ifExists) {[m
[32m+[m[32m        String sql = "DROP TABLE " + (ifExists ? "IF EXISTS " : "") + "'FILES'";[m
[32m+[m[32m        db.execSQL(sql);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void bindValues(SQLiteStatement stmt, Files entity) {[m
[32m+[m[32m        stmt.clearBindings();[m
[32m+[m[41m [m
[32m+[m[32m        Long id = entity.getId();[m
[32m+[m[32m        if (id != null) {[m
[32m+[m[32m            stmt.bindLong(1, id);[m
[32m+[m[32m        }[m
[32m+[m[32m        stmt.bindString(2, entity.getTitle());[m
[32m+[m[41m [m
[32m+[m[32m        String path = entity.getPath();[m
[32m+[m[32m        if (path != null) {[m
[32m+[m[32m            stmt.bindString(3, path);[m
[32m+[m[32m        }[m
[32m+[m[41m [m
[32m+[m[32m        String date = entity.getDate();[m
[32m+[m[32m        if (date != null) {[m
[32m+[m[32m            stmt.bindString(4, date);[m
[32m+[m[32m        }[m
[32m+[m[41m [m
[32m+[m[32m        Integer cdstyle = entity.getCdstyle();[m
[32m+[m[32m        if (cdstyle != null) {[m
[32m+[m[32m            stmt.bindLong(5, cdstyle);[m
[32m+[m[32m        }[m
[32m+[m[41m [m
[32m+[m[32m        Integer datastyle = entity.getDatastyle();[m
[32m+[m[32m        if (datastyle != null) {[m
[32m+[m[32m            stmt.bindLong(6, datastyle);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+warning: LF will be replaced by CRLF in app/src/main/java-gen/com/fanweilin/greendao/FilesDao.java.
The file will have its original line endings in your working directory.
[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Long readKey(Cursor cursor, int offset) {[m
[32m+[m[32m        return cursor.isNull(offset + 0) ? null : cursor.getLong(offset + 0);[m
[32m+[m[32m    }[m[41m    [m
[32m+[m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Files readEntity(Cursor cursor, int offset) {[m
[32m+[m[32m        Files entity = new Files( //[m
[32m+[m[32m            cursor.isNull(offset + 0) ? null : cursor.getLong(offset + 0), // id[m
[32m+[m[32m            cursor.getString(offset + 1), // title[m
[32m+[m[32m            cursor.isNull(offset + 2) ? null : cursor.getString(offset + 2), // path[m
[32m+[m[32m            cursor.isNull(offset + 3) ? null : cursor.getString(offset + 3), // date[m
[32m+[m[32m            cursor.isNull(offset + 4) ? null : cursor.getInt(offset + 4), // cdstyle[m
[32m+[m[32m            cursor.isNull(offset + 5) ? null : cursor.getInt(offset + 5) // datastyle[m
[32m+[m[32m        );[m
[32m+[m[32m        return entity;[m
[32m+[m[32m    }[m
[32m+[m[41m     [m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void readEntity(Cursor cursor, Files entity, int offset) {[m
[32m+[m[32m        entity.setId(cursor.isNull(offset + 0) ? null : cursor.getLong(offset + 0));[m
[32m+[m[32m        entity.setTitle(cursor.getString(offset + 1));[m
[32m+[m[32m        entity.setPath(cursor.isNull(offset + 2) ? null : cursor.getString(offset + 2));[m
[32m+[m[32m        entity.setDate(cursor.isNull(offset + 3) ? null : cursor.getString(offset + 3));[m
[32m+[m[32m        entity.setCdstyle(cursor.isNull(offset + 4) ? null : cursor.getInt(offset + 4));[m
[32m+[m[32m        entity.setDatastyle(cursor.isNull(offset + 5) ? null : cursor.getInt(offset + 5));[m
[32m+[m[32m     }[m
[32m+[m[41m    [m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected Long updateKeyAfterInsert(Files entity, long rowId) {[m
[32m+[m[32m        entity.setId(rowId);[m
[32m+[m[32m        return rowId;[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Long getKey(Files entity) {[m
[32m+[m[32m        if(entity != null) {[m
[32m+[m[32m            return entity.getId();[m
[32m+[m[32m        } else {[m
[32m+[m[32m            return null;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m[41m    [m
[32m+[m[32m    protected boolean isEntityUpdateable() {[m
[32m+[m[32m        return true;[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java-gen/com/fanweilin/greendao/ShowData.java b/app/src/main/java-gen/com/fanweilin/greendao/ShowData.java[m
[1mnew file mode 100644[m
[1mindex 0000000..91bf012[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java-gen/com/fanweilin/greendao/ShowData.java[m
[36m@@ -0,0 +1,83 @@[m
[32m+[m[32mpackage com.fanweilin.greendao;[m
[32m+[m
[32m+[m[32m// THIS CODE IS GENERATED BY greenDAO, DO NOT EDIT. Enable "keep" sections if you want to edit.[m[41m [m
[32m+[m[32m/**[m
[32m+[m[32m * Entity mapped to table SHOW_DATA.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class ShowData {[m
[32m+[m
[32m+[m[32m    private Long id;[m
[32m+[m[32m    /** Not-null value. */[m
[32m+[m[32m    private String title;[m
[32m+[m[32m    private String latitude;[m
[32m+[m[32m    private String longitude;[m
[32m+[m[32m    private Integer cdstyle;[m
[32m+[m[32m    private Integer datastyle;[m
[32m+[m
[32m+[m[32m    public ShowData() {[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public ShowData(Long id) {[m
[32m+[m[32m        this.id = id;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public ShowData(Long id, String title, String latitude, Swarning: LF will be replaced by CRLF in app/src/main/java-gen/com/fanweilin/greendao/ShowData.java.
The file will have its original line endings in your working directory.
tring longitude, Integer cdstyle, Integer datastyle) {[m
[32m+[m[32m        this.id = id;[m
[32m+[m[32m        this.title = title;[m
[32m+[m[32m        this.latitude = latitude;[m
[32m+[m[32m        this.longitude = longitude;[m
[32m+[m[32m        this.cdstyle = cdstyle;[m
[32m+[m[32m        this.datastyle = datastyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Long getId() {[m
[32m+[m[32m        return id;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setId(Long id) {[m
[32m+[m[32m        this.id = id;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Not-null value. */[m
[32m+[m[32m    public String getTitle() {[m
[32m+[m[32m        return title;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Not-null value; ensure this value is available before it is saved to the database. */[m
[32m+[m[32m    public void setTitle(String title) {[m
[32m+[m[32m        this.title = title;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public String getLatitude() {[m
[32m+[m[32m        return latitude;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setLatitude(String latitude) {[m
[32m+[m[32m        this.latitude = latitude;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public String getLongitude() {[m
[32m+[m[32m        return longitude;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setLongitude(String longitude) {[m
[32m+[m[32m        this.longitude = longitude;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Integer getCdstyle() {[m
[32m+[m[32m        return cdstyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setCdstyle(Integer cdstyle) {[m
[32m+[m[32m        this.cdstyle = cdstyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Integer getDatastyle() {[m
[32m+[m[32m        return datastyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setDatastyle(Integer datastyle) {[m
[32m+[m[32m        this.datastyle = datastyle;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java-gen/com/fanweilin/greendao/ShowDataDao.java b/app/src/main/java-gen/com/fanweilin/greendao/ShowDataDao.java[m
[1mnew file mode 100644[m
[1mindex 0000000..4d9eefa[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java-gen/com/fanweilin/greendao/ShowDataDao.java[m
[36m@@ -0,0 +1,147 @@[m
[32m+[m[32mpackage com.fanweilin.greendao;[m
[32m+[m
[32m+[m[32mimport android.database.Cursor;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m[32mimport android.database.sqlite.SQLiteStatement;[m
[32m+[m
[32m+[m[32mimport de.greenrobot.dao.AbstractDao;[m
[32m+[m[32mimport de.greenrobot.dao.Property;[m
[32m+[m[32mimport de.greenrobot.dao.internal.DaoConfig;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.greendao.ShowData;[m
[32m+[m
[32m+[m[32m// THIS CODE IS GENERATED BY greenDAO, DO NOT EDIT.[m
[32m+[m[32m/**[m[41m [m
[32m+[m[32m * DAO for table SHOW_DATA.[m
[32m+[m[32m*/[m
[32m+[m[32mpublic class ShowDataDao extends AbstractDao<ShowData, Long> {[m
[32m+[m
[32m+[m[32m    public static final String TABLENAME = "SHOW_DATA";[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Properties of entity ShowData.<br/>[m
[32m+[m[32m     * Can be used for QueryBuilder and for referencing column names.[m
[32m+[m[32m    */[m
[32m+[m[32m    public static class Properties {[m
[32m+[m[32m        public final static Property Id = new Property(0, Long.class, "id", true, "_id");[m
[32m+[m[32m        public final static Property Title = new Property(1, String.class, "title", false, "TITLE");[m
[32m+[m[32m        public final static Property Latitude = new Property(2, String.class, "latitude", false, "LATITUDE");[m
[32m+[m[32m        public final static Property Longitude = new Property(3, String.class, "longitude", false, "LONGITUDE");[m
[32m+[m[32m        public final static Property Cdstyle = new Property(4, Integer.class, "cdstyle", false, "CDSTYLE");[m
[32m+[m[32m        public final static Property Datastyle = new Property(5, Integer.class, "datastyle", false, "DATASTYLE");[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public ShowDataDao(DaoConfig config) {[m
[32m+[m[32m        super(config);[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    public ShowDataDao(DaoConfig config, DaoSession daoSession) {[m
[32m+[m[32m        super(config, daoSession);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Creates the underlying database table. */[m
[32m+[m[32m    public static void createTable(SQLiteDatabase db, boolean ifNotExists) {[m
[32m+[m[32m        String constraint = ifNotExists? "IF NOT EXISTS ": "";[m
[32m+[m[32m        db.execSQL("CREATE TABLE " + constraint + "'SHOW_DATA' (" + //[m
[32m+[m[32m                "'_id' INTEGER PRIMARY KEY ," + // 0: id[m
[32m+[m[32m                "'TITLE' TEXT NOT NULL ," + // 1: title[m
[32m+[m[32m                "'LATITUDE' TEXT," + // 2: latitude[m
[32m+[m[32m                "'LONGITUDE' TEXT," + // 3: longitude[m
[32m+[m[32m                "'CDSTYLE' INTEGER," + // 4: cdstyle[m
[32m+[m[32m                "'DATASTYLE' INTEGER);"); // 5: datastyle[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** Drops the underlying database table. */[m
[32m+[m[32m    public static void dropTable(SQLiteDatabase db, boolean ifExists) {[m
[32m+[m[32m        String sql = "DROP TABLE " + (ifExists ? "IF EXISTS " : "") + "'SHOW_DATA'";[m
[32m+[m[32m        db.execSQL(sql);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void bindValues(SQLiteStatement stmt, ShowData entity) {[m
[32m+[m[32m        stmt.clearBindings();[m
[32m+[m[41m [m
[32m+[m[32m        Long id = entity.getId();[m
[32m+[m[32m        if (id != null) {[m
[32m+[m[32m            stmt.bindLong(1, id);[m
[32m+[m[32m        }[m
[32m+[m[32m        stmt.bindString(2, entity.getTitle());[m
[32m+[m[41m [m
[32m+[m[32m        String latitude = entity.getLatitude();[m
[32m+[m[32m        if (latitude != null) {[m
[32m+[m[32m            stmt.bindString(3, latitude);[m
[32m+[m[32m        }[m
[32m+[m[41m [m
[32m+[m[32m        String longitude = entity.getLongitude();[m
[32m+[m[32m        if (longitude != null) {[m
[32m+[m[32m            stmt.bindString(4, longitude);[m
[32m+[m[32m        }[m
[32m+[m[41m [m
[32m+[m[32m        Integer cdstyle = entity.getCdstyle();[m
[32m+[m[32m        if (cdstyle != null) {[m
[32m+[m[32m            stmt.bindLong(5, cdstyle);[m
[32m+[m[32m        }[m
[32m+[m[41m [m
[32m+[m[32m        Integer datastyle = entity.getDatastyle();[m
[32m+[m[32m        if (datastyle != null) {[m
[32m+[m[32m            stmt.bindLong(6, datastyle);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Long readKey(Cursor cursor, int offset) {[m
[32m+[m[32m        return cursor.isNull(offset + 0) ? null : cursor.getLong(offset + 0);[m
[32m+[m[32m    }[m[41m    [m
[32m+[m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public ShowData readEntity(Cursor cursor, int offset) {[m
[32m+[m[32m        ShowData entity = new ShowData( //[m
[32m+[m[32m            cursor.isNull(offset + 0) ? null : cursor.getLong(offset + 0), // id[m
[32m+[m[32m            cursor.getString(offset + 1), // title[m
[32m+[m[32m            cursor.isNull(offset + 2) ? null : cursor.getString(offset + 2), // latitude[m
[32m+[m[32m            cursor.isNull(offset + 3) ? null : cursor.getString(offset + 3), // longitude[m
[32m+[m[32m            cursor.isNull(offset + 4) ? null : cursor.getInt(offset + 4), // cdstyle[m
[32m+[m[32m            cursor.isNull(offset + 5) ? null : cursor.getIntwarning: LF will be replaced by CRLF in app/src/main/java-gen/com/fanweilin/greendao/ShowDataDao.java.
The file will have its original line endings in your working directory.
(offset + 5) // datastyle[m
[32m+[m[32m        );[m
[32m+[m[32m        return entity;[m
[32m+[m[32m    }[m
[32m+[m[41m     [m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void readEntity(Cursor cursor, ShowData entity, int offset) {[m
[32m+[m[32m        entity.setId(cursor.isNull(offset + 0) ? null : cursor.getLong(offset + 0));[m
[32m+[m[32m        entity.setTitle(cursor.getString(offset + 1));[m
[32m+[m[32m        entity.setLatitude(cursor.isNull(offset + 2) ? null : cursor.getString(offset + 2));[m
[32m+[m[32m        entity.setLongitude(cursor.isNull(offset + 3) ? null : cursor.getString(offset + 3));[m
[32m+[m[32m        entity.setCdstyle(cursor.isNull(offset + 4) ? null : cursor.getInt(offset + 4));[m
[32m+[m[32m        entity.setDatastyle(cursor.isNull(offset + 5) ? null : cursor.getInt(offset + 5));[m
[32m+[m[32m     }[m
[32m+[m[41m    [m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected Long updateKeyAfterInsert(ShowData entity, long rowId) {[m
[32m+[m[32m        entity.setId(rowId);[m
[32m+[m[32m        return rowId;[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Long getKey(ShowData entity) {[m
[32m+[m[32m        if(entity != null) {[m
[32m+[m[32m            return entity.getId();[m
[32m+[m[32m        } else {[m
[32m+[m[32m            return null;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /** @inheritdoc */[m
[32m+[m[32m    @Override[m[41m    [m
[32m+[m[32m    protected boolean isEntityUpdateable() {[m
[32m+[m[32m        return true;[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/MarkerManager.java b/app/src/main/java/com/baidu/mapapi/clusterutil/MarkerManager.java[m
[1mnew file mode 100644[m
[1mindex 0000000..3a5866d[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/MarkerManager.java[m
[36m@@ -0,0 +1,148 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.map.BaiduMap;[m
[32m+[m[32mimport com.baidu.mapapi.map.Marker;[m
[32m+[m[32mimport com.baidu.mapapi.map.MarkerOptions;[m
[32m+[m
[32m+[m[32mimport java.util.Collections;[m
[32m+[m[32mimport java.util.HashMap;[m
[32m+[m[32mimport java.util.HashSet;[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m[32mimport java.util.Set;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Keeps track of collections of markers on the map. Delegates all Marker-related events to each[m
[32m+[m[32m * collection's individually managed listeners.[m
[32m+[m[32m * <p/>[m
[32m+[m[32m * All marker operations (adds and removes) should occur via its collection class. That is, don't[m
[32m+[m[32m * add a marker via a collection, then remove it via Marker.remove()[m
[32m+[m[32m */[m
[32m+[m[32mpublic class MarkerManager implements BaiduMap.OnMarkerClickListener, BaiduMap.OnMarkerDragListener {[m
[32m+[m[32m    private final BaiduMap mMap;[m
[32m+[m
[32m+[m[32m    private final Map<String, Collection> mNamedCollections = new HashMap<String, Collection>();[m
[32m+[m[32m    private final Map<Marker, Collection> mAllMarkers = new HashMap<Marker, Collection>();[m
[32m+[m
[32m+[m[32m    public MarkerManager(BaiduMap map) {[m
[32m+[m[32m        this.mMap = map;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Collection newCollection() {[m
[32m+[m[32m        return new Collection();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Create a new named collection, which can later be looked up by {@link #getCollection(String)}[m
[32m+[m[32m     * @param id a unique id for this collection.[m
[32m+[m[32m     */[m
[32m+[m[32m    public Collection newCollection(String id) {[m
[32m+[m[32m        if (mNamedCollections.get(id) != null) {[m
[32m+[m[32m            throw new IllegalArgumentException("collection id is not unique: " + id);[m
[32m+[m[32m        }[m
[32m+[m[32m        Collection collection = new Collection();[m
[32m+[m[32m        mNamedCollections.put(id, collection);[m
[32m+[m[32m        return collection;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Gets a named collection that was created by {@link #newCollection(String)}[m
[32m+[m[32m     * @param id the unique id for this collection.[m
[32m+[m[32m     */[m
[32m+[m[32m    public Collection getCollection(String id) {[m
[32m+[m[32m        return mNamedCollections.get(id);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public boolean onMarkerClick(Marker marker) {[m
[32m+[m[32m        Collection collection = mAllMarkers.get(marker);[m
[32m+[m[32m        if (collection != null && collection.mMarkerClickListener != null) {[m
[32m+[m[32m            // you can set the click action[m
[32m+[m[32m            return collection.mMarkerClickListener.onMarkerClick(marker);[m
[32m+[m[32m        }[m
[32m+[m[32m        return false;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onMarkerDragStart(Marker marker) {[m
[32m+[m[32m        Collection collection = mAllMarkers.get(marker);[m
[32m+[m[32m        if (collection != null && collection.mMarkerDragListener != null) {[m
[32m+[m[32m            collection.mMarkerDragListener.onMarkerDragStart(marker);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onMarkerDrag(Marker marker) {[m
[32m+[m[32m        Collection collection = mAllMarkers.get(marker);[m
[32m+[m[32m        if (collection != null && collection.mMarkerDragListener != null) {[m
[32m+[m[32m            collection.mMarkerDragListener.onMarkerDrag(marker);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onMarkerDragEnd(Marker marker) {[m
[32m+[m[32m        Collection collection = mAllMarkers.get(marker);[m
[32m+[m[32m        if (collection != null && collection.mMarkerDragListener != null) {[m
[32m+[m[32m            collection.mMarkerDragListener.onMarkerDragEnd(marker);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Removes a marker from its collection.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param marker the marker to remove.[m
[32m+[m[32m     * @return true if the marker was removed.[m
[32m+[m[32m     */[m
[32m+[m[32m    public boolean remove(Marker marker) {[m
[32m+[m[32m        Collection collection = mAllMarkers.get(marker);[m
[32m+[m[32m        return collection != null && collection.remove(marker);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class Collection {[m
[32m+[m[32m        private final Set<Marker> mMarkers = new HashSet<Marker>();[m
[32m+[m[32m        private BaiduMap.OnMarkerClickListener mMarkerClickListener;[m
[32m+[m[32m        private BaiduMap.OnMarkerDragListener mMarkerDragListener;[m
[32m+[m
[32m+[m[32m        public Collection() {[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public Marker addMarker(MarkerOptions opts) {[m
[32m+[m[32m            Marker marker = (Marker) mMap.addOverlay(opts);[m
[32m+[m[32m            mMarkers.add(marker);[m
[32m+[m[32m            mAllMarkers.put(marker, Collection.this);[m
[32m+[m[32m            return marker;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public boolean remove(Marker marker) {[m
[32m+[m[32m            if (mMarkers.remove(marker)) {[m
[32m+[m[32m                mAllMarkers.remove(marker);[m
[32m+[m[32mwarning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/MarkerManager.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/Cluster.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterItem.java.
The file will have its original line endings in your working directory.
                marker.remove();[m
[32m+[m[32m                return true;[m
[32m+[m[32m            }[m
[32m+[m[32m            return false;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void clear() {[m
[32m+[m[32m            for (Marker marker : mMarkers) {[m
[32m+[m[32m                marker.remove();[m
[32m+[m[32m                mAllMarkers.remove(marker);[m
[32m+[m[32m            }[m
[32m+[m[32m            mMarkers.clear();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public java.util.Collection<Marker> getMarkers() {[m
[32m+[m[32m            return Collections.unmodifiableCollection(mMarkers);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void setOnMarkerClickListener(BaiduMap.OnMarkerClickListener markerClickListener) {[m
[32m+[m[32m            mMarkerClickListener = markerClickListener;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void setOnMarkerDragListener(BaiduMap.OnMarkerDragListener markerDragListener) {[m
[32m+[m[32m            mMarkerDragListener = markerDragListener;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/Cluster.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/Cluster.java[m
[1mnew file mode 100644[m
[1mindex 0000000..30c755e[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/Cluster.java[m
[36m@@ -0,0 +1,21 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering;[m
[32m+[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m
[32m+[m[32mimport java.util.Collection;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * A collection of ClusterItems that are nearby each other.[m
[32m+[m[32m */[m
[32m+[m[32mpublic interface Cluster<T extends com.baidu.mapapi.clusterutil.clustering.ClusterItem> {[m
[32m+[m[32m    LatLng getPosition();[m
[32m+[m
[32m+[m[32m    Collection<T> getItems();[m
[32m+[m
[32m+[m[32m    int getSize();[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterItem.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterItem.java[m
[1mnew file mode 100644[m
[1mindex 0000000..19dd4ee[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterItem.java[m
[36m@@ -0,0 +1,23 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering;[m
[32m+[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.map.BitmapDescriptor;[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.computing.DataItem;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * ClusterItem represents a marker on the map.[m
[32m+[m[32m */[m
[32m+[m[32mpublic interface ClusterItem {[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * The position of this marker. This must always return the same value.[m
[32m+[m[32m     */[m
[32m+[m[32m    LatLng getPosition();[m
[32m+[m[32m    DataItem getDataItem();[m
[32m+[m[32m    BitmapDescriptor getBitmapDescriptor();[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterManager.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterManager.java[m
[1mnew file mode 100644[m
[1mindex 0000000..0be6688[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterManager.java[m
[36m@@ -0,0 +1,279 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.os.AsyncTask;[m
[32m+[m[32mimport android.os.Build;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.MarkerManager;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.algo.Algorithm;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.algo.NonHierarchicalDistanceBasedAlgorithm;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.algo.PreCachingAlgorithmDecorator;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.view.ClusterRenderer;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.view.DefaultClusterRenderer;[m
[32m+[m[32mimport com.baidu.mapapi.map.BaiduMap;[m
[32m+[m[32mimport com.baidu.mapapi.map.MapStatus;[m
[32m+[m[32mimport com.baidu.mapapi.map.Marker;[m
[32m+[m
[32m+[m[32mimport java.util.Collection;[m
[32m+[m[32mimport java.util.Set;[m
[32m+[m[32mimport java.util.concurrent.locks.ReadWriteLock;[m
[32m+[m[32mimport java.util.concurrent.locks.ReentrantReadWriteLock;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Groups many items on a map based on zoom level.[m
[32m+[m[32m * <p/>[m
[32m+[m[32m * ClusterManager should be added to the map[m
[32m+[m[32m * <li>[m
[32m+[m[32m */[m
[32m+[m[32mpublic class ClusterManager<T extends ClusterItem> implements[m
[32m+[m[32m        BaiduMap.OnMapStatusChangeListener, BaiduMap.OnMarkerClickListener {[m
[32m+[m[32m    private final MarkerManager mMarkerManager;[m
[32m+[m[32m    private final MarkerManager.Collection mMarkers;[m
[32m+[m[32m    private final MarkerManager.Collection mClusterMarkers;[m
[32m+[m
[32m+[m[32m    private Algorithm<T> mAlgorithm;[m
[32m+[m[32m    private final ReadWriteLock mAlgorithmLock = new ReentrantReadWriteLock();[m
[32m+[m[32m    private ClusterRenderer<T> mRenderer;[m
[32m+[m
[32m+[m[32m    private BaiduMap mMap;[m
[32m+[m[32m    private MapStatus mPreviousCameraPosition;[m
[32m+[m[32m    private ClusterTask mClusterTask;[m
[32m+[m[32m    private final ReadWriteLock mClusterTaskLock = new ReentrantReadWriteLock();[m
[32m+[m
[32m+[m[32m    private OnClusterItemClickListener<T> mOnClusterItemClickListener;[m
[32m+[m[32m    private OnClusterInfoWindowClickListener<T> mOnClusterInfoWindowClickListener;[m
[32m+[m[32m    private OnClusterItemInfoWindowClickListener<T> mOnClusterItemInfoWindowClickListener;[m
[32m+[m[32m    private OnClusterClickListener<T> mOnClusterClickListener;[m
[32m+[m
[32m+[m[32m    public ClusterManager(Context context, BaiduMap map) {[m
[32m+[m[32m        this(context, map, new MarkerManager(map));[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public ClusterManager(Context context, BaiduMap map, MarkerManager markerManager) {[m
[32m+[m[32m        mMap = map;[m
[32m+[m[32m        mMarkerManager = markerManager;[m
[32m+[m[32m        mClusterMarkers = markerManager.newCollection();[m
[32m+[m[32m        mMarkers = markerManager.newCollection();[m
[32m+[m[32m        mRenderer = new DefaultClusterRenderer<T>(context, map, this);[m
[32m+[m[32m        mAlgorithm = new PreCachingAlgorithmDecorator<T>(new NonHierarchicalDistanceBasedAlgorithm<T>());[m
[32m+[m[32m        mClusterTask = new ClusterTask();[m
[32m+[m[32m        mRenderer.onAdd();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public MarkerManager.Collection getMarkerCollection() {[m
[32m+[m[32m        return mMarkers;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public MarkerManager.Collection getClusterMarkerCollection() {[m
[32m+[m[32m        return mClusterMarkers;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public MarkerManager getMarkerManager() {[m
[32m+[m[32m        return mMarkerManager;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setRenderer(ClusterRenderer<T> view) {[m
[32m+[m[32m        mRenderer.setOnClusterClickListener(null);[m
[32m+[m[32m        mRenderer.setOnClusterItemClickListener(null);[m
[32m+[m[32m        mClusterMarkers.clear();[m
[32m+[m[32m        mMarkers.clear();[m
[32m+[m[32m        mRenderer.onRemove();[m
[32m+[m[32m        mRenderer = view;[m
[32m+[m[32m        mRenderer.onAdd();[m
[32m+[m[32m        mRenderer.setOnClusterClickListener(mOnClusterClickListener);[m
[32m+[m[32m        mRenderer.setOnClusterInfoWindowClickListener(mOnClusterInfoWindowClickListener);[m
[32m+[m[32m        mRenderer.setOnClusterItemClickListener(mOnClusterItemClickListener);[m
[32m+[m[32m        mRenderer.setOnClusterItemInfoWindowClickListener(mOnClusterItemInfoWindowClickListener);[m
[32m+[m[32m        cluster();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setAlgorithm(Algorithm<T> algorithm) {[m
[32m+[m[32m        mAlgorithmLock.writeLock().lock();[m
[32m+[m[32m        try {[m
[32m+[m[32m            if (mAlgorithm != null) {[m
[32m+[m[32m                algorithm.addItems(mAlgorithm.getItems());[m
[32m+[m[32m            }[m
[32m+[m[32m            mAlgorithm = new PreCachingAlgorithmDecorator<T>(algorithm);[m
[32m+[m[32m        } finally {[m
[32m+[m[32m            mAlgorithmLock.writeLock().unlock();[m
[32m+[m[32m        }[m
[32m+[m[32m        cluster();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void clearItems() {[m
[32m+[m[32m        mAlgorithmLock.writeLock().lock();[m
[32m+[m[32m        try {[m
[32m+[m[32m            mAlgorithm.clearItems();[m
[32m+[m[32m        } finally {[m
[32m+[m[32m            mAlgorithmLock.writeLock().unlock();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void addItems(Collection<T> items) {[m
[32m+[m[32m        mAlgorithmLock.writeLock().lock();[m
[32m+[m[32m        try {[m
[32m+[m[32m            mAlgorithm.addItems(items);[m
[32m+[m[32m        } finally {[m
[32m+[m[32m            mAlgorithmLock.writeLock().unlock();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void addItem(T myItem) {[m
[32m+[m[32m        mAlgorithmLock.writeLock().lock();[m
[32m+[m[32m        try {[m
[32m+[m[32m            mAlgorithm.addItem(myItem);[m
[32m+[m[32m        } finally {[m
[32m+[m[32m            mAlgorithmLock.writeLock().unlock();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void removeItem(T item) {[m
[32m+[m[32m        mAlgorithmLock.writeLock().lock();[m
[32m+[m[32m        try {[m
[32m+[m[32m            mAlgorithm.removeItem(item);[m
[32m+[m[32m        } finally {[m
[32m+[m[32m            mAlgorithmLock.writeLock().unlock();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Force a re-cluster. You may want to call this after adding new item(s).[m
[32m+[m[32m     */[m
[32m+[m[32m    public void cluster() {[m
[32m+[m[32m        mClusterTaskLock.writeLock().lock();[m
[32m+[m[32m        try {[m
[32m+[m[32m            // Attempt to cancel the in-flight request.[m
[32m+[m[32m            mClusterTask.cancel(true);[m
[32m+[m[32m            mClusterTask = new ClusterTask();[m
[32m+[m
[32m+[m[32m            if (Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB) {[m
[32m+[m[32m                mClusterTask.execute(mMap.getMapStatus().zoom);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                mClusterTask.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, mMap.getMapStatus().zoom);[m
[32m+[m[32m            }[m
[32m+[m[32m        } finally {[m
[32m+[m[32m            mClusterTaskLock.writeLock().unlock();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onMapStatusChangeStart(MapStatus mapStatus) {[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onMapStatusChange(MapStatus mapStatus) {[m
[32m+[m[32m        if (mRenderer instanceof BaiduMap.OnMapStatusChangeListener) {[m
[32m+[m[32m            ((BaiduMap.OnMapStatusChangeListener) mRenderer).onMapStatusChange(mapStatus);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // Don't re-compute clusters if the map has just been panned/tilted/rotated.[m
[32m+[m[32m        MapStatus position = mMap.getMapStatus();[m
[32m+[m[32m        if (mPreviousCameraPosition != null && mPreviousCameraPosition.zoom == position.zoom) {[m
[32m+[m[32m            return;[m
[32m+[m[32m        }[m
[32m+[m[32m        mPreviousCameraPosition = mMap.getMapStatus();[m
[32m+[m
[32m+[m[32m        cluster();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onMapStatusChangeFinish(MapStatus mapStatus) {[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public boolean onMarkerClick(Marker marker) {[m
[32m+[m[32m        return getMarkerManager().onMarkerClick(marker);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Runs the clustering algorithm in a background thread, then re-paints when results come back.[m
[32m+[m[32m     */[m
[32m+[m[32m    private class ClusterTask extends AsyncTask<Float, Void, Set<? extends Cluster<T>>> {[m
[32m+[m[32m        @Override[m
[32m+[m[32m        protected Set<? extends Cluster<T>> doInBackground(Float... zoom) {[m
[32m+[m[32m            mAlgorithmLock.readLock().lock();[m
[32m+[m[32m            try {[m
[32m+[m[32m                return mAlgorithm.getClusters(zoom[0]);[m
[32m+[m[32m            } finally {[m
[32m+[m[32m                mAlgorithmLock.readLock().unlock();[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        protected void onPostExecute(Set<? extends Cluster<T>> clusters) {[m
[32m+[m[32m            mRenderer.onClustersChanged(clusters);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets a callback that's invoked when a Cluster is tapped. Note: For this listener to function,[m
[32m+[m[32m     * the ClusterManager must be added as a click listener to the map.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setOnClusterClickListener(OnClusterClickListener<T> listener) {[m
[32m+[m[32m        mOnClusterClickListener = listener;[m
[32m+[m[32m        mRenderer.setOnClusterClickListener(listener);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets a callback that's invoked when a Cluster is tapped. Note: For this listener to function,[m
[32m+[m[32m     * the ClusterManager must be added as a info window click listener to the map.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setOnClusterInfoWindowClickListener(OnClusterInfoWindowClickListener<T> listener) {[m
[32m+[m[32m        mOnClusterInfoWindowClickListener = listener;[m
[32m+[m[32m        mRenderer.setOnClusterInfoWindowClickListener(listener);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets a callback that's invoked when an individual ClusterItem is tapped. Note: For this[m
[32m+[m[32m     * listener to function, the ClusterManager must be added as a click listener to the map.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setOnClusterItemClickListener(OnClusterItemClickListener<T> listener) {[m
[32m+[m[32m        mOnClusterItemClickListener = listener;[m
[32m+[m[32m        mRenderer.setOnClusterItemClickListener(listener);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets a callback that's invoked when an individual ClusterItem's Info Window is tapped. Note: For this[m
[32m+[m[32m     * listener to function, the ClusterManager must be added as a info window click listener to the map.[m
[32m+[m[32m     */warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/ClusterManager.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/Algorithm.java.
The file will have its original line endings in your working directory.
[m
[32m+[m[32m    public void setOnClusterItemInfoWindowClickListener(OnClusterItemInfoWindowClickListener<T> listener) {[m
[32m+[m[32m        mOnClusterItemInfoWindowClickListener = listener;[m
[32m+[m[32m        mRenderer.setOnClusterItemInfoWindowClickListener(listener);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called when a Cluster is clicked.[m
[32m+[m[32m     */[m
[32m+[m[32m    public interface OnClusterClickListener<T extends ClusterItem> {[m
[32m+[m[32m        boolean onClusterClick(Cluster<T> cluster);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called when a Cluster's Info Window is clicked.[m
[32m+[m[32m     */[m
[32m+[m[32m    public interface OnClusterInfoWindowClickListener<T extends ClusterItem> {[m
[32m+[m[32m        void onClusterInfoWindowClick(Cluster<T> cluster);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called when an individual ClusterItem is clicked.[m
[32m+[m[32m     */[m
[32m+[m[32m    public interface OnClusterItemClickListener<T extends ClusterItem> {[m
[32m+[m[32m        boolean onClusterItemClick(T item);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called when an individual ClusterItem's Info Window is clicked.[m
[32m+[m[32m     */[m
[32m+[m[32m    public interface OnClusterItemInfoWindowClickListener<T extends ClusterItem> {[m
[32m+[m[32m        void onClusterItemInfoWindowClick(T item);[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/Algorithm.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/Algorithm.java[m
[1mnew file mode 100644[m
[1mindex 0000000..362a18d[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/Algorithm.java[m
[36m@@ -0,0 +1,29 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering.algo;[m
[32m+[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.Cluster;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterItem;[m
[32m+[m
[32m+[m[32mimport java.util.Collection;[m
[32m+[m[32mimport java.util.Set;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Logic for computing clusters[m
[32m+[m[32m */[m
[32m+[m[32mpublic interface Algorithm<T extends ClusterItem> {[m
[32m+[m[32m    void addItem(T item);[m
[32m+[m
[32m+[m[32m    void addItems(Collection<T> items);[m
[32m+[m
[32m+[m[32m    void clearItems();[m
[32m+[m
[32m+[m[32m    void removeItem(T item);[m
[32m+[m
[32m+[m[32m    Set<? extends Cluster<T>> getClusters(double zoom);[m
[32m+[m
[32m+[m[32m    Collection<T> getItems();[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/NonHierarchicalDistanceBasedAlgorithm.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/NonHierarchicalDistanceBasedAlgorithm.java[m
[1mnew file mode 100644[m
[1mindex 0000000..7e975ff[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/NonHierarchicalDistanceBasedAlgorithm.java[m
[36m@@ -0,0 +1,200 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering.algo;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.Cluster;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterItem;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.projection.Bounds;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.projection.Point;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.projection.SphericalMercatorProjection;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.quadtree.PointQuadTree;[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.Collection;[m
[32m+[m[32mimport java.util.Collections;[m
[32m+[m[32mimport java.util.HashMap;[m
[32m+[m[32mimport java.util.HashSet;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m[32mimport java.util.Set;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * A simple clustering algorithm with O(nlog n) performance. Resulting clusters are not[m
[32m+[m[32m * hierarchical.[m
[32m+[m[32m * <p/>[m
[32m+[m[32m * High level algorithm:<br>[m
[32m+[m[32m * 1. Iterate over items in the order they were added (candidate clusters).<br>[m
[32m+[m[32m * 2. Create a cluster with the center of the item. <br>[m
[32m+[m[32m * 3. Add all items that are within a certain distance to the cluster. <br>[m
[32m+[m[32m * 4. Move any items out of an existing cluster if they are closer to another cluster. <br>[m
[32m+[m[32m * 5. Remove those items from the list of candidate clusters.[m
[32m+[m[32m * <p/>[m
[32m+[m[32m * Clusters have the center of the first element (not the centroid of the items within it).[m
[32m+[m[32m */[m
[32m+[m[32mpublic class NonHierarchicalDistanceBasedAlgorithm<T extends ClusterItem> implements Algorithm<T> {[m
[32m+[m[32m    public static final int MAX_DISTANCE_AT_ZOOM = 100; // essentially 100 dp.[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Any modifications should be synchronized on mQuadTree.[m
[32m+[m[32m     */[m
[32m+[m[32m    private final Collection<QuadItem<T>> mItems = new ArrayList<QuadItem<T>>();[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Any modifications should be synchronized on mQuadTree.[m
[32m+[m[32m     */[m
[32m+[m[32m    private final PointQuadTree<QuadItem<T>> mQuadTree = new PointQuadTree<QuadItem<T>>(0, 1, 0, 1);[m
[32m+[m
[32m+[m[32m    private static final SphericalMercatorProjection PROJECTION = new SphericalMercatorProjection(1);[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void addItem(T item) {[m
[32m+[m[32m        final QuadItem<T> quadItem = new QuadItem<T>(item);[m
[32m+[m[32m        synchronized (mQuadTree) {[m
[32m+[m[32m            mItems.add(quadItem);[m
[32m+[m[32m            mQuadTree.add(quadItem);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void addItems(Collection<T> items) {[m
[32m+[m[32m        for (T item : items) {[m
[32m+[m[32m            addItem(item);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void clearItems() {[m
[32m+[m[32m        synchronized (mQuadTree) {[m
[32m+[m[32m            mItems.clear();[m
[32m+[m[32m            mQuadTree.clear();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void removeItem(T item) {[m
[32m+[m[32m        // TODO: delegate QuadItem#hashCode and QuadItem#equals to its item.[m
[32m+[m[32m        throw new UnsupportedOperationException("NonHierarchicalDistanceBasedAlgorithm.remove not implemented");[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     *  cluster算法核心[m
[32m+[m[32m     * @param zoom map的级别[m
[32m+[m[32m     * @return[m
[32m+[m[32m     */[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Set<? extends Cluster<T>> getClusters(double zoom) {[m
[32m+[m[32m        final int discreteZoom = (int) zoom;[m
[32m+[m
[32m+[m[32m        final double zoomSpecificSpan = MAX_DISTANCE_AT_ZOOM / Math.pow(2, discreteZoom) / 256;[m
[32m+[m
[32m+[m[32m        final Set<QuadItem<T>> visitedCandidates = new HashSet<QuadItem<T>>();[m
[32m+[m[32m        final Set<Cluster<T>> results = new HashSet<Cluster<T>>();[m
[32m+[m[32m        final Map<QuadItem<T>, Double> distanceToCluster = new HashMap<QuadItem<T>, Double>();[m
[32m+[m[32m        final Map<QuadItem<T>, StaticCluster<T>> itemToCluster =[m
[32m+[m[32m                new HashMap<QuadItem<T>, StaticCluster<T>>();[m
[32m+[m
[32m+[m[32m        synchronized (mQuadTree) {[m
[32m+[m[32m            for (QuadItem<T> candidate : mItems) {[m
[32m+[m[32m                if (visitedCandidates.contains(candidate)) {[m
[32m+[m[32m                    // Candidate is already part of another cluster.[m
[32m+[m[32m                    continue;[m
[32m+[m[32m                }[m
[32m+[m
[32m+[m[32m                Bounds searchBounds = createBoundsFromSpan(candidate.getPoint(), zoomSpecificSpan);[m
[32m+[m[32m                Collection<QuadItem<T>> clusterItems;[m
[32m+[m[32m                // search 某边界范围内的clusterItems[m
[32m+[m[32m                clusterItems = mQuadTree.search(searchBounds);[m
[32m+[m[32m                if (clusterItems.size() == 1) {[m
[32m+[m[32m                    // Only the current marker is in range. Just add the single item to the results.[m
[32m+[m[32m                    results.add(candidate);[m
[32m+[m[32m                    visitedCandidates.add(candidate);[m
[32m+[m[32m                    distanceToCluster.put(candidate, 0d);[m
[32m+[m[32m                    continue;[m
[32m+[m[32m                }[m
[32m+[m[32m                com.baidu.mapapi.clusterutil.clustering.algo.StaticCluster<T> cluster =[m
[32m+[m[32m                        new com.baidu.mapapi.clusterutil.clustering.algo[m
[32m+[m[32m                                .StaticCluster<T>(candidate.mClusterItem.getPosition());[m
[32m+[m[32m                results.add(cluster);[m
[32m+[m
[32m+[m[32m                for (QuadItem<T> clusterItem : clusterItems) {[m
[32m+[m[32m                    Double existingDistance = distanceToCluster.get(clusterItem);[m
[32m+[m[32m                    double distance = distanceSquared(clusterItem.getPoint(), candidate.getPoint());[m
[32m+[m[32m                    if (existingDistance != null) {[m
[32m+[m[32m                        // Item already belongs to another cluster. Check if it's closer to this cluster.[m
[32m+[m[32m                        if (existingDistance < distance) {[m
[32m+[m[32m                            continue;[m
[32m+[m[32m                        }[m
[32m+[m[32m                        // Move item to the closer cluster.[m
[32m+[m[32m                        itemToCluster.get(clusterItem).remove(clusterItem.mClusterItem);[m
[32m+[m[32m                    }[m
[32m+[m[32m                    distanceToCluster.put(clusterItem, distance);[m
[32m+[m[32m                    cluster.add(clusterItem.mClusterItem);[m
[32m+[m[32m                    itemToCluster.put(clusterItem, cluster);[m
[32m+[m[32m                }[m
[32m+[m[32m                visitedCandidates.addAll(clusterItems);[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        return results;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Collection<T> getItems() {[m
[32m+[m[32m        final List<T> items = new ArrayList<T>();[m
[32m+[m[32m        synchronized (mQuadTree) {[m
[32m+[m[32m            for (QuadItem<T> quadItem : mItems) {[m
[32m+[m[32m                items.add(quadItem.mClusterItem);[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        return items;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private double distanceSquared(Point a, Point b) {[m
[32m+[m[32m        return (a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private Bounds createBoundsFromSpan(Point p, double span) {[m
[32m+[m[32m        // TODO: Use a span that takes into account the visual size of the marker, not just its[m
[32m+[m[32m        // LatLng.[m
[32m+[m[32m        double halfSpan = span warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/NonHierarchicalDistanceBasedAlgorithm.java.
The file will have its original line endings in your working directory.
/ 2;[m
[32m+[m[32m        return new Bounds([m
[32m+[m[32m                p.x - halfSpan, p.x + halfSpan,[m
[32m+[m[32m                p.y - halfSpan, p.y + halfSpan);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private static class QuadItem<T extends ClusterItem> implements PointQuadTree.Item, Cluster<T> {[m
[32m+[m[32m        private final T mClusterItem;[m
[32m+[m[32m        private final Point mPoint;[m
[32m+[m[32m        private final LatLng mPosition;[m
[32m+[m[32m        private Set<T> singletonSet;[m
[32m+[m
[32m+[m[32m        private QuadItem(T item) {[m
[32m+[m[32m            mClusterItem = item;[m
[32m+[m[32m            mPosition = item.getPosition();[m
[32m+[m[32m            mPoint = PROJECTION.toPoint(mPosition);[m
[32m+[m[32m            singletonSet = Collections.singleton(mClusterItem);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Point getPoint() {[m
[32m+[m[32m            return mPoint;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public LatLng getPosition() {[m
[32m+[m[32m            return mPosition;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Set<T> getItems() {[m
[32m+[m[32m            return singletonSet;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getSize() {[m
[32m+[m[32m            return 1;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/PreCachingAlgorithmDecorator.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/PreCachingAlgorithmDecorator.java[m
[1mnew file mode 100644[m
[1mindex 0000000..5d4a43a[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/PreCachingAlgorithmDecorator.java[m
[36m@@ -0,0 +1,113 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering.algo;[m
[32m+[m
[32m+[m[32mimport android.support.v4.util.LruCache;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.Cluster;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterItem;[m
[32m+[m
[32m+[m[32mimport java.util.Collection;[m
[32m+[m[32mimport java.util.Set;[m
[32m+[m[32mimport java.util.concurrent.locks.ReadWriteLock;[m
[32m+[m[32mimport java.util.concurrent.locks.ReentrantReadWriteLock;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Optimistically fetch clusters for adjacent zoom levels, caching them as necessary.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class PreCachingAlgorithmDecorator<T extends ClusterItem> implements Algorithm<T> {[m
[32m+[m[32m    private final Algorithm<T> mAlgorithm;[m
[32m+[m
[32m+[m[32m    // TODO: evaluate maxSize parameter for LruCache.[m
[32m+[m[32m    private final LruCache<Integer, Set<? extends Cluster<T>>> mCache =[m
[32m+[m[32m            new LruCache<Integer, Set<? extends Cluster<T>>>(5);[m
[32m+[m[32m    private final ReadWriteLock mCacheLock = new ReentrantReadWriteLock();[m
[32m+[m
[32m+[m[32m    public PreCachingAlgorithmDecorator(Algorithm<T> algorithm) {[m
[32m+[m[32m        mAlgorithm = algorithm;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void addItem(T item) {[m
[32m+[m[32m        mAlgorithm.addItem(item);[m
[32m+[m[32m        clearCache();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void addItems(Collection<T> items) {[m
[32m+[m[32m        mAlgorithm.addItems(items);[m
[32m+[m[32m        clearCache();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void clearItems() {[m
[32m+[m[32m        mAlgorithm.clearItems();[m
[32m+[m[32m        warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/PreCachingAlgorithmDecorator.java.
The file will have its original line endings in your working directory.
clearCache();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void removeItem(T item) {[m
[32m+[m[32m        mAlgorithm.removeItem(item);[m
[32m+[m[32m        clearCache();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void clearCache() {[m
[32m+[m[32m        mCache.evictAll();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Set<? extends Cluster<T>> getClusters(double zoom) {[m
[32m+[m[32m        int discreteZoom = (int) zoom;[m
[32m+[m[32m        Set<? extends Cluster<T>> results = getClustersInternal(discreteZoom);[m
[32m+[m[32m        // TODO: Check if requests are already in-flight.[m
[32m+[m[32m        if (mCache.get(discreteZoom + 1) == null) {[m
[32m+[m[32m            new Thread(new PrecacheRunnable(discreteZoom + 1)).start();[m
[32m+[m[32m        }[m
[32m+[m[32m        if (mCache.get(discreteZoom - 1) == null) {[m
[32m+[m[32m            new Thread(new PrecacheRunnable(discreteZoom - 1)).start();[m
[32m+[m[32m        }[m
[32m+[m[32m        return results;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Collection<T> getItems() {[m
[32m+[m[32m        return mAlgorithm.getItems();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private Set<? extends Cluster<T>> getClustersInternal(int discreteZoom) {[m
[32m+[m[32m        Set<? extends Cluster<T>> results;[m
[32m+[m[32m        mCacheLock.readLock().lock();[m
[32m+[m[32m        results = mCache.get(discreteZoom);[m
[32m+[m[32m        mCacheLock.readLock().unlock();[m
[32m+[m
[32m+[m[32m        if (results == null) {[m
[32m+[m[32m            mCacheLock.writeLock().lock();[m
[32m+[m[32m            results = mCache.get(discreteZoom);[m
[32m+[m[32m            if (results == null) {[m
[32m+[m[32m                results = mAlgorithm.getClusters(discreteZoom);[m
[32m+[m[32m                mCache.put(discreteZoom, results);[m
[32m+[m[32m            }[m
[32m+[m[32m            mCacheLock.writeLock().unlock();[m
[32m+[m[32m        }[m
[32m+[m[32m        return results;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private class PrecacheRunnable implements Runnable {[m
[32m+[m[32m        private final int mZoom;[m
[32m+[m
[32m+[m[32m        public PrecacheRunnable(int zoom) {[m
[32m+[m[32m            mZoom = zoom;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void run() {[m
[32m+[m[32m            try {[m
[32m+[m[32m                // Wait between 500 - 1000 ms.[m
[32m+[m[32m                Thread.sleep((long) (Math.random() * 500 + 500));[m
[32m+[m[32m            } catch (InterruptedException e) {[m
[32m+[m[32m                // ignore. keep going.[m
[32m+[m[32m            }[m
[32m+[m[32m            getClustersInternal(mZoom);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/StaticCluster.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/StaticCluster.java[m
[1mnew file mode 100644[m
[1mindex 0000000..bdd6576[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/StaticCluster.java[m
[36m@@ -0,0 +1,58 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering.algo;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.Cluster;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterItem;[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.Collection;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * A cluster whose center is determined upon creation.[m
[32m+[m[32m */[m
[32warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/algo/StaticCluster.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/ClusterRenderer.java.
The file will have its original line endings in your working directory.
m+[m[32mpublic class StaticCluster<T extends ClusterItem> implements Cluster<T> {[m
[32m+[m[32m    private final LatLng mCenter;[m
[32m+[m[32m    private final List<T> mItems = new ArrayList<T>();[m
[32m+[m
[32m+[m[32m    public StaticCluster(LatLng center) {[m
[32m+[m[32m        mCenter = center;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m
[32m+[m[32m    public boolean add(T t) {[m
[32m+[m[32m        return mItems.add(t);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public LatLng getPosition() {[m
[32m+[m[32m        return mCenter;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public boolean remove(T t) {[m
[32m+[m[32m        return mItems.remove(t);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public Collection<T> getItems() {[m
[32m+[m[32m        return mItems;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public int getSize() {[m
[32m+[m[32m        return mItems.size();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public String toString() {[m
[32m+[m[32m        return "StaticCluster{"[m
[32m+[m[32m                + "mCenter=" + mCenter[m
[32m+[m[32m                + ", mItems.size=" + mItems.size()[m
[32m+[m[32m                + '}';[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/ClusterRenderer.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/ClusterRenderer.java[m
[1mnew file mode 100644[m
[1mindex 0000000..bb0f547[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/ClusterRenderer.java[m
[36m@@ -0,0 +1,42 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering.view;[m
[32m+[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.Cluster;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterItem;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterManager;[m
[32m+[m
[32m+[m[32mimport java.util.Set;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Renders clusters.[m
[32m+[m[32m */[m
[32m+[m[32mpublic interface ClusterRenderer<T extends ClusterItem> {[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called when the view needs to be updated because new clusters need to be displayed.[m
[32m+[m[32m     * @param clusters the clusters to be displayed.[m
[32m+[m[32m     */[m
[32m+[m[32m    void onClustersChanged(Set<? extends Cluster<T>> clusters);[m
[32m+[m
[32m+[m[32m    void setOnClusterClickListener(ClusterManager.OnClusterClickListener<T> listener);[m
[32m+[m
[32m+[m[32m    void setOnClusterInfoWindowClickListener(ClusterManager.OnClusterInfoWindowClickListener<T> listener);[m
[32m+[m
[32m+[m[32m    void setOnClusterItemClickListener(ClusterManager.OnClusterItemClickListener<T> listener);[m
[32m+[m
[32m+[m[32m    void setOnClusterItemInfoWindowClickListener(ClusterManager.OnClusterItemInfoWindowClickListener<T> listener);[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called when the view is added.[m
[32m+[m[32m     */[m
[32m+[m[32m    void onAdd();[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called when the view is removed.[m
[32m+[m[32m     */[m
[32m+[m[32m    void onRemove();[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/DefaultClusterRenderer.java b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/DefaultClusterRenderer.java[m
[1mnew file mode 100644[m
[1mindex 0000000..e2029a6[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/DefaultClusterRenderer.java[m
[36m@@ -0,0 +1,923 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.clustering.view;[m
[32m+[m
[32m+[m[32mimport android.animation.Animator;[m
[32m+[m[32mimport android.animation.AnimatorListenerAdapter;[m
[32m+[m[32mimport android.animation.TimeInterpolator;[m
[32m+[m[32mimport android.animation.ValueAnimator;[m
[32m+[m[32mimport android.annotation.SuppressLint;[m
[32m+[m[32mimport android.annotation.TargetApi;[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.graphics.Color;[m
[32m+[m[32mimport android.graphics.drawable.Drawable;[m
[32m+[m[32mimport android.graphics.drawable.LayerDrawable;[m
[32m+[m[32mimport android.graphics.drawable.ShapeDrawable;[m
[32m+[m[32mimport android.graphics.drawable.shapes.OvalShape;[m
[32m+[m[32mimport android.os.Build;[m
[32m+[m[32mimport android.os.Handler;[m
[32m+[m[32mimport android.os.Looper;[m
[32m+[m[32mimport android.os.Message;[m
[32m+[m[32mimport android.os.MessageQueue;[m
[32m+[m[32mimport android.util.SparseArray;[m
[32m+[m[32mimport android.view.ViewGroup;[m
[32m+[m[32mimport android.view.animation.DecelerateInterpolator;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.MarkerManager;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.Cluster;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterItem;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterManager;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.projection.Point;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.projection.SphericalMercatorProjection;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.ui.IconGenerator;[m
[32m+[m[32mimport com.baidu.mapapi.map.BaiduMap;[m
[32m+[m[32mimport com.baidu.mapapi.map.BitmapDescriptor;[m
[32m+[m[32mimport com.baidu.mapapi.map.BitmapDescriptorFactory;[m
[32m+[m[32mimport com.baidu.mapapi.map.Marker;[m
[32m+[m[32mimport com.baidu.mapapi.map.MarkerOptions;[m
[32m+[m[32mimport com.baidu.mapapi.map.Projection;[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLngBounds;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.Collections;[m
[32m+[m[32mimport java.util.HashMap;[m
[32m+[m[32mimport java.util.LinkedList;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m[32mimport java.util.Queue;[m
[32m+[m[32mimport java.util.Set;[m
[32m+[m[32mimport java.util.concurrent.ConcurrentHashMap;[m
[32m+[m[32mimport java.util.concurrent.locks.Condition;[m
[32m+[m[32mimport java.util.concurrent.locks.Lock;[m
[32m+[m[32mimport java.util.concurrent.locks.ReentrantLock;[m
[32m+[m
[32m+[m
[32m+[m[32mimport static com.baidu.mapapi.clusterutil.clustering.algo.NonHierarchicalDistanceBasedAlgorithm.MAX_DISTANCE_AT_ZOOM;[m
[32m+[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * The default view for a ClusterManager. Markers are animated in and out of clusters.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class DefaultClusterRenderer<T extends ClusterItem> implements[m
[32m+[m[32m        com.baidu.mapapi.clusterutil.clustering.view.ClusterRenderer<T> {[m
[32m+[m[32m    private static final boolean SHOULD_ANIMATE = Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB;[m
[32m+[m[32m    private final BaiduMap mMap;[m
[32m+[m[32m    private final IconGenerator mIconGenerator;[m
[32m+[m[32m    private final ClusterManager<T> mClusterManager;[m
[32m+[m[32m    private final float mDensity;[m
[32m+[m
[32m+[m[32m    private static final int[] BUCKETS = {10, 20, 50, 100, 200, 500, 1000};[m
[32m+[m[32m    private ShapeDrawable mColoredCircleBackground;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Markers that are currently on the map.[m
[32m+[m[32m     */[m
[32m+[m[32m    private Set<MarkerWithPosition> mMarkers = Collections.newSetFromMap([m
[32m+[m[32m            new ConcurrentHashMap<MarkerWithPosition, Boolean>());[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Icons for each bucket.[m
[32m+[m[32m     */[m
[32m+[m[32m    private SparseArray<BitmapDescriptor> mIcons = new SparseArray<BitmapDescriptor>();[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Markers for single ClusterItems.[m
[32m+[m[32m     */[m
[32m+[m[32m    private MarkerCache<T> mMarkerCache = new MarkerCache<T>();[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * If cluster size is less than this size, display individual markers.[m
[32m+[m[32m     */[m
[32m+[m[32m    private static final int MIN_CLUSTER_SIZE = 4;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * The currently displayed set of clusters.[m
[32m+[m[32m     */[m
[32m+[m[32m    private Set<? extends Cluster<T>> mClusters;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Lookup between markers and the associated cluster.[m
[32m+[m[32m     */[m
[32m+[m[32m    private Map<Marker, Cluster<T>> mMarkerToCluster = new HashMap<Marker, Cluster<T>>();[m
[32m+[m[32m    private Map<Cluster<T>, Marker> mClusterToMarker = new HashMap<Cluster<T>, Marker>();[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * The target zoom level for the current set of clusters.[m
[32m+[m[32m     */[m
[32m+[m[32m    private float mZoom;[m
[32m+[m
[32m+[m[32m    private final ViewModifier mViewModifier = new ViewModifier();[m
[32m+[m
[32m+[m[32m    private ClusterManager.OnClusterClickListener<T> mClickListener;[m
[32m+[m[32m    private ClusterManager.OnClusterInfoWindowClickListener<T> mInfoWindowClickListener;[m
[32m+[m[32m    private ClusterManager.OnClusterItemClickListener<T> mItemClickListener;[m
[32m+[m[32m    private ClusterManager.OnClusterItemInfoWindowClickListener<T> mItemInfoWindowClickListener;[m
[32m+[m
[32m+[m[32m    public DefaultClusterRenderer(Context context, BaiduMap map, ClusterManager<T> clusterManager) {[m
[32m+[m[32m        mMap = map;[m
[32m+[m[32m        mDensity = context.getResources().getDisplayMetrics().density;[m
[32m+[m[32m        mIconGenerator = new IconGenerator(context);[m
[32m+[m[32m        mIconGenerator.setContentView(makeSquareTextView(context));[m
[32m+[m[32m        mIconGenerator.setTextAppearance(R.style.ClusterIcon_TextAppearance);[m
[32m+[m[32m        mIconGenerator.setBackground(makeClusterBackground());[m
[32m+[m[32m        mClusterManager = clusterManager;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onAdd() {[m
[32m+[m[32m        mClusterManager.getMarkerCollection().setOnMarkerClickListener(new BaiduMap.OnMarkerClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public boolean onMarkerClick(Marker marker) {[m
[32m+[m[32m                return mItemClickListener != null && mItemClickListener.onClusterItemClick(mMarkerCache.get(marker));[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m
[32m+[m
[32m+[m[32m        mClusterManager.getClusterMarkerCollection().setOnMarkerClickListener(new BaiduMap.OnMarkerClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public boolean onMarkerClick(Marker marker) {[m
[32m+[m[32m                return mClickListener != null && mClickListener.onClusterClick(mMarkerToCluster.get(marker));[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onRemove() {[m
[32m+[m[32m        mClusterManager.getMarkerCollection().setOnMarkerClickListener(null);[m
[32m+[m[32m        mClusterManager.getClusterMarkerCollection().setOnMarkerClickListener(null);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private LayerDrawable makeClusterBackground() {[m
[32m+[m[32m        mColoredCircleBackground = new ShapeDrawable(new OvalShape());[m
[32m+[m[32m        ShapeDrawable outline = new ShapeDrawable(new OvalShape());[m
[32m+[m[32m        outline.getPaint().setColor(0x80ffffff); // Transparent white.[m
[32m+[m[32m        LayerDrawable background = new LayerDrawable(new Drawable[]{outline, mColoredCircleBackground});[m
[32m+[m[32m        int strokeWidth = (int) (mDensity * 3);[m
[32m+[m[32m        background.setLayerInset(1, strokeWidth, strokeWidth, strokeWidth, strokeWidth);[m
[32m+[m[32m        return background;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private com.baidu.mapapi.clusterutil.ui.SquareTextView makeSquareTextView(Context context) {[m
[32m+[m[32m        com.baidu.mapapi.clusterutil.ui.SquareTextView squareTextView =[m
[32m+[m[32m                new com.baidu.mapapi.clusterutil.ui.SquareTextView(context);[m
[32m+[m[32m        ViewGroup.LayoutParams layoutParams = new ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,[m
[32m+[m[32m                ViewGroup.LayoutParams.WRAP_CONTENT);[m
[32m+[m[32m        squareTextView.setLayoutParams(layoutParams);[m
[32m+[m[32m        squareTextView.setId(R.id.text);[m
[32m+[m[32m        int twelveDpi = (int) (12 * mDensity);[m
[32m+[m[32m        squareTextView.setPadding(twelveDpi, twelveDpi, twelveDpi, twelveDpi);[m
[32m+[m[32m        return squareTextView;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private int getColor(int clusterSize) {[m
[32m+[m[32m        final float hueRange = 220;[m
[32m+[m[32m        final float sizeRange = 300;[m
[32m+[m[32m        final float size = Math.min(clusterSize, sizeRange);[m
[32m+[m[32m        final float hue = (sizeRange - size) * (sizeRange - size) / (sizeRange * sizeRange) * hueRange;[m
[32m+[m[32m        return Color.HSVToColor(new float[]{[m
[32m+[m[32m                hue, 1f, .6f[m
[32m+[m[32m        });[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    protected String getClusterText(int bucket) {[m
[32m+[m[32m        if (bucket < BUCKETS[0]) {[m
[32m+[m[32m            return String.valueOf(bucket);[m
[32m+[m[32m        }[m
[32m+[m[32m        return String.valueOf(bucket) + "+";[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Gets the "bucket" for a particular cluster. By default, uses the number of points within the[m
[32m+[m[32m     * cluster, bucketed to some set points.[m
[32m+[m[32m     */[m
[32m+[m[32m    protected int getBucket(Cluster<T> cluster) {[m
[32m+[m[32m        int size = cluster.getSize();[m
[32m+[m[32m        if (size <= BUCKETS[0]) {[m
[32m+[m[32m            return size;[m
[32m+[m[32m        }[m
[32m+[m[32m        for (int i = 0; i < BUCKETS.length - 1; i++) {[m
[32m+[m[32m            if (size < BUCKETS[i + 1]) {[m
[32m+[m[32m                return BUCKETS[i];[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        return BUCKETS[BUCKETS.length - 1];[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * ViewModifier ensures only one re-rendering of the view occurs at a time, and schedules[m
[32m+[m[32m     * re-rendering, which is performed by the RenderTask.[m
[32m+[m[32m     */[m
[32m+[m[32m    @SuppressLint("HandlerLeak")[m
[32m+[m[32m    private class ViewModifier extends Handler {[m
[32m+[m[32m        private static final int RUN_TASK = 0;[m
[32m+[m[32m        private static final int TASK_FINISHED = 1;[m
[32m+[m[32m        private boolean mViewModificationInProgress = false;[m
[32m+[m[32m        private RenderTask mNextClusters = null;[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void handleMessage(Message msg) {[m
[32m+[m[32m            if (msg.what == TASK_FINISHED) {[m
[32m+[m[32m                mViewModificationInProgress = false;[m
[32m+[m[32m                if (mNextClusters != null) {[m
[32m+[m[32m                    // Run the task that was queued up.[m
[32m+[m[32m                    sendEmptyMessage(RUN_TASK);[m
[32m+[m[32m                }[m
[32m+[m[32m                return;[m
[32m+[m[32m            }[m
[32m+[m[32m            removeMessages(RUN_TASK);[m
[32m+[m
[32m+[m[32m            if (mViewModificationInProgress) {[m
[32m+[m[32m                // Busy - wait for the callback.[m
[32m+[m[32m                return;[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            if (mNextClusters == null) {[m
[32m+[m[32m                // Nothing to do.[m
[32m+[m[32m                return;[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            RenderTask renderTask;[m
[32m+[m[32m            synchronized (this) {[m
[32m+[m[32m                renderTask = mNextClusters;[m
[32m+[m[32m                mNextClusters = null;[m
[32m+[m[32m                mViewModificationInProgress = true;[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            renderTask.setCallback(new Runnable() {[m
[32m+[m[32m                @Override[m
[32m+[m[32m                public void run() {[m
[32m+[m[32m                    sendEmptyMessage(TASK_FINISHED);[m
[32m+[m[32m                }[m
[32m+[m[32m            });[m
[32m+[m[32m            renderTask.setProjection(mMap.getProjection());[m
[32m+[m[32m            renderTask.setMapZoom(mMap.getMapStatus().zoom);[m
[32m+[m[32m            new Thread(renderTask).start();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void queue(Set<? extends Cluster<T>> clusters) {[m
[32m+[m[32m            synchronized (this) {[m
[32m+[m[32m                // Overwrite any pending cluster tasks - we don't care about intermediate states.[m
[32m+[m[32m                mNextClusters = new RenderTask(clusters);[m
[32m+[m[32m            }[m
[32m+[m[32m            sendEmptyMessage(RUN_TASK);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Determine whether the cluster should be rendered as individual markers or a cluster.[m
[32m+[m[32m     */[m
[32m+[m[32m    protected boolean shouldRenderAsCluster(Cluster<T> cluster) {[m
[32m+[m[32m        return cluster.getSize() > MIN_CLUSTER_SIZE;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Transforms the current view (represented by DefaultClusterRenderer.mClusters and DefaultClusterRenderer.mZoom) to a[m
[32m+[m[32m     * new zoom level and set of clusters.[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * This must be run off the UI thread. Work is coordinated in the RenderTask, then queued up to[m
[32m+[m[32m     * be executed by a MarkerModifier.[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * There are three stages for the render:[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * 1. Markers are added to the map[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * 2. Markers are animated to their final position[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * 3. Any old markers are removed from the map[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * When zooming in, markers are animated out from the nearest existing cluster. When zooming[m
[32m+[m[32m     * out, existing clusters are animated to the nearest new cluster.[m
[32m+[m[32m     */[m
[32m+[m[32m    private class RenderTask implements Runnable {[m
[32m+[m[32m        final Set<? extends Cluster<T>> clusters;[m
[32m+[m[32m        private Runnable mCallback;[m
[32m+[m[32m        private Projection mProjection;[m
[32m+[m[32m        private SphericalMercatorProjection mSphericalMercatorProjection;[m
[32m+[m[32m        private float mMapZoom;[m
[32m+[m
[32m+[m[32m        private RenderTask(Set<? extends Cluster<T>> clusters) {[m
[32m+[m[32m            this.clusters = clusters;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * A callback to be run when all work has been completed.[m
[32m+[m[32m         *[m
[32m+[m[32m         * @param callback[m
[32m+[m[32m         */[m
[32m+[m[32m        public void setCallback(Runnable callback) {[m
[32m+[m[32m            mCallback = callback;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void setProjection(Projection projection) {[m
[32m+[m[32m            this.mProjection = projection;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void setMapZoom(float zoom) {[m
[32m+[m[32m            this.mMapZoom = zoom;[m
[32m+[m[32m            this.mSphericalMercatorProjection =[m
[32m+[m[32m                    new SphericalMercatorProjection(256 * Math.pow(2, Math.min(zoom, mZoom)));[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @SuppressLint("NewApi")[m
[32m+[m[32m        public void run() {[m
[32m+[m[32m            if (clusters.equals(DefaultClusterRenderer.this.mClusters)) {[m
[32m+[m[32m                mCallback.run();[m
[32m+[m[32m                return;[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            final MarkerModifier markerModifier = new MarkerModifier();[m
[32m+[m
[32m+[m[32m            final float zoom = mMapZoom;[m
[32m+[m[32m            final boolean zoomingIn = zoom > mZoom;[m
[32m+[m[32m            final float zoomDelta = zoom - mZoom;[m
[32m+[m
[32m+[m[32m            final Set<MarkerWithPosition> markersToRemove = mMarkers;[m
[32m+[m[32m            final LatLngBounds visibleBounds = mMap.getMapStatus().bound;[m
[32m+[m[32m            // TODO: Add some padding, so that markers can animate in from off-screen.[m
[32m+[m
[32m+[m[32m            // Find all of the existing clusters that are on-screen. These are candidates for[m
[32m+[m[32m            // markers to animate from.[m
[32m+[m[32m            List<Point> existingClustersOnScreen = null;[m
[32m+[m[32m            if (DefaultClusterRenderer.this.mClusters != null && SHOULD_ANIMATE) {[m
[32m+[m[32m                existingClustersOnScreen = new ArrayList<Point>();[m
[32m+[m[32m                for (Cluster<T> c : DefaultClusterRenderer.this.mClusters) {[m
[32m+[m[32m                    if (shouldRenderAsCluster(c) && visibleBounds.contains(c.getPosition())) {[m
[32m+[m[32m                        Point point = mSphericalMercatorProjection.toPoint(c.getPosition());[m
[32m+[m[32m                        existingClustersOnScreen.add(point);[m
[32m+[m[32m                    }[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            // Create the new markers and animate them to their new positions.[m
[32m+[m[32m            final Set<MarkerWithPosition> newMarkers = Collections.newSetFromMap([m
[32m+[m[32m                    new ConcurrentHashMap<MarkerWithPosition, Boolean>());[m
[32m+[m[32m            for (Cluster<T> c : clusters) {[m
[32m+[m[32m                boolean onScreen = visibleBounds.contains(c.getPosition());[m
[32m+[m[32m                if (zoomingIn && onScreen && SHOULD_ANIMATE) {[m
[32m+[m[32m                    Point point = mSphericalMercatorProjection.toPoint(c.getPosition());[m
[32m+[m[32m                    Point closest = findClosestCluster(existingClustersOnScreen, point);[m
[32m+[m[32m                    if (closest != null) {[m
[32m+[m[32m                        LatLng animateTo = mSphericalMercatorProjection.toLatLng(closest);[m
[32m+[m[32m                        markerModifier.add(true, new CreateMarkerTask(c, newMarkers, animateTo));[m
[32m+[m[32m                    } else {[m
[32m+[m[32m                        markerModifier.add(true, new CreateMarkerTask(c, newMarkers, null));[m
[32m+[m[32m                    }[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    markerModifier.add(onScreen, new CreateMarkerTask(c, newMarkers, null));[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            // Wait for all markers to be added.[m
[32m+[m[32m            markerModifier.waitUntilFree();[m
[32m+[m
[32m+[m[32m            // Don't remove any markers that were just added. This is basically anything that had[m
[32m+[m[32m            // a hit in the MarkerCache.[m
[32m+[m[32m            markersToRemove.removeAll(newMarkers);[m
[32m+[m
[32m+[m[32m            // Find all of the new clusters that were added on-screen. These are candidates for[m
[32m+[m[32m            // markers to animate from.[m
[32m+[m[32m            List<Point> newClustersOnScreen = null;[m
[32m+[m[32m            if (SHOULD_ANIMATE) {[m
[32m+[m[32m                newClustersOnScreen = new ArrayList<Point>();[m
[32m+[m[32m                for (Cluster<T> c : clusters) {[m
[32m+[m[32m                    if (shouldRenderAsCluster(c) && visibleBounds.contains(c.getPosition())) {[m
[32m+[m[32m                        Point p = mSphericalMercatorProjection.toPoint(c.getPosition());[m
[32m+[m[32m                        newClustersOnScreen.add(p);[m
[32m+[m[32m                    }[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            // Remove the old markers, animating them into clusters if zooming out.[m
[32m+[m[32m            for (final MarkerWithPosition marker : markersToRemove) {[m
[32m+[m[32m                boolean onScreen = visibleBounds.contains(marker.position);[m
[32m+[m[32m                // Don't animate when zooming out more than 3 zoom levels.[m
[32m+[m[32m                // TODO: drop animation based on speed of device & number of markers to animate.[m
[32m+[m[32m                if (!zoomingIn && zoomDelta > -3 && onScreen && SHOULD_ANIMATE) {[m
[32m+[m[32m                    final Point point = mSphericalMercatorProjection.toPoint(marker.position);[m
[32m+[m[32m                    final Point closest = findClosestCluster(newClustersOnScreen, point);[m
[32m+[m[32m                    if (closest != null) {[m
[32m+[m[32m                        LatLng animateTo = mSphericalMercatorProjection.toLatLng(closest);[m
[32m+[m[32m                        markerModifier.animateThenRemove(marker, marker.position, animateTo);[m
[32m+[m[32m                    } else {[m
[32m+[m[32m                        markerModifier.remove(true, marker.marker);[m
[32m+[m[32m                    }[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    markerModifier.remove(onScreen, marker.marker);[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            markerModifier.waitUntilFree();[m
[32m+[m
[32m+[m[32m            mMarkers = newMarkers;[m
[32m+[m[32m            DefaultClusterRenderer.this.mClusters = clusters;[m
[32m+[m[32m            mZoom = zoom;[m
[32m+[m
[32m+[m[32m            mCallback.run();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onClustersChanged(Set<? extends Cluster<T>> clusters) {[m
[32m+[m[32m        mViewModifier.queue(clusters);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void setOnClusterClickListener(ClusterManager.OnClusterClickListener<T> listener) {[m
[32m+[m[32m        mClickListener = listener;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void setOnClusterInfoWindowClickListener(ClusterManager[m
[32m+[m[32m                                                                .OnClusterInfoWindowClickListener<T> listener) {[m
[32m+[m[32m        mInfoWindowClickListener = listener;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void setOnClusterItemClickListener(ClusterManager.OnClusterItemClickListener<T> listener) {[m
[32m+[m[32m        mItemClickListener = listener;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void setOnClusterItemInfoWindowClickListener(ClusterManager[m
[32m+[m[32m                                                                    .OnClusterItemInfoWindowClickListener<T> listener) {[m
[32m+[m[32m        mItemInfoWindowClickListener = listener;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private static double distanceSquared(Point a, Point b) {[m
[32m+[m[32m        return (a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private static Point findClosestCluster(List<Point> markers, Point point) {[m
[32m+[m[32m        if (markers == null || markers.isEmpty()) {[m
[32m+[m[32m            return null;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // TODO: make this configurable.[m
[32m+[m[32m        double minDistSquared = MAX_DISTANCE_AT_ZOOM * MAX_DISTANCE_AT_ZOOM;[m
[32m+[m[32m        Point closest = null;[m
[32m+[m[32m        for (Point candidate : markers) {[m
[32m+[m[32m            double dist = distanceSquared(candidate, point);[m
[32m+[m[32m            if (dist < minDistSquared) {[m
[32m+[m[32m                closest = candidate;[m
[32m+[m[32m                minDistSquared = dist;[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        return closest;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Handles all markerWithPosition manipulations on the map. Work (such as adding, removing, or[m
[32m+[m[32m     * animating a markerWithPosition) is performed while trying not to block the rest of the app's[m
[32m+[m[32m     * UI.[m
[32m+[m[32m     */[m
[32m+[m[32m    @SuppressLint("HandlerLeak")[m
[32m+[m[32m    private class MarkerModifier extends Handler implements MessageQueue.IdleHandler {[m
[32m+[m[32m        private static final int BLANK = 0;[m
[32m+[m
[32m+[m[32m        private final Lock lock = new ReentrantLock();[m
[32m+[m[32m        private final Condition busyCondition = lock.newCondition();[m
[32m+[m
[32m+[m[32m        private Queue<CreateMarkerTask> mCreateMarkerTasks = new LinkedList<CreateMarkerTask>();[m
[32m+[m[32m        private Queue<CreateMarkerTask> mOnScreenCreateMarkerTasks = new LinkedList<CreateMarkerTask>();[m
[32m+[m[32m        private Queue<Marker> mRemoveMarkerTasks = new LinkedList<Marker>();[m
[32m+[m[32m        private Queue<Marker> mOnScreenRemoveMarkerTasks = new LinkedList<Marker>();[m
[32m+[m[32m        private Queue<AnimationTask> mAnimationTasks = new LinkedList<AnimationTask>();[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * Whether the idle listener has been added to the UI thread's MessageQueue.[m
[32m+[m[32m         */[m
[32m+[m[32m        private boolean mListenerAdded;[m
[32m+[m
[32m+[m[32m        private MarkerModifier() {[m
[32m+[m[32m            super(Looper.getMainLooper());[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * Creates markers for a cluster some time in the future.[m
[32m+[m[32m         *[m
[32m+[m[32m         * @param priority whether this operation should have priority.[m
[32m+[m[32m         */[m
[32m+[m[32m        public void add(boolean priority, CreateMarkerTask c) {[m
[32m+[m[32m            lock.lock();[m
[32m+[m[32m            sendEmptyMessage(BLANK);[m
[32m+[m[32m            if (priority) {[m
[32m+[m[32m                mOnScreenCreateMarkerTasks.add(c);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                mCreateMarkerTasks.add(c);[m
[32m+[m[32m            }[m
[32m+[m[32m            lock.unlock();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * Removes a markerWithPosition some time in the future.[m
[32m+[m[32m         *[m
[32m+[m[32m         * @param priority whether this operation should have priority.[m
[32m+[m[32m         * @param m        the markerWithPosition to remove.[m
[32m+[m[32m         */[m
[32m+[m[32m        public void remove(boolean priority, Marker m) {[m
[32m+[m[32m            lock.lock();[m
[32m+[m[32m            sendEmptyMessage(BLANK);[m
[32m+[m[32m            if (priority) {[m
[32m+[m[32m                mOnScreenRemoveMarkerTasks.add(m);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                mRemoveMarkerTasks.add(m);[m
[32m+[m[32m            }[m
[32m+[m[32m            lock.unlock();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * Animates a markerWithPosition some time in the future.[m
[32m+[m[32m         *[m
[32m+[m[32m         * @param marker the markerWithPosition to animate.[m
[32m+[m[32m         * @param from   the position to animate from.[m
[32m+[m[32m         * @param to     the position to animate to.[m
[32m+[m[32m         */[m
[32m+[m[32m        public void animate(MarkerWithPosition marker, LatLng from, LatLng to) {[m
[32m+[m[32m            lock.lock();[m
[32m+[m[32m            mAnimationTasks.add(new AnimationTask(marker, from, to));[m
[32m+[m[32m            lock.unlock();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * Animates a markerWithPosition some time in the future, and removes it when the animation[m
[32m+[m[32m         * is complete.[m
[32m+[m[32m         *[m
[32m+[m[32m         * @param marker the markerWithPosition to animate.[m
[32m+[m[32m         * @param from   the position to animate from.[m
[32m+[m[32m         * @param to     the position to animate to.[m
[32m+[m[32m         */[m
[32m+[m[32m        public void animateThenRemove(MarkerWithPosition marker, LatLng from, LatLng to) {[m
[32m+[m[32m            lock.lock();[m
[32m+[m[32m            AnimationTask animationTask = new AnimationTask(marker, from, to);[m
[32m+[m[32m            animationTask.removeOnAnimationComplete(mClusterManager.getMarkerManager());[m
[32m+[m[32m            mAnimationTasks.add(animationTask);[m
[32m+[m[32m            lock.unlock();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void handleMessage(Message msg) {[m
[32m+[m[32m            if (!mListenerAdded) {[m
[32m+[m[32m                Looper.myQueue().addIdleHandler(this);[m
[32m+[m[32m                mListenerAdded = true;[m
[32m+[m[32m            }[m
[32m+[m[32m            removeMessages(BLANK);[m
[32m+[m
[32m+[m[32m            lock.lock();[m
[32m+[m[32m            try {[m
[32m+[m
[32m+[m[32m                // Perform up to 10 tasks at once.[m
[32m+[m[32m                // Consider only performing 10 remove tasks, not adds and animations.[m
[32m+[m[32m                // Removes are relatively slow and are much better when batched.[m
[32m+[m[32m                for (int i = 0; i < 10; i++) {[m
[32m+[m[32m                    performNextTask();[m
[32m+[m[32m                }[m
[32m+[m
[32m+[m[32m                if (!isBusy()) {[m
[32m+[m[32m                    mListenerAdded = false;[m
[32m+[m[32m                    Looper.myQueue().removeIdleHandler(this);[m
[32m+[m[32m                    // Signal any other threads that are waiting.[m
[32m+[m[32m                    busyCondition.signalAll();[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    // Sometimes the idle queue may not be called - schedule up some work regardless[m
[32m+[m[32m                    // of whether the UI thread is busy or not.[m
[32m+[m[32m                    // TODO: try to remove this.[m
[32m+[m[32m                    sendEmptyMessageDelayed(BLANK, 10);[m
[32m+[m[32m                }[m
[32m+[m[32m            } finally {[m
[32m+[m[32m                lock.unlock();[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * Perform the next task. Prioritise any on-screen work.[m
[32m+[m[32m         */[m
[32m+[m[32m        private void performNextTask() {[m
[32m+[m[32m            if (!mOnScreenRemoveMarkerTasks.isEmpty()) {[m
[32m+[m[32m                removeMarker(mOnScreenRemoveMarkerTasks.poll());[m
[32m+[m[32m            } else if (!mAnimationTasks.isEmpty()) {[m
[32m+[m[32m                mAnimationTasks.poll().perform();[m
[32m+[m[32m            } else if (!mOnScreenCreateMarkerTasks.isEmpty()) {[m
[32m+[m[32m                mOnScreenCreateMarkerTasks.poll().perform(this);[m
[32m+[m[32m            } else if (!mCreateMarkerTasks.isEmpty()) {[m
[32m+[m[32m                mCreateMarkerTasks.poll().perform(this);[m
[32m+[m[32m            } else if (!mRemoveMarkerTasks.isEmpty()) {[m
[32m+[m[32m                removeMarker(mRemoveMarkerTasks.poll());[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        private void removeMarker(Marker m) {[m
[32m+[m[32m            Cluster<T> cluster = mMarkerToCluster.get(m);[m
[32m+[m[32m            mClusterToMarker.remove(cluster);[m
[32m+[m[32m            mMarkerCache.remove(m);[m
[32m+[m[32m            mMarkerToCluster.remove(m);[m
[32m+[m[32m            mClusterManager.getMarkerManager().remove(m);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * @return true if there is still work to be processed.[m
[32m+[m[32m         */[m
[32m+[m[32m        public boolean isBusy() {[m
[32m+[m[32m            try {[m
[32m+[m[32m                lock.lock();[m
[32m+[m[32m                return !(mCreateMarkerTasks.isEmpty() && mOnScreenCreateMarkerTasks.isEmpty()[m
[32m+[m[32m                        && mOnScreenRemoveMarkerTasks.isEmpty() && mRemoveMarkerTasks.isEmpty()[m
[32m+[m[32m                                && mAnimationTasks.isEmpty());[m
[32m+[m[32m            } finally {[m
[32m+[m[32m                lock.unlock();[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * Blocks the calling thread until all work has been processed.[m
[32m+[m[32m         */[m
[32m+[m[32m        public void waitUntilFree() {[m
[32m+[m[32m            while (isBusy()) {[m
[32m+[m[32m                // Sometimes the idle queue may not be called - schedule up some work regardless[m
[32m+[m[32m                // of whether the UI thread is busy or not.[m
[32m+[m[32m                // TODO: try to remove this.[m
[32m+[m[32m                sendEmptyMessage(BLANK);[m
[32m+[m[32m                lock.lock();[m
[32m+[m[32m                try {[m
[32m+[m[32m                    if (isBusy()) {[m
[32m+[m[32m                        busyCondition.await();[m
[32m+[m[32m                    }[m
[32m+[m[32m                } catch (InterruptedException e) {[m
[32m+[m[32m                    throw new RuntimeException(e);[m
[32m+[m[32m                } finally {[m
[32m+[m[32m                    lock.unlock();[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean queueIdle() {[m
[32m+[m[32m            // When the UI is not busy, schedule some work.[m
[32m+[m[32m            sendEmptyMessage(BLANK);[m
[32m+[m[32m            return true;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * A cache of markers representing individual ClusterItems.[m
[32m+[m[32m     */[m
[32m+[m[32m    private static class MarkerCache<T> {[m
[32m+[m[32m        private Map<T, Marker> mCache = new HashMap<T, Marker>();[m
[32m+[m[32m        private Map<Marker, T> mCacheReverse = new HashMap<Marker, T>();[m
[32m+[m
[32m+[m[32m        public Marker get(T item) {[m
[32m+[m[32m            return mCache.get(item);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public T get(Marker m) {[m
[32m+[m[32m            return mCacheReverse.get(m);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void put(T item, Marker m) {[m
[32m+[m[32m            mCache.put(item, m);[m
[32m+[m[32m            mCacheReverse.put(m, item);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void remove(Marker m) {[m
[32m+[m[32m            T item = mCacheReverse.get(m);[m
[32m+[m[32m            mCacheReverse.remove(m);[m
[32m+[m[32m            mCache.remove(item);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called before the marker for a ClusterItem is added to the map.[m
[32m+[m[32m     */[m
[32m+[m[32m    protected void onBeforeClusterItemRendered(T item, MarkerOptions markerOptions) {[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called before the marker for a Cluster is added to the map.[m
[32m+[m[32m     * The default implementation draws a circle with a rough count of the number of items.[m
[32m+[m[32m     */[m
[32m+[m[32m    protected void onBeforeClusterRendered(Cluster<T> cluster, MarkerOptions markerOptions) {[m
[32m+[m[32m        int bucket = getBucket(cluster);[m
[32m+[m[32m        BitmapDescriptor descriptor = mIcons.get(bucket);[m
[32m+[m[32m        if (descriptor == null) {[m
[32m+[m[32m            mColoredCircleBackground.getPaint().setColor(getColor(bucket));[m
[32m+[m[32m            descriptor = BitmapDescriptorFactory.fromBitmap(mIconGenerator.makeIcon(getClusterText(bucket)));[m
[32m+[m[32m            mIcons.put(bucket, descriptor);[m
[32m+[m[32m        }[m
[32m+[m[32m        // TODO: consider adding anchor(.5, .5) (Individual markers will overlap more often)[m
[32m+[m[32m        markerOptions.icon(descriptor);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called after the marker for a Cluster has been added to the map.[m
[32m+[m[32m     */[m
[32m+[m[32m    protected void onClusterRendered(Cluster<T> cluster, Marker marker) {[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Called after the marker for a ClusterItem has been added to the map.[m
[32m+[m[32m     */[m
[32m+[m[32m    protected void onClusterItemRendered(T clusterItem, Marker marker) {[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Get the marker from a ClusterItem[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param clusterItem ClusterItem which you will obtain its marker[m
[32m+[m[32m     * @return a marker from a ClusterItem or null if it does not exists[m
[32m+[m[32m     */[m
[32m+[m[32m    public Marker getMarker(T clusterItem) {[m
[32m+[m[32m        return mMarkerCache.get(clusterItem);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Get the marker from a Cluster[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param cluster which you will obtain its marker[m
[32m+[m[32m     * @return a marker from a cluster or null if it does not exists[m
[32m+[m[32m     */[m
[32m+[m[32m    public Marker getMarker(Cluster<T> cluster) {[m
[32m+[m[32m        return mClusterToMarker.get(cluster);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Get the ClusterItem from a marker[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param marker which you will obtain its ClusterItem[m
[32m+[m[32m     * @return a ClusterItem from a marker or null if it does not exists[m
[32m+[m[32m     */[m
[32m+[m[32m    public T getClusterItem(Marker marker) {[m
[32m+[m[32m        return mMarkerCache.get(marker);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Get the Cluster from a marker[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param marker which you will obtain its Cluster[m
[32m+[m[32m     * @return a Cluster from a marker or null if it does not exists[m
[32m+[m[32m     */[m
[32m+[m[32m    public Cluster<T> getCluster(Marker marker) {[m
[32m+[m[32m        return mMarkerToCluster.get(marker);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Creates markerWithPosition(s) for a particular cluster, animating it if necessary.[m
[32m+[m[32m     */[m
[32m+[m[32m    private class CreateMarkerTask {[m
[32m+[m[32m        private final Cluster<T> cluster;[m
[32m+[m[32m        private final Set<MarkerWithPosition> newMarkers;[m
[32m+[m[32m        private final LatLng animateFrom;[m
[32m+[m
[32m+[m[32m        /**[m
[32m+[m[32m         * @param c            the cluster to render.[m
[32m+[m[32m         * @param markersAdded a collection of markers to append any created markers.[m
[32m+[m[32m         * @param animateFrom  the location to animate the markerWithPosition from, or null if no[m
[32m+[m[32m         *                     animation is required.[m
[32m+[m[32m         */[m
[32m+[m[32m        public CreateMarkerTask(Cluster<T> c, Set<MarkerWithPosition> markersAdded, LatLng animateFrom) {[m
[32m+[m[32m            this.cluster = c;[m
[32m+[m[32m            this.newMarkers = markersAdded;[m
[32m+[m[32m            this.animateFrom = animateFrom;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        private void perform(MarkerModifier markerModifier) {[m
[32m+[m[32m            // Don't show small clusters. Render the markers inside, instead.[m
[32m+[m[32m            if (!shouldRenderAsCluster(cluster)) {[m
[32m+[m[32m                for (T item : cluster.getItems()) {[m
[32m+[m[32m                    Marker marker = mMarkerCache.get(item);[m
[32m+[m[32m                    MarkerWithPosition markerWithPosition;[m
[32m+[m[32m                    if (marker == null) {[m
[32m+[m[32m                        MarkerOptions markerOptions = new MarkerOptions();[m
[32m+[m[32m                        if (animateFrom != null) {[m
[32m+[m[32m                            markerOptions.position(animateFrom);[m
[32m+[m[32m                            markerOptions.icon(item.getBitmapDescriptor());[m
[32m+[m[32m                        } else {[m
[32m+[m[32m                            markerOptions.position(item.getPosition());[m
[32m+[m[32m                            markerOptions.icon(item.getBitmapDescriptor());[m
[32m+[m[32m                        }[m
[32m+[m[32m                        onBeforeClusterItemRendered(item, markerOptions);[m
[32m+[m[32m                        marker = mClusterManager.getMarkerCollection().addMarker(markerOptions);[m
[32m+[m[32m                        markerWithPosition = new MarkerWithPosition(marker);[m
[32m+[m[32m                        mMarkerCache.put(item, marker);[m
[32m+[m[32m                        if (animateFrom != null) {[m
[32m+[m[32m                            markerModifier.animate(markerWithPosition, animateFrom, item.getPosition());[m
[32m+[m[32m                        }[m
[32m+[m[32m                    } else {[m
[32m+[m[32m                        markerWithPosition = new MarkerWithPosition(marker);[m
[32m+[m[32m                    }[m
[32m+[m[32m                    onClusterItemRendered(item, marker);[m
[32m+[m[32m                    newMarkers.add(markerWithPosition);[m
[32m+[m[32m                }[m
[32m+[m[32m                return;[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            MarkerOptions markerOptions = new MarkerOptions()[m
[32m+[m[32m                    .position(animateFrom == null ? cluster.getPosition() : animateFrom);[m
[32m+[m
[32m+[m[32m            onBeforeClusterRendered(cluster, markerOptions);[m
[32m+[m
[32m+[m[32m            Marker marker = mClusterManager.getClusterMarkerCollection().addMarker(markerOptions);[m
[32m+[m[32m            mMarkerToCluster.put(marker, cluster);[m
[32m+[m[32m            mClusterToMarker.put(cluster, marker);[m
[32m+[m[32m            MarkerWithPosition markerWithPosition = new MarkerWithPosition(marker);[m
[32m+[m[32m            if (animateFrom != null) {[m
[32m+[m[32m                markerModifier.animate(markerWithPosition, animateFrom, cluster.getPosition());[m
[32m+[m[32m            }[m
[32m+[m[32m            onClusterRendered(cluster, marker);[m
[32m+[m[32m            newMarkers.add(markerWithPosition);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * A Marker and its position. Marker.getPosition() must be called from the UI thread, so this[m
[32m+[m[32m     * object allows lookup from other threads.[m
[32m+[m[32m     */[m
[32m+[m[32m    private static class MarkerWithPosition {[m
[32m+[m[32m        private final Marker marker;[m
[32m+[m[32m        private LatLng position;[m
[32m+[m
[32m+[m[32m        private MarkerWithPosition(Marker marker) {[m
[32m+[m[32m            this.marker = marker;[m
[32m+[m[32m            position = marker.getPosition();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean equals(Object other) {[m
[32m+[m[32m            if (other instanceof MarkerWithPosition) {[m
[32m+[m[32m                return marker.equals(((MarkerWithPosition) other).marker);[m
[32m+[m[32m            }[m
[32m+[m[32m            return false;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int hashCode() {[m
[32m+[m[32m            return marker.hashCode();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private static final TimeInterpolator ANIMATION_INTERP = new DecelerateInterpolator();[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Animates a markerWithPosition from one position to another. TODO: improve performance for[m
[32m+[m[32m     * slow devices (e.g. Nexus S).[m
[32m+[m[32m     */[m
[32m+[m[32m    @TargetApi(Build.VERSION_CODES.HONEYCOMB_MR1)[m
[32m+[m[32m    private class AnimationTask extends AnimatorListenerAdapter implements ValueAnimator.AnimatorUpdateListener {[m
[32m+[m[32m        private final MarkerWithPosition markerWithPosition;[m
[32m+[m[32m        private final Marker marker;[m
[32m+[m[32m        private final LatLng from;[m
[32m+[m[32m        private final LatLng to;[m
[32m+[m[32m        private boolean mRemoveOnComplete;[m
[32m+[m[32m        private MarkerManager mMarkerManager;[m
[32m+[m
[32m+[m[32m        private AnimationTask(MarkerWithPosition markerWithPosition, LatLng from, LatLng to) {[m
[32m+[m[32m            this.markerWithPosition = markerWithPosition;[m
[32m+[m[32m            this.marker = markerWithPosition.marker;[m
[32m+[m[32m            this.from = from;[m
[32m+[m[32m            this.to = to;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void perform() {[m
[32m+[m[32m            ValueAnimator valueAnimator = ValueAnimator.ofFloat(0, 1);[m
[32m+[m[32m            valueAnimator.setInterpolator(ANIMATION_INTERP);[m
[32m+[m[32m            valueAnimator.addUpdateListener(this);[m
[32m+[m[32m            valueAnimator.addListener(this);[m
[32m+[m[32m            valueAnimator.start();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void onAnimationEnd(Animator animation) {[m
[32m+[m[32m            if (mRemoveOnComplete) {[m
[32m+[m[32m                Cluster<T> cluster = mMarkerToCluster.get(marker);[m
[32m+[m[32m                mClusterToMarker.remove(cluster);[m
[32m+[m[32m                mMarkerCache.remove(marker);[m
[32m+[m[32m                mMarkerToCluster.remove(marker);[m
[32m+[m[32m                mMarkerManager.remove(marker);[m
[32m+[m[32m            }[m
[32m+[m[32m            markerWithPosition.position = to;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void removeOnAnimationComplete(MarkerManager markerManager) {[m
[32m+[m[32m     warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/clustering/view/DefaultClusterRenderer.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/projection/Bounds.java.
The file will have its original line endings in your working directory.
       mMarkerManager = markerManager;[m
[32m+[m[32m            mRemoveOnComplete = true;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void onAnimationUpdate(ValueAnimator valueAnimator) {[m
[32m+[m[32m            float fraction = valueAnimator.getAnimatedFraction();[m
[32m+[m[32m            double lat = (to.latitude - from.latitude) * fraction + from.latitude;[m
[32m+[m[32m            double lngDelta = to.longitude - from.longitude;[m
[32m+[m
[32m+[m[32m            // Take the shortest path across the 180th meridian.[m
[32m+[m[32m            if (Math.abs(lngDelta) > 180) {[m
[32m+[m[32m                lngDelta -= Math.signum(lngDelta) * 360;[m
[32m+[m[32m            }[m
[32m+[m[32m            double lng = lngDelta * fraction + from.longitude;[m
[32m+[m[32m            LatLng position = new LatLng(lat, lng);[m
[32m+[m[32m            marker.setPosition(position);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/projection/Bounds.java b/app/src/main/java/com/baidu/mapapi/clusterutil/projection/Bounds.java[m
[1mnew file mode 100644[m
[1mindex 0000000..3d51d75[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/projection/Bounds.java[m
[36m@@ -0,0 +1,47 @@[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.projection;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Represents an area in the cartesian plane.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class Bounds {[m
[32m+[m[32m    public final double minX;[m
[32m+[m[32m    public final double minY;[m
[32m+[m
[32m+[m[32m    public final double maxX;[m
[32m+[m[32m    public final double maxY;[m
[32m+[m
[32m+[m[32m    public final double midX;[m
[32m+[m[32m    public final double midY;[m
[32m+[m
[32m+[m[32m    public Bounds(double minX, double maxX, double minY, double maxY) {[m
[32m+[m[32m        this.minX = minX;[m
[32m+[m[32m        this.minY = minY;[m
[32m+[m[32m        this.maxX = maxX;[m
[32m+[m[32m        this.maxY = maxY;[m
[32m+[m
[32m+[m[32m        midX = (minX + maxX) / 2;[m
[32m+[m[32m        midY = (minY + maxY) / 2;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public boolean contains(double x, double y) {[m
[32m+[m[32m        return minX <= x && x <= maxX && minY <= y && y <= maxY;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public boolean contains(Point point) {[m
[32m+[m[32m        return contains(point.x, point.y);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public boolean contains(Bounds bounds) {[m
[32m+[m[32m        return bounds.minX >= minX && bounds.maxX <= maxX && bounds.minY >= minY && bounds.maxY <= maxY;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public boolean intersects(double minX, double maxX, double minY, double maxY) {[m
[32m+[m[32m        return minX < this.maxX && this.minX < maxX && minY < this.maxY && this.minY < maxY;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public boolean intersects(Bounds bounds) {[m
[32m+[m[32m        return intersects(bounds.minX, bounds.maxX, bounds.minY, bounds.maxY);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/projection/Point.java b/app/src/main/java/com/baidu/mapapi/clusterutil/projection/Point.java[m
[1mnew file mode 100644[m
[1mindex 0000000..962b56e[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/projection/Point.java[m
[36m@@ -0,0 +1,23 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.projection;[m
[32m+[m
[32m+[m[32mpublic class Point {[m
[32m+[m[32m    public final double x;[m
[32m+[m[32m    public final double y;[m
[32m+[m
[32m+[m[32m    public Poiwarning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/projection/Point.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/projection/SphericalMercatorProjection.java.
The file will have its original line endings in your working directory.
nt(double x, double y) {[m
[32m+[m[32m        this.x = x;[m
[32m+[m[32m        this.y = y;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public String toString() {[m
[32m+[m[32m        return "Point{"[m
[32m+[m[32m                + "x=" + x[m
[32m+[m[32m                +  ", y=" + y[m
[32m+[m[32m                + '}';[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/projection/SphericalMercatorProjection.java b/app/src/main/java/com/baidu/mapapi/clusterutil/projection/SphericalMercatorProjection.java[m
[1mnew file mode 100644[m
[1mindex 0000000..7249c35[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/projection/SphericalMercatorProjection.java[m
[36m@@ -0,0 +1,34 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.projection;[m
[32m+[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m
[32m+[m[32mpublic class SphericalMercatorProjection {[m
[32m+[m[32m    final double mWorldWidth;[m
[32m+[m
[32m+[m[32m    public SphericalMercatorProjection(final double worldWidth) {[m
[32m+[m[32m        mWorldWidth = worldWidth;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @SuppressWarnings("deprecation")[m
[32m+[m[32m    public Point toPoint(final LatLng latLng) {[m
[32m+[m[32m        final double x = latLng.longitude / 360 + .5;[m
[32m+[m[32m        final double siny = Math.sin(Math.toRadians(latLng.latitude));[m
[32m+[m[32m        final double y = 0.5 * Math.log((1 + siny) / (1 - siny)) / -(2 * Math.PI) + .5;[m
[32m+[m
[32m+[m[32m        return new Point(x * mWorldWidth, y * mWorldWidth);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public LatLng toLatLng(com.baidu.mapapi.clusterutil.projection.Point point) {[m
[32m+[m[32m        final double x = point.x / mWorldWidth - 0.5;[m
[32m+[m[32m        final double lng = x * 360;[m
[32m+[m
[32m+[m[32m        double y = .5 - (point.y / mWorldWidth);[m
[32m+[m[32m        final double lat = 90 - Math.toDegrees(Math.atan(Math.exp(-y * 2 * Math.PI)) * 2);[m
[32m+[m
[32m+[m[32m        return new LatLng(lat, lng);[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/quadtree/PointQuadTree.java b/app/src/main/java/com/baidu/mapapi/clusterutil/quadtree/PointQuadTree.java[m
[1mnew file mode 100644[m
[1mindex 0000000..e24dd38[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/quadtree/PointQuadTree.java[m
[36m@@ -0,0 +1,214 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.quadtree;[m
[32m+[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.projection.Bounds;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.projection.Point;[m
[32m+[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.Collection;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * A quad tree which tracks items with a Point geometry.[m
[32m+[m[32m * See http://en.wikipedia.org/wiki/Quadtree for details on the data structure.[m
[32m+[m[32m * This class is not thread safe.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class PointQuadTree<T extends PointQuadTree.Item> {[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * The bounds of this quad.[m
[32m+[m[32m     */[m
[32m+[m[32m    private final Bounds mBounds;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * The depth of this quad in the tree.[m
[32m+[m[32m     */[m
[32m+[m[32m    private final int mDepth;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Maximum number of elements to store in a quad before splitting.[m
[32m+[m[32m     */[m
[32m+[m[32m    private static final int MAX_ELEMENTS = 50;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * The elements inside this quad, if any.[m
[32m+[m[32m     */[m
[32m+[m[32m    private List<T> mItems;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Maximum depth.[m
[32m+[m[32m     */[m
[32m+[m[32m    private static final int MAX_DEPTH = 40;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Child quads.[m
[32m+[m[32m     */[m
[32m+[m[32m    private List<PointQuadTree<T>> mChildren = null;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Creates a new quad tree with specified bounds.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param minX[m
[32m+[m[32m     * @param maxX[m
[32m+[m[32m     * @param minY[m
[32m+[m[32m     * @param maxY[m
[32m+[m[32m     */[m
[32m+[m[32m    public PointQuadTree(double minX, double maxX, double minY, double maxY) {[m
[32m+[m[32m        this(new Bounds(minX, maxX, minY, maxY));[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public PointQuadTree(Bounds bounds) {[m
[32m+[m[32m        this(bounds, 0);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private PointQuadTree(double minX, double maxX, double minY, double maxY, int depth) {[m
[32m+[m[32m        this(new Bounds(minX, maxX, minY, maxY), depth);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private PointQuadTree(Bounds bounds, int depth) {[m
[32m+[m[32m        mBounds = bounds;[m
[32m+[m[32m        mDepth = depth;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Insert an item.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void add(T item) {[m
[32m+[m[32m        Point point = item.getPoint();[m
[32m+[m[32m        if (this.mBounds.contains(point.x, point.y)) {[m
[32m+[m[32m            insert(point.x, point.y, item);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void insert(double x, double y, T item) {[m
[32m+[m[32m        if (this.mChildren != null) {[m
[32m+[m[32m            // 四个区域进行控制[m
[32m+[m[32m            if (y < mBounds.midY) {[m
[32m+[m[32m                if (x < mBounds.midX) { // top left[m
[32m+[m[32m                    mChildren.get(0).insert(x, y, item);[m
[32m+[m[32m                } else { // top right[m
[32m+[m[32m                    mChildren.get(1).insert(x, y, item);[m
[32m+[m[32m                }[m
[32m+[m[32m            } else {[m
[32m+[m[32m                if (x < mBounds.midX) { // bottom left[m
[32m+[m[32m                    mChildren.get(2).insert(x, y, item);[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    mChildren.get(3).insert(x, y, item);[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m            return;[m
[32m+[m[32m        }[m
[32m+[m[32m        if (mItems == null) {[m
[32m+[m[32m            mItems = new ArrayList<T>();[m
[32m+[m[32m        }[m
[32m+[m[32m        mItems.add(item);[m
[32m+[m[32m        if (mItems.size() > MAX_ELEMENTS && mDepth < MAX_DEPTH) {[m
[32m+[m[32m            split();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Split this quad.[m
[32m+[m[32m     */[m
[32m+[m[32m    private void split() {[m
[32m+[m[32m        mChildren = new ArrayList<PointQuadTree<T>>(4);[m
[32m+[m[32m        mChildren.add(new PointQuadTree<T>(mBounds.minX, mBounds.midX, mBounds.minY, mBounds.midY, mDepth + 1));[m
[32m+[m[32m        mChildren.add(new PointQuadTree<T>(mBounds.midX, mBounds.maxX, mBounds.minY, mBounds.midY, mDepth + 1));[m
[32m+[m[32m        mChildren.add(new PointQuadTree<T>(mBounds.minX, mBounds.midX, mBounds.midY, mBounds.maxY, mDepth + 1));[m
[32m+[m[32m        mChildren.add(new PointQuadTree<T>(mBounds.midX, mBounds.maxX, mBounds.midY, mBounds.maxY, mDepth + 1));[m
[32m+[m
[32m+[m[32m        List<T> items = mItems;[m
[32m+[m[3warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/quadtree/PointQuadTree.java.
The file will have its original line endings in your working directory.
2m        mItems = null;[m
[32m+[m
[32m+[m[32m        for (T item : items) {[m
[32m+[m[32m            // re-insert items into child quads.[m
[32m+[m[32m            insert(item.getPoint().x, item.getPoint().y, item);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Remove the given item from the set.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @return whether the item was removed.[m
[32m+[m[32m     */[m
[32m+[m[32m    public boolean remove(T item) {[m
[32m+[m[32m        Point point = item.getPoint();[m
[32m+[m[32m        if (this.mBounds.contains(point.x, point.y)) {[m
[32m+[m[32m            return remove(point.x, point.y, item);[m
[32m+[m[32m        } else {[m
[32m+[m[32m            return false;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private boolean remove(double x, double y, T item) {[m
[32m+[m[32m        if (this.mChildren != null) {[m
[32m+[m[32m            if (y < mBounds.midY) {[m
[32m+[m[32m                if (x < mBounds.midX) { // top left[m
[32m+[m[32m                    return mChildren.get(0).remove(x, y, item);[m
[32m+[m[32m                } else { // top right[m
[32m+[m[32m                    return mChildren.get(1).remove(x, y, item);[m
[32m+[m[32m                }[m
[32m+[m[32m            } else {[m
[32m+[m[32m                if (x < mBounds.midX) { // bottom left[m
[32m+[m[32m                    return mChildren.get(2).remove(x, y, item);[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    return mChildren.get(3).remove(x, y, item);[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        else {[m
[32m+[m[32m            return mItems.remove(item);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Removes all points from the quadTree[m
[32m+[m[32m     */[m
[32m+[m[32m    public void clear() {[m
[32m+[m[32m        mChildren = null;[m
[32m+[m[32m        if (mItems != null) {[m
[32m+[m[32m            mItems.clear();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public interface Item {[m
[32m+[m
[32m+[m[32m        Point getPoint();[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Search for all items within a given bounds.[m
[32m+[m[32m     */[m
[32m+[m[32m    public Collection<T> search(Bounds searchBounds) {[m
[32m+[m[32m        final List<T> results = new ArrayList<T>();[m
[32m+[m[32m        search(searchBounds, results);[m
[32m+[m[32m        return results;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void search(Bounds searchBounds, Collection<T> results) {[m
[32m+[m[32m        if (!mBounds.intersects(searchBounds)) {[m
[32m+[m[32m            return;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        if (this.mChildren != null) {[m
[32m+[m[32m            for (PointQuadTree<T> quad : mChildren) {[m
[32m+[m[32m                quad.search(searchBounds, results);[m
[32m+[m[32m            }[m
[32m+[m[32m        } else if (mItems != null) {[m
[32m+[m[32m            if (searchBounds.contains(mBounds)) {[m
[32m+[m[32m                results.addAll(mItems);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                for (T item : mItems) {[m
[32m+[m[32m                    if (searchBounds.contains(item.getPoint())) {[m
[32m+[m[32m                        results.add(item);[m
[32m+[m[32m                    }[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/ui/IconGenerator.java b/app/src/main/java/com/baidu/mapapi/clusterutil/ui/IconGenerator.java[m
[1mnew file mode 100644[m
[1mindex 0000000..8c1189b[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/ui/IconGenerator.java[m
[36m@@ -0,0 +1,277 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.ui;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.graphics.Bitmap;[m
[32m+[m[32mimport android.graphics.Canvas;[m
[32m+[m[32mimport android.graphics.Color;[m
[32m+[m[32mimport android.graphics.Rect;[m
[32m+[m[32mimport android.graphics.drawable.Drawable;[m
[32m+[m[32mimport android.view.LayoutInflater;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.view.ViewGroup;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * IconGenerator generates icons that contain text (or custom content) within an info[m
[32m+[m[32m * window-like shape.[m
[32m+[m[32m * <p/>[m
[32m+[m[32m * The icon {@link Bitmap}s generated by the factory should be used in conjunction with a {@link[m
[32m+[m[32m * com.baidu.mapapi.map.BitmapDescriptorFactory}.[m
[32m+[m[32m * <p/>[m
[32m+[m[32m * This class is not thread safe.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class IconGenerator {[m
[32m+[m[32m    private final Context mContext;[m
[32m+[m
[32m+[m[32m    private ViewGroup mContainer;[m
[32m+[m[32m    private RotationLayout mRotationLayout;[m
[32m+[m[32m    private TextView mTextView;[m
[32m+[m[32m    private View mContentView;[m
[32m+[m
[32m+[m[32m    private int mRotation;[m
[32m+[m
[32m+[m[32m    private float mAnchorU = 0.5f;[m
[32m+[m[32m    private float mAnchorV = 1f;[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Creates a new IconGenerator with the default style.[m
[32m+[m[32m     */[m
[32m+[m[32m    public IconGenerator(Context context) {[m
[32m+[m[32m        mContext = context;[m
[32m+[m[32m        mContainer = (ViewGroup) LayoutInflater.from(mContext).inflate(R.layout.text_bubble, null);[m
[32m+[m[32m        mRotationLayout = (RotationLayout) mContainer.getChildAt(0);[m
[32m+[m[32m        mContentView = mTextView = (TextView) mRotationLayout.findViewById(R.id.text);[m
[32m+[m[32m        setStyle(STYLE_DEFAULT);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets the text content, then creates an icon with the current style.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param text the text content to display inside the icon.[m
[32m+[m[32m     */[m
[32m+[m[32m    public Bitmap makeIcon(String text) {[m
[32m+[m[32m        if (mTextView != null) {[m
[32m+[m[32m            mTextView.setText(text);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        return makeIcon();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Creates an icon with the current content and style.[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * This method is useful if a custom view has previously been set, or if text content is not[m
[32m+[m[32m     * applicable.[m
[32m+[m[32m     */[m
[32m+[m[32m    public Bitmap makeIcon() {[m
[32m+[m[32m        int measureSpec = View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED);[m
[32m+[m[32m        mContainer.measure(measureSpec, measureSpec);[m
[32m+[m
[32m+[m[32m        int measuredWidth = mContainer.getMeasuredWidth();[m
[32m+[m[32m        int measuredHeight = mContainer.getMeasuredHeight();[m
[32m+[m
[32m+[m[32m        mContainer.layout(0, 0, measuredWidth, measuredHeight);[m
[32m+[m
[32m+[m[32m        if (mRotation == 1 || mRotation == 3) {[m
[32m+[m[32m            measuredHeight = mContainer.getMeasuredWidth();[m
[32m+[m[32m            measuredWidth = mContainer.getMeasuredHeight();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        Bitmap r = Bitmap.createBitmap(measuredWidth, measuredHeight, Bitmap.Config.ARGB_8888);[m
[32m+[m[32m        r.eraseColor(Color.TRANSPARENT);[m
[32m+[m
[32m+[m[32m        Canvas canvas = new Canvas(r);[m
[32m+[m
[32m+[m[32m        if (mRotation != 0) {[m
[32m+[m[32m            // do nothing[m
[32m+[m[32m            if (mRotation == 1) {[m
[32m+[m[32m                canvas.translate(measuredWidth, 0);[m
[32m+[m[32m                canvas.rotate(90);[m
[32m+[m[32m            } else if (mRotation == 2) {[m
[32m+[m[32m                canvas.rotate(180, measuredWidth / 2, measuredHeight / 2);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                canvas.translate(0, measuredHeight);[m
[32m+[m[32m                canvas.rotate(270);[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        mContainer.draw(canvas);[m
[32m+[m[32m        return r;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets the child view for the icon.[m
[32m+[m[32m     * <p/>[m
[32m+[m[32m     * If the view contains a {@link TextView} with the id "text", operations such as {@link[m
[32m+[m[32m     * #setTextAppearance} and {@link #makeIcon(String)} will operate upon that {@link TextView}.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setContentView(View contentView) {[m
[32m+[m[32m        mRotationLayout.removeAllViews();[m
[32m+[m[32m        mRotationLayout.addView(contentView);[m
[32m+[m[32m        mContentView = contentView;[m
[32m+[m[32m        final View view = mRotationLayout.findViewById(R.id.text);[m
[32m+[m[32m        mTextView = view instanceof TextView ? (TextView) view : null;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Rotates the contents of the icon.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param degrees the amount the contents should be rotated, as a multiple of 90 degrees.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setContentRotation(int degrees) {[m
[32m+[m[32m        mRotationLayout.setViewRotation(degrees);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Rotates the icon.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param degrees the amount the icon should be rotated, as a multiple of 90 degrees.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setRotation(int degrees) {[m
[32m+[m[32m        mRotation = ((degrees + 360) % 360) / 90;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * @return u coordinate of the anchor, with rotation applied.[m
[32m+[m[32m     */[m
[32m+[m[32m    public float getAnchorU() {[m
[32m+[m[32m        return rotateAnchor(mAnchorU, mAnchorV);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * @return v coordinate of the anchor, with rotation applied.[m
[32m+[m[32m     */[m
[32m+[m[32m    public float getAnchorV() {[m
[32m+[m[32m        return rotateAnchor(mAnchorV, mAnchorU);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Rotates the anchor around (u, v) = (0, 0).[m
[32m+[m[32m     */[m
[32m+[m[32m    private float rotateAnchor(float u, float v) {[m
[32m+[m[32m        switch (mRotation) {[m
[32m+[m[32m            case 0:[m
[32m+[m[32m                return u;[m
[32m+[m[32m            case 1:[m
[32m+[m[32m                return 1 - v;[m
[32m+[m[32m            case 2:[m
[32m+[m[32m                return 1 - u;[m
[32m+[m[32m            case 3:[m
[32m+[m[32m                return v;[m
[32m+[m[32m            default:[m
[32m+[m[32m        }[m
[32m+[m[32m        throw new IllegalStateException();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets the text color, size, style, hint color, and highlight color from the specified[m
[32m+[m[32m     * <code>TextAppearance</code> resource.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param resid the identifier of the resource.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setTextAppearance(Context context, int resid) {[m
[32m+[m[32m        if (mTextView != null) {[m
[32m+[m[32m            mTextView.setTextAppearance(context, resid);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets the text color, size, style, hint color, and highlight color from the specified[m
[32m+[m[32m     * <code>TextAppearance</code> resource.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param resid the identifier of the resource.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setTextAppearance(int resid) {[m
[32m+[m[32m        setTextAppearance(mContext, resid);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets the style of the icon. The style consists of a background and text appearance.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setStyle(int style) {[m
[32m+[m[32m        setTextAppearance(mContext, getTextStyle(style));[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Set the background to a given Drawable, or remove the background.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param background the Drawable to use as the background, or null to remove the background.[m
[32m+[m[32m     */[m
[32m+[m[32m    @SuppressWarnings("deprecation")[m
[32m+[m[32m    // View#setBackgroundDrawable is compatible with pre-API level 16 (Jelly Bean).[m
[32m+[m[32m    public void setBackground(Drawable background) {[m
[32m+[m[32m        mContainer.setBackgroundDrawable(background);[m
[32m+[m
[32m+[m[32m        // Force setting of padding.[m
[32m+[m[32m        // setBackgroundDrawable does not call setPadding if the background has 0 padding.[m
[32m+[m[32m        if (background != null) {[m
[32m+[m[32m            Rect rect = new Rect();[m
[32m+[m[32m            background.getPadding(rect);[m
[32m+[m[32m            mContainer.setPadding(rect.left, rect.top, rect.right, rect.bottom);[m
[32m+[m[32m        } else {[m
[32m+[m[32m            mContainer.setPadding(0, 0, 0, 0);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * Sets the padding of the content view. The default padding of the content view (i.e. text[m
[32m+[m[32m     * view) is 5dp top/bottom and 10dp left/right.[m
[32m+[m[32m     *[m
[32m+[m[32m     * @param left   the left padding in pixels.[m
[32m+[m[32m     * @param top    the top padding in pixels.[m
[32m+[m[32m     * @param right  the right padding in pixels.[m
[32m+[m[32m     * @param bottom the bottom padding in pixels.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setContentPadding(int left, int top, int right, int bottom) {[m
[32m+[m[32m        mContentView.setPadding(left, top, right, bottom);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public static final int STYLE_DEFAULT = 1;[m
[32m+[m[32m    public static final int STYLE_WHITE = 2;[m
[32m+[m[32m    public static final int STYLE_RED = 3;[m
[32m+[m[32m    public static final int STYLE_BLUE = 4;[m
[32m+[m[32m    public static final int STYLE_GREEN = 5;[m
[32m+[m[32m    public static final int STYLE_PURPLE = 6;[m
[32m+[m[32m    public static final int STYLE_ORANGE = 7;[m
[32m+[m
[32m+[m[32m    private static int getStyleColor(int style) {[m
[32m+[m[32m        switch (style) {[m
[32m+[m[32m            default:[m
[32m+[m[32m            case STYLE_DEFAULT:[m
[32m+[m[32m            case STYLE_WHITE:[m
[32m+[m[32m                return 0xffffffff;[m
[32m+[m[32m            case STYLE_RED:[m
[32m+[m[32m                return 0xffcc0000;[m
[32m+[m[32m            case STYLE_BLUE:[m
[32m+[m[32m                return 0xff0099cc;[m
[32m+[m[32m            case STYLE_GREEN:[m
[32m+[m[32m                return 0xff669900;[m
[32m+[m[32m            case STYLE_PURPLE:[m
[32m+[m[32m  warning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/ui/IconGenerator.java.
The file will have its original line endings in your working directory.
              return 0xff9933cc;[m
[32m+[m[32m            case STYLE_ORANGE:[m
[32m+[m[32m                return 0xffff8800;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private static int getTextStyle(int style) {[m
[32m+[m[32m        switch (style) {[m
[32m+[m[32m            default:[m
[32m+[m[32m            case STYLE_DEFAULT:[m
[32m+[m[32m            case STYLE_WHITE:[m
[32m+[m[32m                return R.style.Bubble_TextAppearance_Dark;[m
[32m+[m[32m            case STYLE_RED:[m
[32m+[m[32m            case STYLE_BLUE:[m
[32m+[m[32m            case STYLE_GREEN:[m
[32m+[m[32m            case STYLE_PURPLE:[m
[32m+[m[32m            case STYLE_ORANGE:[m
[32m+[m[32m                return R.style.Bubble_TextAppearance_Light;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/ui/RotationLayout.java b/app/src/main/java/com/baidu/mapapi/clusterutil/ui/RotationLayout.java[m
[1mnew file mode 100644[m
[1mindex 0000000..e4d99ac[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/ui/RotationLayout.java[m
[36m@@ -0,0 +1,71 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.ui;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.graphics.Canvas;[m
[32m+[m[32mimport android.util.AttributeSet;[m
[32m+[m[32mimport android.widget.FrameLayout;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * RotationLayout rotates the contents of the layout by multiples of 90 degrees.[m
[32m+[m[32m * <p/>[m
[32m+[m[32m * May not work with padding.[m
[32m+[m[32m */[m
[32m+[m[32mclass RotationLayout extends FrameLayout {[m
[32m+[m[32m    private int mRotation;[m
[32m+[m
[32m+[m[32m    public RotationLayout(Context context) {[m
[32m+[m[32m        super(context);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public RotationLayout(Context context, AttributeSet attrs) {[m
[32m+[m[32m        super(context, attrs);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public RotationLayout(Context context, AttributeSet attrs, int defStyle) {[m
[32m+[m[32m        super(context, attrs, defStyle);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {[m
[32m+[m[32m        if (mRotation == 1 || mRotation == 3) {[m
[32m+[m[32m            super.onMeasure(widthMeasureSpec, heightMeasureSpec);[m
[32m+[m[32m            setMeasuredDimension(getMeasuredHeight(), getMeasuredWidth());[m
[32m+[m[32m        } else {[m
[32m+[m[32m            super.onMeasure(widthMeasureSpec, heightMeasureSpec);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * @param degrees the rotation, in degrees.[m
[32m+[m[32m     */[m
[32m+[m[32m    public void setViewRotation(int degrees) {[m
[32m+[m[32m        mRotation = ((degrees + 360) % 360) / 90;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void dispatchDraw(Canvas canvas) {[m
[32m+[m[32m        if (mRotation == 0) {[m
[32m+[m[32m            super.dispatchDraw(canvas);[m
[32m+[m[32m            return;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        if (mRotation == 1) {[m
[32m+[m[32m            canvas.translate(getWidth(), 0);[m
[32m+[m[32m            canvas.rotate(90, getWidth() / 2, 0);[m
[32m+[m[32m            canvas.translate(getHeight() / 2, getWidth() / 2);[m
[32m+[m[32m        } else if (mRotation == 2) {[m
[32m+[m[32m            canvas.rotate(180, getWidth() / 2, getHeight() / 2);[m
[32m+[m[32m        } else {[m
[32m+[m[32m            canvas.translate(0, getHeight());[m
[32m+[m[32m            canvas.rotate(270, getwarning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/ui/RotationLayout.java.
The file will have its original line endings in your working directory.
Width() / 2, 0);[m
[32m+[m[32m            canvas.translate(getHeight() / 2, -getWidth() / 2);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        super.dispatchDraw(canvas);[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/baidu/mapapi/clusterutil/ui/SquareTextView.java b/app/src/main/java/com/baidu/mapapi/clusterutil/ui/SquareTextView.java[m
[1mnew file mode 100644[m
[1mindex 0000000..7f6a41d[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/baidu/mapapi/clusterutil/ui/SquareTextView.java[m
[36m@@ -0,0 +1,49 @@[m
[32m+[m[32m/*[m
[32m+[m[32m * Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mpackage com.baidu.mapapi.clusterutil.ui;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.graphics.Canvas;[m
[32m+[m[32mimport android.util.AttributeSet;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m
[32m+[m[32mpublic class SquareTextView extends TextView {[m
[32m+[m[32m    private int mOffsetTop = 0;[m
[32m+[m[32m    private int mOffsetLeft = 0;[m
[32m+[m
[32m+[m[32m    public SquareTextView(Context context) {[m
[32m+[m[32m        super(context);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public SquareTextView(Context context, AttributeSet attrs) {[m
[32m+[m[32m        super(context, attrs);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public SquareTextView(Context context, AttributeSet attrs, int defStyle) {[m
[32m+[m[32m        super(context, attrs, defStyle);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {[m
[32m+[m[32m        super.onMeasure(widthMeasureSpec, heightMeasureSpec);[m
[32m+[m[32m        int width = getMeasuredWidth();[m
[32m+[m[32m        int height = getMeasuredHeight();[m
[32m+[m[32m        int dimension = Math.max(width, height);[m
[32m+[m[32m        if (width > height) {[m
[32m+[m[32m            mOffsetTop = width - height;[m
[32m+[m[32m            mOffsetLeft = 0;[m
[32m+[m[32m        } else {[m
[32m+[m[32m            mOffsetTop = 0;[m
[32m+[m[32m            mOffsetLeft = height - width;[m
[32m+[m[32m        }[m
[32m+[m[32m        setMeasuredDimension(dimension, dimension);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void draw(Canvas canvas) {[m
[32m+[m[32m        canvas.translate(mOffsetLeft / 2, mOffsetTop / 2);[m
[32m+[m[32m        super.draw(canvas);[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Activity/AddFileActivity.java b/app/src/main/java/com/fanweilin/coordinatemap/Activity/AddFileActivity.java[m
[1mnew file mode 100644[m
[1mindex 0000000..3f403f3[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Activity/AddFileActivity.java[m
[36m@@ -0,0 +1,233 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Activity;[m
[32m+[m
[32m+[m[32mimport android.app.ListActivity;[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.content.DialogInterface;[m
[32m+[m[32mimport android.content.Intent;[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.os.Environment;[m
[32m+[m[32mimport android.support.v7.app.AlertDialog;[m
[32m+[m[32mimport android.view.LayoutInflater;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.view.ViewGroup;[m
[32m+[m[32mimport android.widget.BaseAdapter;[m
[32m+[m[32mimport android.widget.Button;[m
[32m+[m
[32m+[m[32mimport android.widget.ImageView;[m
[32m+[m[32mimport android.widget.ListView;[m
[32m+[m[32mimport android.widget.RadioGroup;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.coordinatemap.Class.LatStyle;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m
[32m+[m[32mimport java.io.File;[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.HashMap;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m
[32m+[m[32mpublic class AddFileActivity extends ListActivity implements View.OnClickListener {[m
[32m+[m[32m    private final String mDir = Environment.getExternalStorageDirectory().getPath();[m
[32m+[m[32m    private List<Map<String, Object>> mData;[m
[32m+[m[32m    private String path;[m
[32m+[m[32m    private Button btn;[m
[32m+[m[32m    private int CoordStyle = LatStyle.GPSSYTELE;[m
[32m+[m[32m    private int DataStye = LatStyle.DEGREE;[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        setContentView(R.layout.activity_add_file);[m
[32m+[m[32m        btn = (Button) findViewById(R.id.btn_help);[m
[32m+[m[32m        path = mDir;[m
[32m+[m[32m        mData = getData();[m
[32m+[m[32m        Myadpter adapter = new Myadpter(this);[m
[32m+[m[32m        setListAdapter(adapter);[m
[32m+[m[32m        btn.setOnClickListener(this);[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public List<Map<String, Object>> getData() {[m
[32m+[m[32m        List<Map<String, Object>> list = new ArrayList<Map<String, Object>>();[m
[32m+[m[32m        Map<String, Object> map = null;[m
[32m+[m[32m        File f = new File(path);[m
[32m+[m[32m        File[] files = f.listFiles();[m
[32m+[m[32m        if (!path.equals("mDir")) {[m
[32m+[m[32m            map = new HashMap<String, Object>();[m
[32m+[m[32m            map.put("title", "返回上一级");[m
[32m+[m[32m            map.put("img", R.mipmap.ex_folder);[m
[32m+[m[32m            map.put("path", f.getParent());[m
[32m+[m[32m            list.add(map);[m
[32m+[m[32m        }[m
[32m+[m[32m        if (files != null) {[m
[32m+[m[32m            for (int i = 0; i < files.length; i++) {[m
[32m+[m[32m                map = new HashMap<String, Object>();[m
[32m+[m[32m                map.put("title", files[i].getName());[m
[32m+[m[32m                map.put("path", files[i].getAbsolutePath());[m
[32m+[m[32m                if (files[i].isDirectory()) {[m
[32m+[m[32m                    map.put("img", R.mipmap.ex_folder);[m
[32m+[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    map.put("img", R.mipmap.ex_doc);[m
[32m+[m[32m                }[m
[32m+[m[32m                list.add(map);[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        return list;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onListItemClick(ListView l, View v, int position, long id) {[m
[32m+[m[32m        super.onListItemClick(l, v, position, id);[m
[32m+[m[32m        path = (String) mData.get(position).get("path");[m
[32m+[m[32m        String title = (String) mData.get(position).get("title");[m
[32m+[m[32m        if (position == 0) {[m
[32m+[m[32m            File file = new File(path);[m
[32m+[m[32m            if (file.getParent() == null) {[m
[32m+[m[32m                finish();[m
[32m+[m[32m            } else if ((Integer) mData.get(position).get("img") == R.mipmap.ex_folder) {[m
[32m+[m[32m                mData = getData();[m
[32m+[m[32m                Myadpter adapter = new Myadpter(this);[m
[32m+[m[32m                setListAdapter(adapter);[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        if ((Integer) mData.get(position).get("img") == R.mipmap.ex_folder) {[m
[32m+[m[32m            mData = getData();[m
[32m+[m[32m            Myadpter adapter = new Myadpter(this);[m
[32m+[m[32m            setListAdapter(adapter);[m
[32m+[m[32m        } else if (title.endsWith(".txt")) {[m
[32m+[m[32m            setdatastyel(path,title);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onClick(View view) {[m
[32m+[m[32m        AlertDialog.Builder builder = new AlertDialog.Builder(AddFileActivity.this);[m
[32m+[m[32m        builder.setTitle("帮助");[m
[32m+[m[32m        builder.setMessage("导入文本格式为:.txt\n文本数据格式为:名称,纬度,经度\n坐标系支持WGS84坐标系（GPS设备采集的原始GPS坐标）," +[m
[32m+[m[32m                "百度地图坐标系,其他坐标系包括（google地图、soso地图、aliyun地图、mapabc地图和amap地图所用坐标)\n本软件支持小数、" +[m
[32m+[m[32m                "度分秒两种格式（注：当导入度分秒格式时请转换成如下形式如30.452734,表示为30度45分27.34秒");[m
[32m+[m[32m        builder.setPositiveButton("确定", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialogInterface, int i) {[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        builder.show();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class ViewHolder {[m
[32m+[m[32m        ImageView img;[m
[32m+[m[32m        TextView titleview;[m
[32m+[m[32m        TextView pathview;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class Myadpter extends BaseAdapter {[m
[32m+[m[32m        LayoutInflater inflater;[m
[32m+[m
[32m+[m[32m        public Myadpter(Context context) {[m
[32m+[m[32m            inflater = LayoutInflater.from(context);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getCount() {[m
[32m+[m[32m            return mData.size();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Object getItem(int i) {[m
[32m+[m[32m            return mData.get(i);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public long getItemId(int i) {[m
[32m+[m[32m            return i;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public View getView(int i, View view, ViewGroup viewGroup) {[m
[32m+[m[32m            ViewHolder holder = null;[m
[32m+[m[32m            if (view == null) {[m
[32m+[m[32m                holder = new ViewHolder();[m
[32m+[m[32m                view = inflater.inflate(R.layout.list_file, null);[m
[32m+[m[32m                holder.img = (ImageView) view.findViewById(R.id.img);[m
[32m+[m[32m                holder.titleview = (TextView) view.findViewById(R.id.title);[m
[32m+[m[32m                holder.pathview = (TextView) view.findViewById(R.id.path);[m
[32m+[m[32m                view.setTag(holder);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                holder = (ViewHolder) view.getTag();[m
[32m+[m[32m            }[m
[32m+[m[32m            holder.img.setBackgroundResource((Integer) mData.get(i).get("img"));[m
[32m+[m[32m            holder.titleview.setText((String) mData.get(i).get("title"));[m
[32m+[m[32m            holder.pathview.setText((String) mData.get(i).get("path"));[m
[32m+[m[32m            return view;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void finishWithResult(String path, String title, int coordstyle, int datastyle) {[m
[32m+[m[32m        Bundle conDate = new Bundle();[m
[32m+[m[32m        conDate.putString("path", path);[m
[32m+[m[32m        conDate.putString("title", title);[m
[32m+[m[32m        conDate.putInt("CoordStyle", coordstyle);[m
[32m+[m[32m        conDate.putInt("DataStyle", datastyle);[m
[32m+[m[32m        Intent intent = new Intent();[m
[32m+[m[32m        intent.putExtras(conDate);[m
[32m+[m[32m        setResult(RESULT_OK, intent);[m
[32m+[m[32m        finish();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setdatastyel(final String path, final String title) {[m
[32m+[m[32m        final RadioGroup rgcoord;[m
[32m+[m[32m        final RadioGroup rgdata;[m
[32m+[m[32m        View view = getLayoutInflater().inflate(R.layout.dialog_file_setting, null);[m
[32m+[m[32m        AlertDialog.Builder builder = new AlertDialog.Builder(AddFileActivity.this);[m
[32m+[m[32m        builder.setView(view);[m
[32m+[m[32m        builder.setTitle("数据格式设置");[m
[32m+[m[32m        rgcoord = (RadioGroup) view.findViewById(R.id.rg_codstyle);[m
[32m+[m[32m        rgdata = (RadioGroup) view.findViewById(R.id.rg_datastyle);[m
[32m+[m
[32m+[m
[32m+[m[32m        builder.setPositiveButton("确定", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialog, int which) {[m
[32m+[m[32m                switch (rgcoord.getCheckedRadioButtonId()) {[m
[32m+[m[32m                    case R.id.rb_wgs84:[m
[32m+[m[32m                        CoordStyle = LatStyle.GPSSYTELE;[m
[32m+[m[32m                        break;[m
[32m+[m[32m                    case R.id.rb_bd:[m
[32m+[m[32m                        CoordStyle = LatStyle.BAIDUMAPSTYELE;[m
[32m+[m[32m                        break;[m
[32m+[m[32m                    case R.id.rb_other:[m
[32m+[m[32m                        CoordStyle = LatStyle.OTHERS;[m
[32m+[m[32m                        break;[m
[32m+[m[32m                }[m
[32m+[m[32m                switch (rgdata.getCheckedRadioButtonId()) {[m
[32m+[m[32m                    case R.id.rb_decimal:[m
[32m+[m[32m                        DataStye = LatStyle.DEGREE;[m
[32m+[m[32m                        break;[m
[32m+[m[32m                    case R.id.rb_dms:[m
[32m+[m[32m                        DataStye = LatStyle.DMS;[m
[32m+[m[32m                        break;[m
[32m+[m[32m                }[m
[32m+[m[32m                finishWithResult(path, title, CoordStyle, DataStye);[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        builder.setNegativeButton("取消", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialogInterface, int i) {[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        builder.show();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void back(View view) {[m
[32m+[m[32m        finish();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Activity/Bdoffilin_activity.java b/app/src/main/java/com/fanweilin/coordinatemap/Activity/Bdoffilin_activity.java[m
[1mnew file mode 100644[m
[1mindex 0000000..c5c4480[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Activity/Bdoffilin_activity.java[m
[36m@@ -0,0 +1,241 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Activity;[m
[32m+[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.support.v4.app.Fragment;[m
[32m+[m[32mimport android.support.v4.app.FragmentActivity;[m
[32m+[m[32mimport android.support.v4.app.FragmentManager;[m
[32m+[m[32mimport android.support.v4.app.FragmentPagerAdapter;[m
[32m+[m[32mimport android.support.v4.view.ViewPager;[m
[32m+[m[32mimport android.util.Log;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.widget.RadioButton;[m
[32m+[m[32mimport android.widget.RadioGroup;[m
[32m+[m[32mimport android.widget.Toast;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.map.offline.MKOLSearchRecord;[m
[32m+[m[32mimport com.baidu.mapapi.map.offline.MKOLUpdateElement;[m
[32m+[m[32mimport com.baidu.mapapi.map.offline.MKOfflineMap;[m
[32m+[m[32mimport com.baidu.mapapi.map.offline.MKOfflineMapListener;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.fragment.CityList_Fragment;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.fragment.DownFragment;[m
[32m+[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.HashMap;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m
[32m+[m[32mimport info.hoang8f.android.segmented.SegmentedGroup;[m
[32m+[m
[32m+[m[32mpublic class Bdoffilin_activity extends FragmentActivity implements MKOfflineMapListener, CityList_Fragment.OnHeadlineSelectedListener {[m
[32m+[m[32m    private List<String> City = null;[m
[32m+[m[32m    private Map<String, List<String>> AllCity = null;[m
[32m+[m[32m    private List<String> Hotcity = null;[m
[32m+[m[32m    private List<Fragment> fragments;[m
[32m+[m[32m    private CityList_Fragment cityfragment;[m
[32m+[m[32m    private DownFragment downfragment;[m
[32m+[m[32m    private ViewPager mViewPager;[m
[32m+[m[32m    private RadioButton rbCity;[m
[32m+[m[32m    private RadioButton rbDown;[m
[32m+[m[32m     public MKOfflineMap mOffline;[m
[32m+[m[32m    private info.hoang8f.android.segmented.SegmentedGroup segmentgroup;[m
[32m+[m[32m    public ArrayList<MKOLUpdateElement> localMapList = null;[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        setContentView(R.layout.activity_bdoffline);[m
[32m+[m[32m        mOffline=new MKOfflineMap();[m
[32m+[m[32m        mOffline.init(this);[m
[32m+[m[32m        initView();[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onDestroy() {[m
[32m+[m[32m        mOffline.destroy();[m
[32m+[m[32m        super.onDestroy();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void initView() {[m
[32m+[m[32m        City = new ArrayList<String>();[m
[32m+[m[32m        Hotcity = new ArrayList<String>();[m
[32m+[m[32m        AllCity = new HashMap<String, List<String>>();[m
[32m+[m[32m        segmentgroup = (SegmentedGroup) findViewById(R.id.segmented2);[m
[32m+[m[32m        rbCity = (RadioButton) findViewById(R.id.rb_city);[m
[32m+[m[32m        rbDown = (RadioButton) findViewById(R.id.rb_down);[m
[32m+[m[32m        mViewPager = (ViewPager) findViewById(R.id.viewpager);[m
[32m+[m[32m        GetFragList();[m
[32m+[m[32m        FragmentAdapter Fadpter = new FragmentAdapter(getSupportFragmentManager());[m
[32m+[m[32m        mViewPager.setAdapter(Fadpter);[m
[32m+[m[32m        mViewPager.setCurrentItem(0);[m
[32m+[m[32m        segmentgroup.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onCheckedChanged(RadioGroup group, int checkedId) {[m
[32m+[m[32m                if (rbDown.isChecked()) {[m
[32m+[m[32m                    mViewPager.setCurrentItem(1);[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    mViewPager.setCurrentItem(0);[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        mViewPager.setOnPageChangeListener(new ViewPager.OnPageChangeListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onPageSelected(int position) {[m
[32m+[m[32m                switch (position) {[m
[32m+[m[32m                    case 0:[m
[32m+[m[32m                        rbCity.setChecked(true);[m
[32m+[m[32m                        break;[m
[32m+[m[32m                    case 1:[m
[32m+[m[32m                        rbDown.setChecked(true);[m
[32m+[m[32m                        break;[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onPageScrollStateChanged(int state) {[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        localMapList = mOffline.getAllUpdateInfo();[m
[32m+[m[32m        if (localMapList == null) {[m
[32m+[m[32m            localMapList = new ArrayList<MKOLUpdateElement>();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void GetFragList() {[m
[32m+[m[32m        fragments = new ArrayList<Fragment>();[m
[32m+[m[32m        GetData();[m
[32m+[m[32m        cityfragment = new CityList_Fragment().newInstance(City, AllCity, Hotcity);[m
[32m+[m[32m        fragments.add(cityfragment);[m
[32m+[m[32m        downfragment = new DownFragment();[m
[32m+[m[32m        fragments.add(downfragment);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void GetData() {[m
[32m+[m[32m        ArrayList<MKOLSearchRecord> records2 = mOffline.getOfflineCityList();[m
[32m+[m[32m        if (records2 != null) {[m
[32m+[m[32m            for (MKOLSearchRecord r : records2) {[m
[32m+[m[32m                Log.d("CITY", r.cityName);[m
[32m+[m[32m                String city = r.cityName + "," + r.cityID + ","[m
[32m+[m[32m                        + this.formatDataSize(r.size);[m
[32m+[m[32m                List<String> chlildcitylist = new ArrayList<String>();[m
[32m+[m[32m                if (r.childCities != null) {[m
[32m+[m[32m                    City.add(city);[m
[32m+[m[32m                    Log.d("CITY", r.cityName);[m
[32m+[m[32m                    ArrayList<MKOLSearchRecord> childrecord = r.childCities;[m
[32m+[m[32m                    for (MKOLSearchRecord child : childrecord) {[m
[32m+[m[32m                        chlildcitylist.add(child.cityName + "," + child.cityID + "," + this.formatDataSize(child.size));[m
[32m+[m[32m                    }[m
[32m+[m[32m                    AllCity.put(city, chlildcitylist);[m
[32m+[m[32m                } else {[m
[32m+[m[32m                      Log.d("hotcity",city);[m
[32m+[m[32m                    Hotcity.add(city);[m
[32m+[m[32m                }[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onArticleSelected(String cityid) {[m
[32m+[m
[32m+[m[32m          mOffline.start(Integer.parseInt(cityid));[m
[32m+[m[32m          Toast.makeText(this, "开始下载离线地图. cityid: " + cityid, Toast.LENGTH_SHORT)[m
[32m+[m[32m                .show();[m
[32m+[m[32m        mViewPager.setCurrentItem(1);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public class FragmentAdapter extends FragmentPagerAdapter {[m
[32m+[m[32m        public FragmentAdapter(FragmentManager fm) {[m
[32m+[m[32m            super(fm);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Fragment getItem(int position) {[m
[32m+[m[32m            return fragments.get(position);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getCount() {[m
[32m+[m[32m            return fragments.size();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public String formatDataSize(int size) {[m
[32m+[m[32m        String ret = "";[m
[32m+[m[32m        if (size < (1024 * 1024)) {[m
[32m+[m[32m            ret = String.format("%dK", size / 1024);[m
[32m+[m[32m        } else {[m
[32m+[m[32m            ret = String.format("%.1fM", size / (1024 * 1024.0));[m
[32m+[m[32m        }[m
[32m+[m[32m        return ret;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    class City {[m
[32m+[m[32m        City(String string) {[m
[32m+[m[32m            city = string.split(",");[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        String[] city;[m
[32m+[m
[32m+[m[32m        public int getCityid() {[m
[32m+[m[32m            return Integer.getInteger(city[1]);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public String getCityname() {[m
[32m+[m[32m            return city[0];[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public String getCitysize() {[m
[32m+[m[32m            return city[2];[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Map<String, Object> getcity(String string) {[m
[32m+[m[32m        String[] city;[m
[32m+[m[32m        Map<String, Object> map = new HashMap<String, Object>();[m
[32m+[m[32m        city = string.split(",");[m
[32m+[m[32m        map.put("cityname", city[0]);[m
[32m+[m[32m        map.put("cityid", city[1]);[m
[32m+[m[32m        map.put("citysize", city[2]);[m
[32m+[m[32m        return map;[m
[32m+[m[32m    }[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onGetOfflineMapState(int type, int state) {[m
[32m+[m[32m        switch (type) {[m
[32m+[m[32m            case MKOfflineMap.TYPE_DOWNLOAD_UPDATE: {[m
[32m+[m[32m                MKOLUpdateElement update = mOffline.getUpdateInfo(state);[m
[32m+[m[32m                // 处理下载进度更新提示[m
[32m+[m[32m                if (update != null) {[m
[32m+[m
[32m+[m[32m                   downfragment. updateView();[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m            break;[m
[32m+[m[32m            case MKOfflineMap.TYPE_NEW_OFFLINE:[m
[32m+[m[32m                // 有新离线地图安装[m
[32m+[m[32m                break;[m
[32m+[m[32m            case MKOfflineMap.TYPE_VER_UPDATE:[m
[32m+[m[32m                // 版本更新提示[m
[32m+[m[32m                // MKOLUpdateElement e = mOffline.getUpdateInfo(state);[m
[32m+[m
[32m+[m[32m                break;[m
[32m+[m[32m            default:[m
[32m+[m[32m                break;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m[32m    public void back(View view) {[m
[32m+[m[32m        finish();[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Activity/ConvertActivity.java b/app/src/main/java/com/fanweilin/coordinatemap/Activity/ConvertActivity.java[m
[1mnew file mode 100644[m
[1mindex 0000000..320f6c1[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Activity/ConvertActivity.java[m
[36m@@ -0,0 +1,83 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Activity;[m
[32m+[m
[32m+[m[32mimport android.support.v7.app.AppCompatActivity;[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.widget.Button;[m
[32m+[m[32mimport android.widget.EditText;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.computing.ConvertLatlng;[m
[32m+[m
[32m+[m[32mpublic class ConvertActivity extends AppCompatActivity implements View.OnClickListener {[m
[32m+[m[32m    private Button btnDic;[m
[32m+[m[32m    private Button btnDms;[m
[32m+[m[32m    private TextView tvDic;[m
[32m+[m[32m    private TextView tvDms;[m
[32m+[m[32m    private EditText etDic;[m
[32m+[m[32m    private EditText etdu;[m
[32m+[m[32m    private EditText etfen;[m
[32m+[m[32m    private EditText etmiao;[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        setContentView(R.layout.activity_convert);[m
[32m+[m[32m        init();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void init()[m
[32m+[m
[32m+[m[32m    {[m
[32m+[m[32m        btnDic = (Button) findViewById(R.id.btn_dci);[m
[32m+[m[32m        btnDms = (Button) findViewById(R.id.btn_dms);[m
[32m+[m[32m        tvDic = (TextView) findViewById(R.id.tv_dic);[m
[32m+[m[32m        tvDms = (TextView) findViewById(R.id.tv_dms);[m
[32m+[m[32m        etDic = (EditText) findViewById(R.id.et_dic);[m
[32m+[m[32m        etdu = (EditText) findViewById(R.id.et_du);[m
[32m+[m[32m        etmiao = (EditText) findViewById(R.id.et_miao);[m
[32m+[m[32m        etfen = (EditText) findViewById(R.id.et_fen);[m
[32m+[m[32m        btnDms.setOnClickListener(this);[m
[32m+[m[32m        btnDic.setOnClickListener(this);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void back(View view) {[m
[32m+[m[32m        finish();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onClick(View v) {[m
[32m+[m[32m        ConvertLatlng convertLatlng = new ConvertLatlng();[m
[32m+[m[32m        switch (v.getId()) {[m
[32m+[m[32m            case R.id.btn_dci:[m
[32m+[m[32m                if (!etDic.getText().toString().equals("")) {[m
[32m+[m[32m                    double dic = Double.parseDouble(etDic.getText().toString());[m
[32m+[m[32m                    tvDic.setText(convertLatlng.convertToSexagesimal(dic));[m
[32m+[m[32m                }[m
[32m+[m[32m                break;[m
[32m+[m[32m            case R.id.btn_dms:[m
[32m+[m[32m                double du;[m
[32m+[m[32m                double fen;[m
[32m+[m[32m                double miao;[m
[32m+[m[32m                if (!etdu.getText().toString().equals("")) {[m
[32m+[m[32m                    du = Double.parseDouble(etdu.getText().toString());[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    du = 0;[m
[32m+[m[32m                }[m
[32m+[m[32m                if (!etfen.getText().toString().equals("")) {[m
[32m+[m[32m                    fen = Double.parseDouble(etfen.getText().toString());[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    fen = 0;[m
[32m+[m[32m                }[m
[32m+[m[32m                if (!etmiao.getText().toString().equals("")) {[m
[32m+[m[32m                    miao = Double.parseDouble(etmiao.getText().toString());[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    miao = 0;[m
[32m+[m[32m                }[m
[32m+[m[32m                tvDms.setText(String.valueOf(convertLatlng.convertToDecimal(du, fen, miao)));[m
[32m+[m[32m                break;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Activity/DataManagerActivity.java b/app/src/main/java/com/fanweilin/coordinatemap/Activity/DataManagerActivity.java[m
[1mnew file mode 100644[m
[1mindex 0000000..c369ec6[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Activity/DataManagerActivity.java[m
[36m@@ -0,0 +1,379 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Activity;[m
[32m+[m
[32m+[m[32mimport android.app.Activity;[m
[32m+[m[32mimport android.content.ComponentName;[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.content.Intent;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.support.v7.widget.AppCompatButton;[m
[32m+[m[32mimport android.text.TextUtils;[m
[32m+[m[32mimport android.util.Log;[m
[32m+[m[32mimport android.util.SparseBooleanArray;[m
[32m+[m[32mimport android.view.LayoutInflater;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.view.ViewGroup;[m
[32m+[m[32mimport android.view.WindowManager;[m
[32m+[m[32mimport android.widget.AdapterView;[m
[32m+[m[32mimport android.widget.BaseAdapter;[m
[32m+[m[32mimport android.widget.CheckBox;[m
[32m+[m[32mimport android.widget.Filter;[m
[32m+[m[32mimport android.widget.Filterable;[m
[32m+[m[32mimport android.widget.LinearLayout;[m
[32m+[m[32mimport android.widget.ListView;[m
[32m+[m[32mimport android.widget.RelativeLayout;[m
[32m+[m[32mimport android.widget.SearchView;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.coordinatemap.Class.LatStyle;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.computing.ConvertLatlng;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.widget.CheckableRelativeLayout;[m
[32m+[m[32mimport com.fanweilin.greendao.DaoSession;[m
[32m+[m[32mimport com.fanweilin.greendao.ShowData;[m
[32m+[m[32mimport com.fanweilin.greendao.ShowDataDao;[m
[32m+[m
[32m+[m[32mimport java.io.BufferedReader;[m
[32m+[m[32mimport java.io.FileNotFoundException;[m
[32m+[m[32mimport java.io.FileReader;[m
[32m+[m[32mimport java.io.IOException;[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.HashMap;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m
[32m+[m[32mpublic class DataManagerActivity extends Activity implements View.OnClickListener, SearchView.OnQueryTextListener {[m
[32m+[m[32m    private ListView mListView;[m
[32m+[m[32m    private TextView mTextView;[m
[32m+[m[32m    private String title;[m
[32m+[m[32m    private DataAdpter mDataAdpter;[m
[32m+[m[32m    private ConvertLatlng convertLatlng;[m
[32m+[m[32m    private boolean show = false;[m
[32m+[m[32m    private List<Map<String, Object>> mData;[m
[32m+[m[32m    private List<Map<String, Object>> mBackData;[m
[32m+[m[32m    private LinearLayout layoutShow;[m
[32m+[m[32m    private CheckableRelativeLayout selectALL;[m
[32m+[m[32m    private boolean isSelectALL;[m
[32m+[m[32m    private android.support.v7.widget.AppCompatButton btnShow;[m
[32m+[m[32m    private android.support.v7.widget.AppCompatButton btnCancle;[m
[32m+[m[32m    private RelativeLayout rlTopbar;[m
[32m+[m[32m    private RelativeLayout rlSearch;[m
[32m+[m[32m    private SearchView searchView;[m
[32m+[m[32m    private boolean searchShow = false;[m
[32m+[m[32m    private int CoordStyle;[m
[32m+[m[32m    private int DataStyle;[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        setContentView(R.layout.avtivity_data_manager);[m
[32m+[m[32m        init();[m
[32m+[m[32m        getData();[m
[32m+[m[32m        mTextView.setText(title);[m
[32m+[m[32m        mDataAdpter = new DataAdpter(this);[m
[32m+[m[32m        mListView.setAdapter(mDataAdpter);[m
[32m+[m[32m        mListView.setOnItemClickListener(new onListItemClick());[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void init() {[m
[32m+[m[32m        mData = new ArrayList<>();[m
[32m+[m[32m        convertLatlng = new ConvertLatlng();[m
[32m+[m[32m        btnCancle = (AppCompatButton) findViewById(R.id.btn_cancel);[m
[32m+[m[32m        btnShow = (AppCompatButton) findViewById(R.id.btn_show);[m
[32m+[m[32m        mListView = (ListView) findViewById(R.id.data_manager_list);[m
[32m+[m[32m        mTextView = (TextView) findViewById(R.id.data_manager_text_filname);[m
[32m+[m[32m        layoutShow = (LinearLayout) findViewById(R.id.layoutshow);[m
[32m+[m[32m        rlTopbar = (RelativeLayout) findViewById(R.id.data_manager_topbar);[m
[32m+[m[32m        searchView = (SearchView) findViewById(R.id.search_view);[m
[32m+[m[32m        rlSearch = (RelativeLayout) findViewById(R.id.rl_search);[m
[32m+[m[32m        btnCancle.setOnClickListener(this);[m
[32m+[m[32m        btnShow.setOnClickListener(this);[m
[32m+[m[32m        searchView.setOnQueryTextListener(this);[m
[32m+[m[32m        mListView.setTextFilterEnabled(true);[m
[32m+[m[32m        selectALL = (CheckableRelativeLayout) findViewById(R.id.select_all);[m
[32m+[m[32m        isSelectALL = false;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public List<Map<String, Object>> getData() {[m
[32m+[m[32m        String path;[m
[32m+[m[32m        Intent intent = this.getIntent();[m
[32m+[m[32m        title = intent.getStringExtra("title");[m
[32m+[m[32m        path = intent.getStringExtra("path");[m
[32m+[m[32m        CoordStyle = intent.getIntExtra("CoordStyle", LatStyle.GPSSYTELE);[m
[32m+[m[32m        DataStyle = intent.getIntExtra("DataStyle", LatStyle.DEGREE);[m
[32m+[m[32m        FileReader fr;[m
[32m+[m[32m        BufferedReader bfr = null;[m
[32m+[m[32m        try {[m
[32m+[m[32m            fr = new FileReader(path);[m
[32m+[m[32m            bfr = new BufferedReader(fr);[m
[32m+[m[32m        } catch (FileNotFoundException e) {[m
[32m+[m[32m            e.printStackTrace();[m
[32m+[m[32m        }[m
[32m+[m[32m        String line;[m
[32m+[m[32m        try {[m
[32m+[m[32m            if (bfr != null) {[m
[32m+[m[32m                while ((line = bfr.readLine()) != null) {[m
[32m+[m[32m                    Map<String, Object> map = new HashMap<String, Object>();[m
[32m+[m[32m                    String[] split;[m
[32m+[m[32m                    split = line.split(",");[m
[32m+[m[32m                    map.put("name", split[0]);[m
[32m+[m[32m                    map.put("latitude", split[1]);[m
[32m+[m[32m                    map.put("longitude", split[2]);[m
[32m+[m[32m                    mData.add(map);[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        } catch (IOException e) {[m
[32m+[m[32m            e.printStackTrace();[m
[32m+[m[32m        }[m
[32m+[m[32m        mBackData = mData;[m
[32m+[m[32m        return mData;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onClick(View view) {[m
[32m+[m[32m        switch (view.getId()) {[m
[32m+[m[32m            case R.id.btn_show:[m
[32m+[m[32m                SparseBooleanArray checkedArray = mListView.getCheckedItemPositions();[m
[32m+[m[32m                getShowDataDao().deleteAll();[m
[32m+[m[32m                data data = (com.fanweilin.coordinatemap.Activity.data) getApplication();[m
[32m+[m[32m                SQLiteDatabase db = data.getDb();[m
[32m+[m[32m                db.beginTransaction();[m
[32m+[m[32m                for (int i = 0; i < checkedArray.size(); i++) {[m
[32m+[m[32m                    if (checkedArray.valueAt(i)) {[m
[32m+[m[32m                        Map<String, Object> map = new HashMap<>();[m
[32m+[m[32m                        map = mData.get(i);[m
[32m+[m[32m                        Log.d("DataMANAGER", String.valueOf(CoordStyle));[m
[32m+[m[32m                        Log.d("DataMANAGER", String.valueOf(DataStyle));[m
[32m+[m[32m                        Log.d("test1_datachlick", String.valueOf(DataStyle));[m
[32m+[m[32m                        ShowData showData = new ShowData(null, (String) map.get("name"), (String) map.get("latitude"), (String) map.get("longitude"), CoordStyle, DataStyle);[m
[32m+[m[32m                        getShowDataDao().insert(showData);[m
[32m+[m[32m                    }[m
[32m+[m[32m                }[m
[32m+[m[32m                db.setTransactionSuccessful();[m
[32m+[m[32m                db.endTransaction();[m
[32m+[m[32m                Intent intent = new Intent();[m
[32m+[m[32m                intent.putExtra("data", "more");[m
[32m+[m[32m                intent.setClass(DataManagerActivity.this, MainActivity.class);[m
[32m+[m[32m                startActivity(intent);[m
[32m+[m[32m                break;[m
[32m+[m[32m            case R.id.btn_cancel:[m
[32m+[m[32m                show = false;[m
[32m+[m[32m                selectALL.setVisibility(View.GONE);[m
[32m+[m[32m                layoutShow.setVisibility(View.GONE);[m
[32m+[m[32m                mDataAdpter.notifyDataSetChanged();[m
[32m+[m[32m                break;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public boolean onQueryTextSubmit(String s) {[m
[32m+[m
[32m+[m[32m        return false;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public boolean onQueryTextChange(String s) {[m
[32m+[m[32m//        if (s == null || s.length() == 0) {[m
[32m+[m[32m//           mListView.clearTextFilter();[m
[32m+[m[32m//        } else {[m
[32m+[m[32m//            mListView.setFilterText(s);[m
[32m+[m[32m//        }[m
[32m+[m[32m//        return true;[m
[32m+[m[32m        Filter filter = mDataAdpter.getFilter();[m
[32m+[m[32m        if (mDataAdpter instanceof Filterable) {[m
[32m+[m[32m            if (s == null || s.length() == 0) {[m
[32m+[m[32m                filter.filter("");[m
[32m+[m[32m            } else {[m
[32m+[m[32m                filter.filter(s);[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m        }[m
[32m+[m[32m        return true;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class ViewHolder {[m
[32m+[m[32m        TextView name;[m
[32m+[m[32m        TextView latitude;[m
[32m+[m[32m        TextView longitude;[m
[32m+[m[32m        CheckBox checkBox;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class DataAdpter extends BaseAdapter implements Filterable {[m
[32m+[m[32m        private LayoutInflater inflater;[m
[32m+[m[32m        private MyFilter mFilter;[m
[32m+[m
[32m+[m[32m        public DataAdpter(Context context) {[m
[32m+[m[32m            inflater = LayoutInflater.from(context);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getCount() {[m
[32m+[m[32m            return mData.size();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Object getItem(int i) {[m
[32m+[m[32m            return mData.get(i);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public long getItemId(int i) {[m
[32m+[m[32m            return i;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public View getView(int i, View view, ViewGroup viewGroup) {[m
[32m+[m
[32m+[m[32m            ViewHolder holder;[m
[32m+[m[32m            if ((view == null)) {[m
[32m+[m[32m                holder = new ViewHolder();[m
[32m+[m[32m                view = inflater.inflate(R.layout.list_data, null);[m
[32m+[m[32m                holder.name = (TextView) view.findViewById(R.id.name);[m
[32m+[m[32m                holder.latitude = (TextView) view.findViewById(R.id.latitude);[m
[32m+[m[32m                holder.longitude = (TextView) view.findViewById(R.id.longitude);[m
[32m+[m[32m                holder.checkBox = (CheckBox) view.findViewById(R.id.checkbox);[m
[32m+[m[32m                view.setTag(holder);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                holder = (ViewHolder) view.getTag();[m
[32m+[m[32m            }[m
[32m+[m[32m            holder.name.setText((String) mData.get(i).get("name"));[m
[32m+[m[32m            holder.latitude.setText(mData.get(i).get("latitude") + ",");[m
[32m+[m[32m            holder.longitude.setText((String) mData.get(i).get("longitude"));[m
[32m+[m[32m            if (show) {[m
[32m+[m[32m                holder.checkBox.setVisibility(View.VISIBLE);[m
[32m+[m[32m            } else {[m
[32m+[m
[32m+[m[32m                holder.checkBox.setVisibility(View.GONE);[m
[32m+[m[32m            }[m
[32m+[m[32m            return view;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Filter getFilter() {[m
[32m+[m[32m            if (null == mFilter) {[m
[32m+[m[32m                mFilter = new MyFilter();[m
[32m+[m[32m            }[m
[32m+[m[32m            return mFilter;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // 自定义Filter类[m
[32m+[m[32m        class MyFilter extends Filter {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            protected FilterResults performFiltering(CharSequence charSequence) {[m
[32m+[m[32m                List<Map<String, Object>> newData = new ArrayList<Map<String, Object>>();[m
[32m+[m[32m                FilterResults filterResults = new FilterResults();[m
[32m+[m[32m                String filterString = charSequence.toString().trim()[m
[32m+[m[32m                        .toLowerCase();[m
[32m+[m[32m                if (TextUtils.isEmpty(filterString)) {[m
[32m+[m[32m                    newData = mBackData;[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    // 过滤出新数据[m
[32m+[m[32m                    for (int i = 0; i < mBackData.size(); i++) {[m
[32m+[m[32m                        String str = null;[m
[32m+[m[32m                        str = mBackData.get(i).get("name").toString();[m
[32m+[m[32m                        if (-1 != str.toLowerCase().indexOf(filterString)) {[m
[32m+[m[32m                            newData.add(mBackData.get(i));[m
[32m+[m[32m                        }[m
[32m+[m[32m                    }[m
[32m+[m
[32m+[m[32m                }[m
[32m+[m[32m                filterResults.values = newData;[m
[32m+[m[32m                filterResults.count = newData.size();[m
[32m+[m[32m                return filterResults;[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            @Override[m
[32m+[m[32m            protected void publishResults(CharSequence charSequence, FilterResults filterResults) {[m
[32m+[m[32m                mData = (List<Map<String, Object>>) filterResults.values;[m
[32m+[m[32m                if (filterResults.count > 0) {[m
[32m+[m[32m                    mDataAdpter.notifyDataSetChanged();  // 通知数据发生了改变[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    mDataAdpter.notifyDataSetInvalidated(); // 通知数据失效[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class onListItemClick implements AdapterView.OnItemClickListener {[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void onItemClick(AdapterView<?> adapterView, View view, int i, long l) {[m
[32m+[m[32m            if (!show) {[m
[32m+[m[32m                double Lat = Double.parseDouble((String) mData.get(i).get("latitude"));[m
[32m+[m[32m                double Lng = Double.parseDouble((String) mData.get(i).get("longitude"));[m
[32m+[m[32m                Intent intent = new Intent();[m
[32m+[m[32m                intent.putExtra("Lat", Lat);[m
[32m+[m[32m                intent.putExtra("Lng", Lng);[m
[32m+[m[32m                intent.putExtra("name", mData.get(i).get("name").toString());[m
[32m+[m[32m                intent.putExtra("activityname", "com.fanweilin.coordinatemap.Activity.DataManagerActivity");[m
[32m+[m[32m                intent.putExtra("data", "one");[m
[32m+[m[32m                intent.putExtra("CoordStyle", CoordStyle);[m
[32m+[m[32m                intent.putExtra("DataStyle", DataStyle);[m
[32m+[m[32m                Log.d("test1_data", String.valueOf(DataStyle));[m
[32m+[m[32m                ComponentName componentName = new ComponentName(DataManagerActivity.this, MainActivity.class);[m
[32m+[m[32m                intent.setComponent(componentName);[m
[32m+[m[32m                startActivity(intent);[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void search(View view) {[m
[32m+[m[32m        if (searchShow) {[m
[32m+[m[32m            searchShow = false;[m
[32m+[m[32m            rlSearch.setVisibility(View.GONE);[m
[32m+[m[32m        } else {[m
[32m+[m
[32m+[m[32m            searchShow = true;[m
[32m+[m[32m            rlSearch.setVisibility(View.VISIBLE);[m
[32m+[m[32m            getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE[m
[32m+[m[32m                    | WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void navigation(View view) {[m
[32m+[m[32m        if (!show) {[m
[32m+[m[32m            show = true;[m
[32m+[m[32m            if (rlSearch.getVisibility() == View.VISIBLE) {[m
[32m+[m[32m                rlSearch.setVisibility(View.GONE);[m
[32m+[m[32m            }[m
[32m+[m[32m            selectALL.setVisibility(View.VISIBLE);[m
[32m+[m[32m            layoutShow.setVisibility(View.VISIBLE);[m
[32m+[m[32m            mDataAdpter.notifyDataSetChanged();[m
[32m+[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void checkall(View view) {[m
[32m+[m[32m        if (isSelectALL) {[m
[32m+[m[32m            for (int i = 0; i < mData.size(); i++) {[m
[32m+[m[32m                mListView.setItemChecked(i, false);[m
[32m+[m[32m                isSelectALL = false;[m
[32m+[m[32m            }[m
[32m+[m[32m            selectALL.setChecked(false);[m
[32m+[m
[32m+[m[32m        } else {[m
[32m+[m[32m            for (int i = 0; i < mData.size(); i++) {[m
[32m+[m[32m                mListView.setItemChecked(i, true);[m
[32m+[m[32m                isSelectALL = true;[m
[32m+[m[32m            }[m
[32m+[m[32m            selectALL.setChecked(true);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    private ShowDataDao getShowDataDao() {[m
[32m+[m[32m        DaoSession mDaoSession;[m
[32m+[m[32m        data app = (com.fanweilin.coordinatemap.Activity.data) getApplication();[m
[32m+[m[32m        mDaoSession = app.getmDaoSession();[m
[32m+[m[32m        return mDaoSession.getShowDataDao();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public void back(View view) {[m
[32m+[m[32m        finish();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Activity/FileManagerActivity.java b/app/src/main/java/com/fanweilin/coordinatemap/Activity/FileManagerActivity.java[m
[1mnew file mode 100644[m
[1mindex 0000000..886aa42[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Activity/FileManagerActivity.java[m
[36m@@ -0,0 +1,163 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Activity;[m
[32m+[m
[32m+[m[32mimport android.app.Activity;[m
[32m+[m[32mimport android.content.DialogInterface;[m
[32m+[m[32mimport android.content.Intent;[m
[32m+[m[32mimport android.database.Cursor;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.support.v7.app.AlertDialog;[m
[32m+[m[32mimport android.util.Log;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.widget.AdapterView;[m
[32m+[m[32mimport android.widget.ListView;[m
[32m+[m[32mimport android.widget.SimpleCursorAdapter;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.coordinatemap.Class.FileStyle;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m[32mimport com.fanweilin.greendao.DaoSession;[m
[32m+[m[32mimport com.fanweilin.greendao.Files;[m
[32m+[m[32mimport com.fanweilin.greendao.FilesDao;[m
[32m+[m
[32m+[m[32mimport java.text.DateFormat;[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.Date;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m
[32m+[m[32mpublic class FileManagerActivity extends Activity {[m
[32m+[m[32m    private static final int REQUEST = 1;[m
[32m+[m[32m    private DaoSession mDaoSession;[m
[32m+[m[32m    private Cursor cursor;[m
[32m+[m[32m    private ListView listView;[m
[32m+[m[32m    private SQLiteDatabase db;[m
[32m+[m[32m    private List<String> listName = new ArrayList<String>();[m
[32m+[m[32m    private FileStyle mStyle;[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        setContentView(R.layout.activity_file_manager);[m
[32m+[m[32m        setupDateBase();[m
[32m+[m[32m        String[] from = {FilesDao.Properties.Title.columnName, FilesDao.Properties.Date.columnName};[m
[32m+[m[32m        int[] to = {android.R.id.text1, android.R.id.text2};[m
[32m+[m[32m        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_2, cursor, from,[m
[32m+[m[32m                to);[m
[32m+[m[32m        listView.setAdapter(adapter);[m
[32m+[m[32m        listView.setOnItemLongClickListener(new MyItemLongclick());[m
[32m+[m[32m        listView.setOnItemClickListener(new MyOnItemclick());[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void setupDateBase() {[m
[32m+[m[32m        data app = (data) getApplication();[m
[32m+[m[32m        mDaoSession = app.getmDaoSession();[m
[32m+[m[32m        db = app.getDb();[m
[32m+[m[32m        mStyle = new FileStyle();[m
[32m+[m[32m        listView = (ListView) findViewById(R.id.file_manager_listview);[m
[32m+[m[32m        getdate();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private FilesDao getFileDao() {[m
[32m+[m[32m        return mDaoSession.getFilesDao();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void back(View view) {[m
[32m+[m[32m        finish();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void add(View view) {[m
[32m+[m[32m        Intent intent = new Intent();[m
[32m+[m[32m        intent.setClass(FileManagerActivity.this, AddFileActivity.class);[m
[32m+[m[32m        startActivityForResult(intent, REQUEST);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void more(View view) {[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void getdate() {[m
[32m+[m
[32m+[m[32m        cursor = db.query(getFileDao().getTablename(), getFileDao().getAllColumns(), null, null, null, null, null);[m
[32m+[m[32m        if (cursor.moveToFirst()) {[m
[32m+[m[32m            String filename;[m
[32m+[m[32m            int nameColumnIndex = cursor.getColumnIndex(FilesDao.Properties.Title.columnName);[m
[32m+[m[32m            filename = cursor.getString(nameColumnIndex);[m
[32m+[m[32m            listName.add(filename);[m
[32m+[m[32m            while (cursor.moveToNext()) {[m
[32m+[m[32m                filename = cursor.getString(nameColumnIndex);[m
[32m+[m[32m                listName.add(filename);[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    private class MyItemLongclick implements AdapterView.OnItemLongClickListener {[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean onItemLongClick(AdapterView<?> adapterView, View view, int i, final long l) {[m
[32m+[m[32m            AlertDialog.Builder builder = new AlertDialog.Builder(FileManagerActivity.this);[m
[32m+[m[32m            builder.setTitle("文件删除");[m
[32m+[m[32m            builder.setMessage("确定删除吗？");[m
[32m+[m[32m            builder.setPositiveButton("确定", new DialogInterface.OnClickListener() {[m
[32m+[m[32m                @Override[m
[32m+[m[32m                public void onClick(DialogInterface dialog, int which) {[m
[32m+[m[32m                    getFileDao().deleteByKey(l);[m
[32m+[m[32m                    cursor.requery();[m
[32m+[m[32m                }[m
[32m+[m[32m            });[m
[32m+[m[32m            builder.setNegativeButton("取消", new DialogInterface.OnClickListener() {[m
[32m+[m[32m                @Override[m
[32m+[m[32m                public void onClick(DialogInterface dialog, int which) {[m
[32m+[m[32m                }[m
[32m+[m[32m            });[m
[32m+[m[32m            builder.create().show();[m
[32m+[m[32m            return true;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private class MyOnItemclick implements AdapterView.OnItemClickListener {[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void onItemClick(AdapterView<?> adapterView, View view, int i, long l) {[m
[32m+[m[32m            String filepath;[m
[32m+[m[32m            String title;[m
[32m+[m[32m            int coordstyle;[m
[32m+[m[32m            int datastyle;[m
[32m+[m[32m            cursor.moveToPosition(i);[m
[32m+[m[32m            filepath = cursor.getString(cursor.getColumnIndex(FilesDao.Properties.Path.columnName));[m
[32m+[m[32m            title = cursor.getString(cursor.getColumnIndex(FilesDao.Properties.Title.columnName));[m
[32m+[m[32m            coordstyle = cursor.getInt(cursor.getColumnIndex(FilesDao.Properties.Cdstyle.columnName));[m
[32m+[m[32m            datastyle = cursor.getInt(cursor.getColumnIndex(FilesDao.Properties.Datastyle.columnName));[m
[32m+[m[32m            Intent intent = new Intent();[m
[32m+[m[32m            intent.putExtra("path", filepath);[m
[32m+[m[32m            intent.putExtra("title", title);[m
[32m+[m[32m            intent.putExtra("CoordStyle", coordstyle);[m
[32m+[m[32m            intent.putExtra("DataStyle", datastyle);[m
[32m+[m[32m            intent.setClass(FileManagerActivity.this, DataManagerActivity.class);[m
[32m+[m[32m            startActivity(intent);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onActivityResult(int requestCode, int resultCode, Intent data) {[m
[32m+[m[32m        String path;[m
[32m+[m[32m        String title;[m
[32m+[m[32m        if (resultCode == RESULT_OK) {[m
[32m+[m[32m            if (requestCode == REQUEST) {[m
[32m+[m[32m                Bundle mBundle;[m
[32m+[m[32m                mBundle = data.getExtras();[m
[32m+[m[32m                path = mBundle.getString("path");[m
[32m+[m[32m                title = mBundle.getString("title");[m
[32m+[m[32m                final DateFormat df = DateFormat.getDateTimeInstance(DateFormat.MEDIUM, DateFormat.MEDIUM);[m
[32m+[m[32m                String comment = "Added on " + df.format(new Date());[m
[32m+[m[32m                int coordstyle = mBundle.getInt("CoordStyle");[m
[32m+[m[32m                int datastyle = mBundle.getInt("DataStyle");[m
[32m+[m[32m                Files files = new Files(null, title, path, comment, coordstyle, datastyle);[m
[32m+[m[32m                Log.d("test", String.valueOf(coordstyle));[m
[32m+[m[32m                Log.d("test", String.valueOf(datastyle));[m
[32m+[m[32m                getFileDao().insert(files);[m
[32m+[m[32m                cursor.requery();[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Activity/MainActivity.java b/app/src/main/java/com/fanweilin/coordinatemap/Activity/MainActivity.java[m
[1mnew file mode 100644[m
[1mindex 0000000..31e31cc[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Activity/MainActivity.java[m
[36m@@ -0,0 +1,784 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Activity;[m
[32m+[m
[32m+[m[32mimport android.content.DialogInterface;[m
[32m+[m[32mimport android.content.Intent;[m
[32m+[m[32mimport android.database.Cursor;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m[32mimport android.graphics.drawable.ColorDrawable;[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.support.design.widget.NavigationView;[m
[32m+[m[32mimport android.support.v4.widget.DrawerLayout;[m
[32m+[m[32mimport android.support.v7.app.ActionBarDrawerToggle;[m
[32m+[m[32mimport android.support.v7.app.AlertDialog;[m
[32m+[m[32mimport android.support.v7.app.AppCompatActivity;[m
[32m+[m[32mimport android.support.v7.widget.CardView;[m
[32m+[m[32mimport android.support.v7.widget.Toolbar;[m
[32m+[m[32mimport android.util.Log;[m
[32m+[m[32mimport android.view.KeyEvent;[m
[32m+[m[32mimport android.view.LayoutInflater;[m
[32m+[m[32mimport android.view.Menu;[m
[32m+[m[32mimport android.view.MenuItem;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.view.ViewGroup;[m
[32m+[m[32mimport android.widget.AdapterView;[m
[32m+[m[32mimport android.widget.EditText;[m
[32m+[m[32mimport android.widget.ImageButton;[m
[32m+[m[32mimport android.widget.ImageView;[m
[32m+[m[32mimport android.widget.PopupWindow;[m
[32m+[m[32mimport android.widget.RadioButton;[m
[32m+[m[32mimport android.widget.RadioGroup;[m
[32m+[m[32mimport android.widget.Spinner;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m[32mimport android.widget.Toast;[m
[32m+[m
[32m+[m[32mimport com.baidu.location.BDLocation;[m
[32m+[m[32mimport com.baidu.location.BDLocationListener;[m
[32m+[m[32mimport com.baidu.location.LocationClient;[m
[32m+[m[32mimport com.baidu.location.LocationClientOption;[m
[32m+[m[32mimport com.baidu.mapapi.SDKInitializer;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.Cluster;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterItem;[m
[32m+[m[32mimport com.baidu.mapapi.clusterutil.clustering.ClusterManager;[m
[32m+[m[32mimport com.baidu.mapapi.map.BaiduMap;[m
[32m+[m[32mimport com.baidu.mapapi.map.BitmapDescriptor;[m
[32m+[m[32mimport com.baidu.mapapi.map.BitmapDescriptorFactory;[m
[32m+[m[32mimport com.baidu.mapapi.map.MapStatusUpdate;[m
[32m+[m[32mimport com.baidu.mapapi.map.MapStatusUpdateFactory;[m
[32m+[m[32mimport com.baidu.mapapi.map.MapView;[m
[32m+[m[32mimport com.baidu.mapapi.map.Marker;[m
[32m+[m[32mimport com.baidu.mapapi.map.MarkerOptions;[m
[32m+[m[32mimport com.baidu.mapapi.map.MyLocationConfiguration;[m
[32m+[m[32mimport com.baidu.mapapi.map.MyLocationData;[m
[32m+[m[32mimport com.baidu.mapapi.map.OverlayOptions;[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLngBounds;[m
[32m+[m[32mimport com.baidu.mapapi.navi.BaiduMapAppNotSupportNaviException;[m
[32m+[m[32mimport com.baidu.mapapi.navi.BaiduMapNavigation;[m
[32m+[m[32mimport com.baidu.mapapi.navi.NaviParaOption;[m
[32m+[m[32mimport com.baidu.mapapi.search.core.SearchResult;[m
[32m+[m[32mimport com.baidu.mapapi.search.geocode.GeoCodeResult;[m
[32m+[m[32mimport com.baidu.mapapi.search.geocode.GeoCoder;[m
[32m+[m[32mimport com.baidu.mapapi.search.geocode.OnGetGeoCoderResultListener;[m
[32m+[m[32mimport com.baidu.mapapi.search.geocode.ReverseGeoCodeOption;[m
[32m+[m[32mimport com.baidu.mapapi.search.geocode.ReverseGeoCodeResult;[m
[32m+[m[32mimport com.baidu.mapapi.utils.CoordinateConverter;[m
[32m+[m[32mimport com.baidu.mapapi.utils.OpenClientUtil;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.Class.LatStyle;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.computing.ConvertLatlng;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.computing.DataItem;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.widget.ZoomControlsView;[m
[32m+[m[32mimport com.fanweilin.greendao.DaoSession;[m
[32m+[m[32mimport com.fanweilin.greendao.ShowDataDao;[m
[32m+[m
[32m+[m[32mimport java.text.DecimalFormat;[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m
[32m+[m[32mpublic class MainActivity extends AppCompatActivity implements View.OnClickListener, BaiduMap.OnMapLoadedCallback {[m
[32m+[m[32m    public Toolbar toolbar;[m
[32m+[m[32m    public DrawerLayout drawerLayout;[m
[32m+[m[32m    public ActionBarDrawerToggle mDrawerToggle;[m
[32m+[m[32m    public LocationClient mLocationClient = null;[m
[32m+[m[32m    public BaiduMap mBaiduMap;[m
[32m+[m[32m    public MapView mMapView;[m
[32m+[m[32m    public BDLocationListener myListener = new MyLocationListener();[m
[32m+[m[32m    public double latitude;[m
[32m+[m[32m    public double lontitude;[m
[32m+[m[32m    public ZoomControlsView zoomControlsView;[m
[32m+[m[32m    private CoordinateConverter converter;[m
[32m+[m[32m    private BitmapDescriptor bitmap;[m
[32m+[m[32m    private BitmapDescriptor bitmaplocation;[m
[32m+[m[32m    private ClusterManager<MyItem> mClusterManager;[m
[32m+[m[32m    private ImageButton imgLayerChange;[m
[32m+[m[32m    private ImageButton imgClearall;[m
[32m+[m[32m    private ImageButton imgMyloncation;[m
[32m+[m[32m    private boolean MAP_STYLE = true;[m
[32m+[m[32m    private int coordstyle;[m
[32m+[m[32m    private int datastyle;[m
[32m+[m[32m    private NavigationView mNavigationView;[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onNewIntent(Intent intent) {[m
[32m+[m[32m        super.onNewIntent(intent);[m
[32m+[m[32m        setIntent(intent);[m
[32m+[m[32m        setlocation(getIntent());[m
[32m+[m[32m        showdata(getIntent());[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        SDKInitializer.initialize(getApplicationContext());[m
[32m+[m[32m        setContentView(R.layout.activity_main);[m
[32m+[m[32m        init();[m
[32m+[m[32m        setSupportActionBar(toolbar);[m
[32m+[m[32m        getSupportActionBar().setHomeButtonEnabled(true); //设置返回键可用[m
[32m+[m[32m        getSupportActionBar().setDisplayHomeAsUpEnabled(true);[m
[32m+[m[32m        mDrawerToggle = new ActionBarDrawerToggle(this, drawerLayout, toolbar, R.string.open, R.string.close) {[m
[32m+[m[32m            public void onDrawerOpened(View drawerView) {[m
[32m+[m[32m                super.onDrawerOpened(drawerView);[m
[32m+[m[32m                //mAnimationDrawable.stop();[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onDrawerClosed(View drawerView) {[m
[32m+[m[32m                super.onDrawerClosed(drawerView);[m
[32m+[m[32m                // mAnimationDrawable.start();[m
[32m+[m[32m            }[m
[32m+[m[32m        };[m
[32m+[m[32m        toolbar.setOnMenuItemClickListener(onMenuItemClickListener);[m
[32m+[m[32m        mDrawerToggle.syncState();[m
[32m+[m[32m        drawerLayout.setDrawerListener(mDrawerToggle);[m
[32m+[m[32m        initLocation();[m
[32m+[m[32m        mLocationClient.start();[m
[32m+[m[32m        mLocationClient.registerLocationListener(myListener);[m
[32m+[m[32m        showdata();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void setupDrawerContent(NavigationView navigationView) {[m
[32m+[m[32m        navigationView.setNavigationItemSelectedListener([m
[32m+[m[32m                new NavigationView.OnNavigationItemSelectedListener() {[m
[32m+[m[32m                    @Override[m
[32m+[m[32m                    public boolean onNavigationItemSelected(MenuItem menuItem) {[m
[32m+[m[32m                        switch (menuItem.getItemId()) {[m
[32m+[m
[32m+[m[32m                            case R.id.nav_computer:[m
[32m+[m[32m                                computer();[m
[32m+[m[32m                                break;[m
[32m+[m[32m                            case R.id.nav_down:[m
[32m+[m[32m                                download();[m
[32m+[m[32m                                break;[m
[32m+[m[32m                            case R.id.nav_about:[m
[32m+[m[32m                                about();[m
[32m+[m[32m                                break;[m
[32m+[m[32m                            case R.id.nav_quit:[m
[32m+[m[32m                                finish();[m
[32m+[m[32m                                break;[m
[32m+[m
[32m+[m[32m                        }[m
[32m+[m[32m                        menuItem.setChecked(true);[m
[32m+[m[32m                        drawerLayout.closeDrawers();[m
[32m+[m[32m                        return true;[m
[32m+[m[32m                    }[m
[32m+[m[32m                });[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void download() {[m
[32m+[m[32m        Intent intent = new Intent();[m
[32m+[m[32m        intent.setClass(MainActivity.this, Bdoffilin_activity.class);[m
[32m+[m[32m        startActivity(intent);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void computer() {[m
[32m+[m[32m        Intent intent = new Intent();[m
[32m+[m[32m        intent.setClass(MainActivity.this, ConvertActivity.class);[m
[32m+[m[32m        startActivity(intent);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void about() {[m
[32m+[m[32m        AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this);[m
[32m+[m[32m        builder.setMessage("本软件为第一版,难免会存在一些bug和不足。如果你在使用过程中发现问题或有好的建议可以联系作者。\n897481601@qq.com");[m
[32m+[m[32m        builder.setTitle("关于");[m
[32m+[m[32m        builder.setPositiveButton("确认", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialogInterface, int i) {[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        builder.create().show();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onStart() {[m
[32m+[m[32m        super.onStart();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onClick(View view) {[m
[32m+[m
[32m+[m[32m        switch (view.getId()) {[m
[32m+[m[32m            case R.id.imgbtn_layer:[m
[32m+[m[32m                if (MAP_STYLE) {[m
[32m+[m[32m                    mBaiduMap.setMapType(BaiduMap.MAP_TYPE_SATELLITE);[m
[32m+[m[32m                    MAP_STYLE = false;[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    mBaiduMap.setMapType(BaiduMap.MAP_TYPE_NORMAL);[m
[32m+[m[32m                    MAP_STYLE = true;[m
[32m+[m[32m                }[m
[32m+[m[32m                break;[m
[32m+[m[32m            case R.id.imgbtn_clearall: {[m
[32m+[m[32m                AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this);[m
[32m+[m[32m                builder.setMessage("确认清除标注吗?");[m
[32m+[m[32m                builder.setTitle("提示");[m
[32m+[m[32m                builder.setPositiveButton("确认", new DialogInterface.OnClickListener() {[m
[32m+[m[32m                    @Override[m
[32m+[m[32m                    public void onClick(DialogInterface dialogInterface, int i) {[m
[32m+[m[32m                        data app = (data) getApplication();[m
[32m+[m[32m                        DaoSession mDaoSession = app.getmDaoSession();[m
[32m+[m[32m                        ShowDataDao showDataDao = mDaoSession.getShowDataDao();[m
[32m+[m[32m                        mBaiduMap.clear();[m
[32m+[m[32m                        mClusterManager.clearItems();[m
[32m+[m[32m                        showDataDao.deleteAll();[m
[32m+[m[32m                    }[m
[32m+[m[32m                });[m
[32m+[m[32m                builder.setNegativeButton("取消", new DialogInterface.OnClickListener() {[m
[32m+[m[32m                    @Override[m
[32m+[m[32m                    public void onClick(DialogInterface dialogInterface, int i) {[m
[32m+[m
[32m+[m[32m                    }[m
[32m+[m[32m                });[m
[32m+[m[32m                builder.create().show();[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m[32m            break;[m
[32m+[m[32m            case R.id.imgbtn_mylocation:[m
[32m+[m[32m                setMapCenter(latitude, lontitude);[m
[32m+[m[32m                break;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onMapLoaded() {[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class MyItem implements ClusterItem {[m
[32m+[m[32m        private final LatLng mPosition;[m
[32m+[m[32m        private DataItem dataItem;[m
[32m+[m
[32m+[m[32m        public MyItem(LatLng latLng, DataItem mDataItem) {[m
[32m+[m[32m            mPosition = latLng;[m
[32m+[m[32m            dataItem = mDataItem;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public DataItem getDataItem() {[m
[32m+[m[32m            return dataItem;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public LatLng getPosition() {[m
[32m+[m[32m            return mPosition;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public BitmapDescriptor getBitmapDescriptor() {[m
[32m+[m[32m            return bitmap;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void showdata(Intent intent) {[m
[32m+[m[32m        String data = intent.getStringExtra("data");[m
[32m+[m[32m        if (data != null && data.equals("more")) {[m
[32m+[m[32m            showdata();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void showdata() {[m
[32m+[m[32m        LatLngBounds mLatLngBounds;[m
[32m+[m[32m        Cursor cursor;[m
[32m+[m[32m        SQLiteDatabase db;[m
[32m+[m[32m        LatLngBounds.Builder builder = new LatLngBounds.Builder();[m
[32m+[m[32m        data app = (data) getApplication();[m
[32m+[m[32m        DaoSession mDaoSession = app.getmDaoSession();[m
[32m+[m[32m        ShowDataDao showDataDao = mDaoSession.getShowDataDao();[m
[32m+[m[32m        db = app.getDb();[m
[32m+[m[32m        cursor = db.query(showDataDao.getTablename(), showDataDao.getAllColumns(), null, null, null, null, null);[m
[32m+[m[32m        List<MyItem> items = new ArrayList<>();[m
[32m+[m[32m        if (cursor.getCount() != 0) {[m
[32m+[m[32m            while (cursor.moveToNext()) {[m
[32m+[m[32m                DataItem mDataItem = new DataItem();[m
[32m+[m[32m                int CoordStyle = cursor.getInt(cursor.getColumnIndex(ShowDataDao.Properties.Cdstyle.columnName));[m
[32m+[m[32m                int DataStyle = cursor.getInt(cursor.getColumnIndex(ShowDataDao.Properties.Datastyle.columnName));[m
[32m+[m[32m                String name = cursor.getString(cursor.getColumnIndex(ShowDataDao.Properties.Title.columnName));[m
[32m+[m[32m                double lat = Double.parseDouble(cursor.getString(cursor.getColumnIndex(ShowDataDao.Properties.Latitude.columnName)).toString());[m
[32m+[m[32m                double lon = Double.parseDouble(cursor.getString(cursor.getColumnIndex(ShowDataDao.Properties.Longitude.columnName)).toString());[m
[32m+[m[32m                LatLng point = new LatLng(lat, lon);[m
[32m+[m[32m                LatLng bdpoint = ComanLngConvertBdLngt(point, CoordStyle, DataStyle);[m
[32m+[m[32m                mDataItem.setName(name);[m
[32m+[m[32m                mDataItem.setLatLng(point);[m
[32m+[m[32m                items.add(new MyItem(bdpoint, mDataItem));[m
[32m+[m[32m                builder.include(bdpoint);[m
[32m+[m[32m            }[m
[32m+[m[32m            mLatLngBounds = builder.build();[m
[32m+[m[32m            mClusterManager.addItems(items);[m
[32m+[m[32m            mBaiduMap.animateMapStatus(MapStatusUpdateFactory.newLatLngBounds(mLatLngBounds));[m
[32m+[m[32m        }[m
[32m+[m[32m        cursor.close();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private boolean setlocation(Intent intent) {[m
[32m+[m[32m        String name;[m
[32m+[m[32m        String test = DataManagerActivity.class.getName();[m
[32m+[m[32m        name = intent.getStringExtra("activityname");[m
[32m+[m[32m        if (name != null) {[m
[32m+[m[32m            if (name.equals(test)) {[m
[32m+[m[32m                LatLng point = new LatLng(intent.getDoubleExtra("Lat", 0.0), intent.getDoubleExtra("Lng", 0.0));[m
[32m+[m[32m                int coordstyle = intent.getIntExtra("CoordStyle", 0);[m
[32m+[m[32m                int datastyle = intent.getIntExtra("DataStyle", 0);[m
[32m+[m[32m                Log.d("test1_main", String.valueOf(datastyle));[m
[32m+[m[32m                LatLng baidupoint = ComanLngConvertBdLngt(point, coordstyle, datastyle);[m
[32m+[m[32m                Bundle bundle = new Bundle();[m
[32m+[m[32m                bundle.putInt(MAKER_STYLE, INTENT_MARKER);[m
[32m+[m[32m                bundle.putDouble("latitude", point.latitude);[m
[32m+[m[32m                bundle.putDouble("longitude", point.longitude);[m
[32m+[m[32m                bundle.putString("name", intent.getStringExtra("name"));[m
[32m+[m[32m                OverlayOptions options2 = new MarkerOptions().position(baidupoint).icon(bitmaplocation).extraInfo(bundle);[m
[32m+[m[32m                mBaiduMap.addOverlay(options2);[m
[32m+[m[32m                setMapCenter(baidupoint.latitude, baidupoint.longitude);[m
[32m+[m[32m                return true;[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        return false;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void init() {[m
[32m+[m[32m        converter = new CoordinateConverter();[m
[32m+[m[32m        imgLayerChange = (ImageButton) findViewById(R.id.imgbtn_layer);[m
[32m+[m[32m        imgClearall = (ImageButton) findViewById(R.id.imgbtn_clearall);[m
[32m+[m[32m        imgMyloncation = (ImageButton) findViewById(R.id.imgbtn_mylocation);[m
[32m+[m[32m        toolbar = (Toolbar) findViewById(R.id.toolbar);[m
[32m+[m[32m        drawerLayout = (DrawerLayout) findViewById(R.id.drawerlayout);[m
[32m+[m[32m        mLocationClient = new LocationClient(getApplicationContext());     //声明LocationClient类[m
[32m+[m[32m        mMapView = (MapView) findViewById(R.id.bmapView);[m
[32m+[m[32m        mMapView.showZoomControls(false);[m
[32m+[m[32m        zoomControlsView = (ZoomControlsView) findViewById(R.id.activity_main_zoomcontrols);[m
[32m+[m[32m        mBaiduMap = mMapView.getMap();[m
[32m+[m[32m        zoomControlsView.setBaiduMap(mMapView);[m
[32m+[m[32m        mBaiduMap.setMapStatus(MapStatusUpdateFactory.zoomTo(14f));[m
[32m+[m[32m        bitmap = BitmapDescriptorFactory[m
[32m+[m[32m                .fromResource(R.mipmap.location_pin);[m
[32m+[m[32m        mNavigationView = (NavigationView) findViewById(R.id.nav_view);[m
[32m+[m[32m        setupDrawerContent(mNavigationView);[m
[32m+[m[32m        mClusterManager = new ClusterManager<>(this, mBaiduMap);[m
[32m+[m[32m        mBaiduMap.setOnMapStatusChangeListener(mClusterManager);[m
[32m+[m[32m        mClusterManager.setOnClusterClickListener(onClusterClickListener);[m
[32m+[m[32m        mClusterManager.setOnClusterItemClickListener(onClusterItemClickListener);[m
[32m+[m[32m        mBaiduMap.setOnMarkerClickListener(mClusterManager);[m
[32m+[m[32m        bitmaplocation = BitmapDescriptorFactory[m
[32m+[m[32m                .fromResource(R.mipmap.location);[m
[32m+[m[32m        mBaiduMap.setOnMarkerClickListener(new BaiduMap.OnMarkerClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public boolean onMarkerClick(Marker marker) {[m
[32m+[m[32m                PopupWindowmark(marker);[m
[32m+[m[32m                return false;[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        imgLayerChange.setOnClickListener(this);[m
[32m+[m[32m        imgClearall.setOnClickListener(this);[m
[32m+[m[32m        imgMyloncation.setOnClickListener(this);[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public ClusterManager.OnClusterItemClickListener<MyItem> onClusterItemClickListener = new ClusterManager.OnClusterItemClickListener<MyItem>() {[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean onClusterItemClick(MyItem item) {[m
[32m+[m[32m            showpopupwindows(item);[m
[32m+[m[32m            return false;[m
[32m+[m[32m        }[m
[32m+[m[32m    };[m
[32m+[m[32m    public ClusterManager.OnClusterClickListener<MyItem> onClusterClickListener = new ClusterManager.OnClusterClickListener<MyItem>() {[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean onClusterClick(Cluster<MyItem> cluster) {[m
[32m+[m[32m            LatLngBounds latLngBounds = null;[m
[32m+[m[32m            LatLngBounds.Builder builder = new LatLngBounds.Builder();[m
[32m+[m[32m            List<MyItem> list = new ArrayList<MyItem>();[m
[32m+[m[32m            list = (List<MyItem>) cluster.getItems();[m
[32m+[m[32m            for (int i = 0; i < list.size(); i++) {[m
[32m+[m[32m                builder.include(list.get(i).getPosition());[m
[32m+[m[32m            }[m
[32m+[m[32m            latLngBounds = builder.build();[m
[32m+[m[32m            mBaiduMap.animateMapStatus(MapStatusUpdateFactory.newLatLngBounds(latLngBounds));[m
[32m+[m[32m            return false;[m
[32m+[m[32m        }[m
[32m+[m[32m    };[m
[32m+[m
[32m+[m[32m    private void initLocation() {[m
[32m+[m[32m        LocationClientOption option = new LocationClientOption();[m
[32m+[m[32m        option.setLocationMode(LocationClientOption.LocationMode.Hight_Accuracy[m
[32m+[m[32m        );//可选，默认高精度，设置定位模式，高精度，低功耗，仅设备[m
[32m+[m[32m        option.setCoorType("bd09ll");//可选，默认gcj02，设置返回的定位结果坐标系[m
[32m+[m[32m        int span = 1000;[m
[32m+[m[32m        option.setScanSpan(span);//可选，默认0，即仅定位一次，设置发起定位请求的间隔需要大于等于1000ms才是有效的[m
[32m+[m[32m        option.setIsNeedAddress(true);//可选，设置是否需要地址信息，默认不需要[m
[32m+[m[32m        option.setOpenGps(true);//可选，默认false,设置是否使用gps[m
[32m+[m[32m        option.setLocationNotify(true);//可选，默认false，设置是否当gps有效时按照1S1次频率输出GPS结果[m
[32m+[m[32m        option.setIsNeedLocationDescribe(true);//可选，默认false，设置是否需要位置语义化结果，可以在BDLocation.getLocationDescribe里得到，结果类似于“在北京天安门附近”[m
[32m+[m[32m        option.setIsNeedLocationPoiList(true);//可选，默认false，设置是否需要POI结果，可以在BDLocation.getPoiList里得到[m
[32m+[m[32m        option.setIgnoreKillProcess(false);//可选，默认false，定位SDK内部是一个SERVICE，并放到了独立进程，设置是否在stop的时候杀死这个进程，默认杀死[m
[32m+[m[32m        option.SetIgnoreCacheException(false);//可选，默认false，设置是否收集CRASH信息，默认收集[m
[32m+[m[32m        option.setEnableSimulateGps(false);//可选，默认false，设置是否需要过滤gps仿真结果，默认需要[m
[32m+[m[32m        mLocationClient.setLocOption(option);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public class MyLocationListener implements BDLocationListener {[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public void onReceiveLocation(BDLocation location) {[m
[32m+[m[32m            // test(location);[m
[32m+[m[32m            if (latitude == 0.0) {[m
[32m+[m[32m                latitude = location.getLatitude();[m
[32m+[m[32m                lontitude = location.getLongitude();[m
[32m+[m[32m                setMapCenter(latitude, lontitude);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                latitude = location.getLatitude();[m
[32m+[m[32m                lontitude = location.getLongitude();[m
[32m+[m[32m            }[m
[32m+[m[32m            showLocation(location);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void showLocation(BDLocation location) {[m
[32m+[m[32m        mBaiduMap.setMyLocationEnabled(true);[m
[32m+[m[32m        MyLocationData locData = new MyLocationData.Builder()[m
[32m+[m[32m                .accuracy(location.getRadius())[m
[32m+[m[32m                .direction(100).latitude(location.getLatitude())[m
[32m+[m[32m                .longitude(location.getLongitude()).build();[m
[32m+[m[32m        mBaiduMap.setMyLocationData(locData);[m
[32m+[m[32m        MyLocationConfiguration config = new MyLocationConfiguration(MyLocationConfiguration.LocationMode.NORMAL, true, null);[m
[32m+[m[32m        mBaiduMap.setMyLocationConfigeration(config);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void setMapCenter(double latitude, double lontitude) {[m
[32m+[m[32m        MapStatusUpdate mMapStatusUpdate = MapStatusUpdateFactory.newLatLng(new LatLng(latitude, lontitude));[m
[32m+[m[32m        mBaiduMap.animateMapStatus(mMapStatusUpdate);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private Toolbar.OnMenuItemClickListener onMenuItemClickListener = new Toolbar.OnMenuItemClickListener() {[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean onMenuItemClick(MenuItem item) {[m
[32m+[m[32m            switch (item.getItemId()) {[m
[32m+[m[32m                case R.id.menu_search:[m
[32m+[m[32m                    ShowDialog();[m
[32m+[m[32m                    break;[m
[32m+[m[32m                case R.id.add_file:[m
[32m+[m[32m                    Intent intent = new Intent();[m
[32m+[m[32m                    intent.setClass(MainActivity.this, FileManagerActivity.class);[m
[32m+[m[32m                    startActivity(intent);[m
[32m+[m[32m                    break;[m
[32m+[m[32m            }[m
[32m+[m[32m            return true;[m
[32m+[m[32m        }[m
[32m+[m[32m    };[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public boolean onCreateOptionsMenu(Menu menu) {[m
[32m+[m[32m        // Inflate the menu; this adds items to the action bar if it is present.[m
[32m+[m[32m        getMenuInflater().inflate(R.menu.menu_main, menu);[m
[32m+[m[32m        return true;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onPause() {[m
[32m+[m[32m        super.onPause();[m
[32m+[m[32m        mMapView.onPause();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onResume() {[m
[32m+[m[32m        super.onResume();[m
[32m+[m[32m        mMapView.onResume();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    protected void onDestroy() {[m
[32m+[m[32m        super.onDestroy();[m
[32m+[m[32m        mBaiduMap.setMyLocationEnabled(false);[m
[32m+[m[32m        bitmaplocation.recycle();[m
[32m+[m[32m        BaiduMapNavigation.finish(this);[m
[32m+[m[32m        mMapView.onDestroy();//销毁地图[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public LatLng ComanLngConvertBdLngt(LatLng lat, int coordstyle, int datastyle) {[m
[32m+[m[32m        LatLng bdLng = null;[m
[32m+[m[32m        switch (coordstyle) {[m
[32m+[m[32m            case LatStyle.GPSSYTELE://84[m
[32m+[m[32m                if (datastyle == LatStyle.DEGREE) {[m
[32m+[m[32m                    converter.from(CoordinateConverter.CoordType.GPS);[m
[32m+[m[32m                    converter.coord(lat);[m
[32m+[m[32m                    bdLng = converter.convert();[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    ConvertLatlng convertLatlng = new ConvertLatlng();[m
[32m+[m[32m                    double latitude = convertLatlng.convertToDecimalByString(String.valueOf(lat.latitude));[m
[32m+[m[32m                    double longtitude = convertLatlng.convertToDecimalByString(String.valueOf(lat.longitude));[m
[32m+[m[32m                    LatLng latdimacal = new LatLng(latitude, longtitude);[m
[32m+[m[32m                    converter.from(CoordinateConverter.CoordType.GPS);[m
[32m+[m[32m                    converter.coord(latdimacal);[m
[32m+[m[32m                    bdLng = converter.convert();[m
[32m+[m[32m                }[m
[32m+[m[32m                break;[m
[32m+[m[32m            case LatStyle.BAIDUMAPSTYELE://bd[m
[32m+[m[32m                if (datastyle == LatStyle.DEGREE) {[m
[32m+[m[32m                    return lat;[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    ConvertLatlng convertLatlng = new ConvertLatlng();[m
[32m+[m[32m                    double latitude = convertLatlng.convertToDecimalByString(String.valueOf(lat.latitude));[m
[32m+[m[32m                    double longtitude = convertLatlng.convertToDecimalByString(String.valueOf(lat.longitude));[m
[32m+[m[32m                    bdLng = new LatLng(latitude, longtitude);[m
[32m+[m[32m                }[m
[32m+[m[32m                break;[m
[32m+[m[32m            case LatStyle.OTHERS://[m
[32m+[m[32m                if (datastyle == LatStyle.DEGREE) {[m
[32m+[m[32m                    converter.from(CoordinateConverter.CoordType.COMMON);[m
[32m+[m[32m                    converter.coord(lat);[m
[32m+[m[32m                    bdLng = converter.convert();[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    converter.from(CoordinateConverter.CoordType.COMMON);[m
[32m+[m[32m                    ConvertLatlng convertLatlng = new ConvertLatlng();[m
[32m+[m[32m                    double latitude = convertLatlng.convertToDecimalByString(String.valueOf(lat.latitude));[m
[32m+[m[32m                    double longtitude = convertLatlng.convertToDecimalByString(String.valueOf(lat.longitude));[m
[32m+[m[32m                    LatLng latdimacal = new LatLng(latitude, longtitude);[m
[32m+[m[32m                    converter.coord(latdimacal);[m
[32m+[m[32m                    bdLng = converter.convert();[m
[32m+[m[32m                }[m
[32m+[m[32m                break;[m
[32m+[m[32m        }[m
[32m+[m[32m        return bdLng;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private final int INTENT_MARKER = 1;[m
[32m+[m[32m    private final int DIALOG_MARKER = 2;[m
[32m+[m[32m    private final String MAKER_STYLE = "marker_style";[m
[32m+[m
[32m+[m[32m    private void addMark(LatLng bdlat, LatLng orlat, int markerstyle) {[m
[32m+[m[32m        Bundle bundle = new Bundle();[m
[32m+[m[32m        bundle.putInt(MAKER_STYLE, markerstyle);[m
[32m+[m[32m        bundle.putDouble("latitude", orlat.latitude);[m
[32m+[m[32m        bundle.putDouble("longitude", orlat.longitude);[m
[32m+[m[32m        OverlayOptions options2 = new MarkerOptions().position(bdlat).icon(bitmaplocation).extraInfo(bundle);[m
[32m+[m[32m        mBaiduMap.addOverlay(options2);[m
[32m+[m[32m        setMapCenter(bdlat.latitude, bdlat.longitude);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void showpopupwindows(final MyItem item) {[m
[32m+[m[32m        LayoutInflater inflater = getLayoutInflater();[m
[32m+[m[32m        android.support.v7.widget.CardView card;[m
[32m+[m[32m        TextView lat;[m
[32m+[m[32m        TextView lng;[m
[32m+[m[32m        TextView name;[m
[32m+[m[32m        ImageView iv;[m
[32m+[m[32m        View view = inflater.inflate(R.layout.popupwindow, null);[m
[32m+[m[32m        final PopupWindow popupWindow = new PopupWindow(view, ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT, true);[m
[32m+[m[32m        name = (TextView) view.findViewById(R.id.tv_name);[m
[32m+[m[32m        lat = (TextView) view.findViewById(R.id.tv_lat);[m
[32m+[m[32m        lng = (TextView) view.findViewById(R.id.tv_lng);[m
[32m+[m[32m        card = (CardView) view.findViewById(R.id.card_popup);[m
[32m+[m[32m        iv = (ImageView) view.findViewById(R.id.iv_goto);[m
[32m+[m[32m        name.setText(item.getDataItem().getName());[m
[32m+[m[32m        DecimalFormat df = new DecimalFormat("#.0000000");[m
[32m+[m[32m        lat.setText(String.valueOf(df.format(item.getDataItem().getLatLng().latitude)));[m
[32m+[m[32m        lng.setText(String.valueOf(df.format(item.getDataItem().getLatLng().longitude)));[m
[32m+[m[32m        card.setOnKeyListener(new View.OnKeyListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public boolean onKey(View view, int i, KeyEvent keyEvent) {[m
[32m+[m[32m                if (keyEvent.getAction() == KeyEvent.ACTION_DOWN && i == KeyEvent.KEYCODE_BACK)[m
[32m+[m[32m                    popupWindow.dismiss();[m
[32m+[m[32m                return false;[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        iv.setOnClickListener(new View.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(View v) {[m
[32m+[m[32m                startnavi(item.getPosition());[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        popupWindow.setBackgroundDrawable(new ColorDrawable(0x00000000));[m
[32m+[m[32m        popupWindow.setOutsideTouchable(true);[m
[32m+[m[32m        popupWindow.showAsDropDown(zoomControlsView);[m
[32m+[m[32m        popupWindow.setAnimationStyle(R.style.anim_menu_bottombar);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void showpopupwindows(final Marker marker, Bundle bundle) {[m
[32m+[m[32m        LayoutInflater inflater = getLayoutInflater();[m
[32m+[m[32m        android.support.v7.widget.CardView card;[m
[32m+[m[32m        TextView lat;[m
[32m+[m[32m        TextView lng;[m
[32m+[m[32m        TextView name;[m
[32m+[m[32m        ImageView iv;[m
[32m+[m[32m        View view = inflater.inflate(R.layout.popupwindow, null);[m
[32m+[m[32m        final PopupWindow popupWindow = new PopupWindow(view, ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.WRAP_CONTENT, true);[m
[32m+[m[32m        name = (TextView) view.findViewById(R.id.tv_name);[m
[32m+[m[32m        lat = (TextView) view.findViewById(R.id.tv_lat);[m
[32m+[m[32m        lng = (TextView) view.findViewById(R.id.tv_lng);[m
[32m+[m[32m        card = (CardView) view.findViewById(R.id.card_popup);[m
[32m+[m[32m        iv = (ImageView) view.findViewById(R.id.iv_goto);[m
[32m+[m[32m        if (bundle.getInt(MAKER_STYLE) == INTENT_MARKER) {[m
[32m+[m[32m            name.setText(bundle.getString("name"));[m
[32m+[m[32m        }[m
[32m+[m[32m        DecimalFormat df = new DecimalFormat("#.0000000");[m
[32m+[m[32m        lat.setText(String.valueOf(df.format(bundle.getDouble("latitude"))));[m
[32m+[m[32m        lng.setText(String.valueOf(df.format(bundle.getDouble("longitude"))));[m
[32m+[m[32m        card.setOnKeyListener(new View.OnKeyListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public boolean onKey(View view, int i, KeyEvent keyEvent) {[m
[32m+[m[32m                if (keyEvent.getAction() == KeyEvent.ACTION_DOWN && i == KeyEvent.KEYCODE_BACK)[m
[32m+[m[32m                    popupWindow.dismiss();[m
[32m+[m[32m                return false;[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        iv.setOnClickListener(new View.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(View v) {[m
[32m+[m[32m                startnavi(marker.getPosition());[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        popupWindow.setBackgroundDrawable(new ColorDrawable(0x00000000));[m
[32m+[m[32m        popupWindow.setOutsideTouchable(true);[m
[32m+[m[32m        popupWindow.showAsDropDown(zoomControlsView);[m
[32m+[m[32m        popupWindow.setAnimationStyle(R.style.anim_menu_bottombar);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void PopupWindowmark(Marker marker) {[m
[32m+[m[32m        Bundle bundle = new Bundle();[m
[32m+[m[32m        bundle = marker.getExtraInfo();[m
[32m+[m[32m        if (bundle != null) {[m
[32m+[m
[32m+[m[32m            showpopupwindows(marker, bundle);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void ShowDialog() {[m
[32m+[m[32m        Spinner spinner;[m
[32m+[m[32m        datastyle = LatStyle.DEGREE;[m
[32m+[m[32m        final EditText edtLatitude;[m
[32m+[m[32m        final EditText edtLongtitude;[m
[32m+[m[32m        RadioGroup radioGroup;[m
[32m+[m[32m        final RadioButton radiobtnDecimal;[m
[32m+[m[32m        LayoutInflater inflater = getLayoutInflater();[m
[32m+[m[32m        View dialogView = inflater.inflate(R.layout.dialog_data, null);[m
[32m+[m[32m        AlertDialog.Builder buildersearch = new AlertDialog.Builder(MainActivity.this);[m
[32m+[m[32m        buildersearch.setView(dialogView);[m
[32m+[m[32m        spinner = (Spinner) dialogView.findViewById(R.id.spn_cds);[m
[32m+[m[32m        edtLatitude = (EditText) dialogView.findViewById(R.id.edt_latitude);[m
[32m+[m[32m        edtLongtitude = (EditText) dialogView.findViewById(R.id.edt_longtitude);[m
[32m+[m[32m        radiobtnDecimal = (RadioButton) dialogView.findViewById(R.id.radio_decimal);[m
[32m+[m[32m        radioGroup = (RadioGroup) dialogView.findViewById(R.id.radgroup);[m
[32m+[m[32m        radioGroup.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onCheckedChanged(RadioGroup radioGroup, int i) {[m
[32m+[m[32m                if (i == radiobtnDecimal.getId()) {[m
[32m+[m[32m                    datastyle = LatStyle.DEGREE;[m
[32m+[m[32m                    edtLatitude.setHint("39.9631757745");[m
[32m+[m[32m                    edtLongtitude.setHint("116.4002442204");[m
[32m+[m[32m                } else {[m
[32m+[m[32m                    datastyle = LatStyle.DMS;[m
[32m+[m[32m                    edtLatitude.setHint("30.3452458");[m
[32m+[m[32m                    edtLongtitude.setHint("120.1428354");[m
[32m+[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onItemSelected(AdapterView parent, View view,[m
[32m+[m[32m                                       int position, long id) {[m
[32m+[m[32m                coordstyle = position;[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onNothingSelected(AdapterView parent) {[m
[32m+[m[32m// TODO Auto-generated method stub[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        buildersearch.setTitle("经纬度查询");[m
[32m+[m[32m        buildersearch.setPositiveButton("查看", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialogInterface, int i) {[m
[32m+[m[32m                if (edtLatitude.getText().toString().isEmpty() != true && edtLongtitude.getText().toString().isEmpty() != true) {[m
[32m+[m[32m                    LatLng point = new LatLng(Double.parseDouble(edtLatitude.getText().toString()), Double.parseDouble(edtLongtitude.getText().toString()));[m
[32m+[m[32m                    Log.d("showss", String.valueOf(point.latitude));[m
[32m+[m[32m                    Log.d("showss", String.valueOf(point.longitude));[m
[32m+[m[32m                    LatLng bd = ComanLngConvertBdLngt(point, coordstyle, datastyle);[m
[32m+[m[32m                    addMark(bd, point, DIALOG_MARKER);[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        buildersearch.setNegativeButton("取消", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialogInterface, int i) {[m
[32m+[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        buildersearch.create().show();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private String address;[m
[32m+[m
[32m+[m[32m    private void getaddress(LatLng bdlat) {[m
[32m+[m[32m        address = "";[m
[32m+[m[32m        Log.d("address", "sfsa");[m
[32m+[m[32m        GeoCoder geoCoder = GeoCoder.newInstance();[m
[32m+[m[32m        //[m
[32m+[m[32m        OnGetGeoCoderResultListener listener = new OnGetGeoCoderResultListener() {[m
[32m+[m[32m            // 反地理编码查询结果回调函数[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onGetReverseGeoCodeResult(ReverseGeoCodeResult result) {[m
[32m+[m[32m                if (result == null[m
[32m+[m[32m                        || result.error != SearchResult.ERRORNO.NO_ERROR) {[m
[32m+[m[32m                    // 没有检测到结果[m
[32m+[m[32m                    Toast.makeText(MainActivity.this, "抱歉，未能找到结果",[m
[32m+[m[32m                            Toast.LENGTH_LONG).show();[m
[32m+[m[32m                }[m
[32m+[m[32m                Toast.makeText(getApplicationContext(),[m
[32m+[m[32m                        "位置：" + result.getAddress(), Toast.LENGTH_LONG)[m
[32m+[m[32m                        .show();[m
[32m+[m[32m                address = result.getAddress();[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            // 地理编码查询结果回调函数[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onGetGeoCodeResult(GeoCodeResult result) {[m
[32m+[m[32m                if (result == null[m
[32m+[m[32m                        || result.error != SearchResult.ERRORNO.NO_ERROR) {[m
[32m+[m[32m                    // 没有检测到结果[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        };[m
[32m+[m[32m        // 设置地理编码检索监听者[m
[32m+[m[32m        geoCoder.setOnGetGeoCodeResultListener(listener);[m
[32m+[m[32m        //[m
[32m+[m[32m        geoCoder.reverseGeoCode(new ReverseGeoCodeOption().location(bdlat));[m
[32m+[m[32m        Log.d("address", address);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    // 调起百度地图导航[m
[32m+[m[32m    private void startnavi(LatLng latLng) {[m
[32m+[m[32m        LatLng latLng1 = new LatLng(latitude, lontitude);[m
[32m+[m[32m        NaviParaOption para = new NaviParaOption()[m
[32m+[m[32m                .startPoint(latLng1).endPoint(latLng);[m
[32m+[m[32m        try {[m
[32m+[m[32m            BaiduMapNavigation.setSupportWebNavi(true);[m
[32m+[m[32m            BaiduMapNavigation.openBaiduMapNavi(para, this);[m
[32m+[m[32m        } catch (BaiduMapAppNotSupportNaviException e) {[m
[32m+[m[32m            e.printStackTrace();[m
[32m+[m[32m            showDialog();[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void showDialog() {[m
[32m+[m[32m        android.app.AlertDialog.Builder builder = new android.app.AlertDialog.Builder(this);[m
[32m+[m[32m        builder.setMessage("您尚未安装百度地图app或app版本过低，点击确认安装？");[m
[32m+[m[32m        builder.setTitle("提示");[m
[32m+[m[32m        builder.setPositiveButton("确认", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialog, int which) {[m
[32m+[m[32m                dialog.dismiss();[m
[32m+[m[32m                OpenClientUtil.getLatestBaiduMapApp(MainActivity.this);[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m
[32m+[m[32m        builder.setNegativeButton("取消", new DialogInterface.OnClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onClick(DialogInterface dialog, int which) {[m
[32m+[m[32m                dialog.dismiss();[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m
[32m+[m[32m        builder.create().show();[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Activity/data.java b/app/src/main/java/com/fanweilin/coordinatemap/Activity/data.java[m
[1mnew file mode 100644[m
[1mindex 0000000..06b9b98[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Activity/data.java[m
[36m@@ -0,0 +1,38 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Activity;[m
[32m+[m
[32m+[m[32mimport android.app.Application;[m
[32m+[m[32mimport android.database.sqlite.SQLiteDatabase;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.greendao.DaoMaster;[m
[32m+[m[32mimport com.fanweilin.greendao.DaoSession;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2015/12/24 0024.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class data extends Application {[m
[32m+[m[32m    private SQLiteDatabase db;[m
[32m+[m[32m    private DaoMaster mDaoMaster;[m
[32m+[m[32m    private DaoSession mDaoSession;[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onCreate() {[m
[32m+[m[32m        super.onCreate();[m
[32m+[m[32m        setdata();[m
[32m+[m[32m    }[m
[32m+[m[32m    private void setdata() {[m
[32m+[m[32m        DaoMaster.DevOpenHelper helper = new DaoMaster.DevOpenHelper(this, "files_db", null);[m
[32m+[m[32m        db = helper.getWritableDatabase();[m
[32m+[m[32m        mDaoMaster = new DaoMaster(db);[m
[32m+[m[32m        mDaoSession = mDaoMaster.newSession();[m
[32m+[m[32m    }[m
[32m+[m[32m    public  DaoMaster getmDaoMaster() {[m
[32m+[m[32m        return mDaoMaster;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public DaoSession getmDaoSession() {[m
[32m+[m[32m        return mDaoSession;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public SQLiteDatabase getDb() {[m
[32m+[m[32m        return db;[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Class/FileStyle.java b/app/src/main/java/com/fanweilin/coordinatemap/Class/FileStyle.java[m
[1mnew file mode 100644[m
[1mindex 0000000..fcb2368[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Class/FileStyle.java[m
[36m@@ -0,0 +1,9 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Class;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2016/1/22 0022.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class FileStyle {[m
[32m+[m[32m    public  int CoordStyle;[m
[32m+[m[32m  public   int DataStye;[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/Class/LatStyle.java b/app/src/main/java/com/fanweilin/coordinatemap/Class/LatStyle.java[m
[1mnew file mode 100644[m
[1mindex 0000000..27953c4[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/Class/LatStyle.java[m
[36m@@ -0,0 +1,12 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.Class;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2016/1/22 0022.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class LatStyle {[m
[32m+[m[32m    public static final int GPSSYTELE = 0;//wgs84坐标系[m
[32m+[m[32m    public static final int BAIDUMAPSTYELE = 1;//百度坐标系;[m
[32m+[m[32m    public static final int OTHERS = 2;//其他;[m
[32m+[m[32m    public static final int DEGREE = 1;//小数[m
[32m+[m[32m    public static final int DMS = 2;//度分秒[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/computing/Contast.java b/app/src/main/java/com/fanweilin/coordinatemap/computing/Contast.java[m
[1mnew file mode 100644[m
[1mindex 0000000..7a1b1eb[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/computing/Contast.java[m
[36m@@ -0,0 +1,8 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.computing;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2016/1/2 0002.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class Contast {[m
[32m+[m[32m    public static final String DB_NAME = "file_name";[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/computing/ConvertLatlng.java b/app/src/main/java/com/fanweilin/coordinatemap/computing/ConvertLatlng.java[m
[1mnew file mode 100644[m
[1mindex 0000000..76834f5[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/computing/ConvertLatlng.java[m
[36m@@ -0,0 +1,54 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.computing;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2015/12/29 0029.[m
[32m+[m[32m */[m
[32m+[m
[32m+[m[32mimport java.math.BigDecimal;[m
[32m+[m
[32m+[m[32mpublic class ConvertLatlng {[m
[32m+[m
[32m+[m[32m    //经纬度度分秒转换为小数[m
[32m+[m[32m    public double convertToDecimal(double du, double fen, double miao) {[m
[32m+[m[32m        if (du < 0)[m
[32m+[m[32m            return -(Math.abs(du) + (Math.abs(fen) + (Math.abs(miao) / 60)) / 60);[m
[32m+[m
[32m+[m[32m        return Math.abs(du) + (Math.abs(fen) + (Math.abs(miao) / 60)) / 60;[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    //以字符串形式输入经纬度的转换[m
[32m+[m[32m    public double convertToDecimalByString(String latlng) {[m
[32m+[m[32m          latlng=latlng+"0000";[m
[32m+[m[32m        double du = Double.parseDouble(latlng.substring(0, latlng.indexOf(".")));[m
[32m+[m[32m        double fen = Double.parseDouble(latlng.substring(latlng.indexOf(".") + 1, latlng.indexOf(".") + 3));[m
[32m+[m[32m        double miao = Double.parseDouble(latlng.substring(latlng.indexOf(".") + 3,latlng.indexOf(".") + 5)+"."+latlng.substring(latlng.indexOf(".") + 5));[m
[32m+[m[32m        if (du < 0)[m
[32m+[m[32m            return -(Math.abs(du) + (fen + (miao / 60)) / 60);[m
[32m+[m[32m        return du + (fen + (miao / 60)) / 60;[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m[32m    //将小数转换为度分秒[m
[32m+[m[32m    public String convertToSexagesimal(double num) {[m
[32m+[m
[32m+[m[32m        int du = (int) Math.floor(Math.abs(num));    //获取整数部分[m
[32m+[m[32m        double temp = getdPoint(Math.abs(num)) * 60;[m
[32m+[m[32m        int fen = (int) Math.floor(temp); //获取整数部分[m
[32m+[m[32m        double miao = getdPoint(temp) * 60;[m
[32m+[m[32m        if (num < 0)[m
[32m+[m[32m            return "-" + du + "°" + fen + "′" + miao + "″";[m
[32m+[m
[32m+[m[32m        return du + "°" + fen + "′" + miao + "″";[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    //获取小数部分[m
[32m+[m[32m    public double getdPoint(double num) {[m
[32m+[m[32m        double d = num;[m
[32m+[m[32m        int fInt = (int) d;[m
[32m+[m[32m        BigDecimal b1 = new BigDecimal(Double.toString(d));[m
[32m+[m[32m        BigDecimal b2 = new BigDecimal(Integer.toString(fInt));[m
[32m+[m[32m        double dPoint = b1.subtract(b2).floatValue();[m
[32m+[m[32m        return dPoint;[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/computing/DataItem.java b/app/src/main/java/com/fanweilin/coordinatemap/computing/DataItem.java[m
[1mnew file mode 100644[m
[1mindex 0000000..9dabef6[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/computing/DataItem.java[m
[36m@@ -0,0 +1,27 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.computing;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.model.LatLng;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2016/1/10 0010.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class DataItem {[m
[32m+[m[32m    String name;[m
[32m+[m[32m    LatLng latLng;[m
[32m+[m
[32m+[m[32m    public void setLatLng(LatLng latLng) {[m
[32m+[m[32m        this.latLng = latLng;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setName(String name) {[m
[32m+[m[32m        this.name = name;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public LatLng getLatLng() {[m
[32m+[m[32m        return latLng;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public String getName() {[m
[32m+[m[32m        return name;[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/fragment/CityList_Fragment.java b/app/src/main/java/com/fanweilin/coordinatemap/fragment/CityList_Fragment.java[m
[1mnew file mode 100644[m
[1mindex 0000000..1cd7ff9[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/fragment/CityList_Fragment.java[m
[36m@@ -0,0 +1,258 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.fragment;[m
[32m+[m
[32m+[m[32mimport android.app.Activity;[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.support.v4.app.Fragment;[m
[32m+[m[32mimport android.util.Log;[m
[32m+[m[32mimport android.view.LayoutInflater;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.view.ViewGroup;[m
[32m+[m[32mimport android.widget.AdapterView;[m
[32m+[m[32mimport android.widget.BaseAdapter;[m
[32m+[m[32mimport android.widget.BaseExpandableListAdapter;[m
[32m+[m[32mimport android.widget.Button;[m
[32m+[m[32mimport android.widget.ExpandableListView;[m
[32m+[m[32mimport android.widget.ListView;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m
[32m+[m[32mimport java.io.Serializable;[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m[32mimport java.util.HashMap;[m
[32m+[m[32mimport java.util.List;[m
[32m+[m[32mimport java.util.Map;[m
[32m+[m
[32m+[m[32mpublic class CityList_Fragment extends Fragment {[m
[32m+[m[32m    private ExpandableListView mExlistVIEW;[m
[32m+[m[32m    private List<String> City = null;[m
[32m+[m[32m    private Map<String, List<String>> AllCity = null;[m
[32m+[m[32m    private List<String> HotCity = null;[m
[32m+[m[32m    private ListView mListView;[m
[32m+[m
[32m+[m[32m    OnHeadlineSelectedListener mCallback;[m
[32m+[m
[32m+[m[32m    // Container Activity must implement this interface[m
[32m+[m[32m    public interface OnHeadlineSelectedListener {[m
[32m+[m[32m        void onArticleSelected(String cityid);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onAttach(Activity activity) {[m
[32m+[m[32m        super.onAttach(activity);[m
[32m+[m
[32m+[m[32m        // This makes sure that the container activity has implemented[m
[32m+[m[32m        // the callback interface. If not, it throws an exception[m
[32m+[m[32m        try {[m
[32m+[m[32m            mCallback = (OnHeadlineSelectedListener) activity;[m
[32m+[m[32m        } catch (ClassCastException e) {[m
[32m+[m[32m            throw new ClassCastException(activity.toString()[m
[32m+[m[32m                    + " must implement OnHeadlineSelectedListener");[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public View onCreateView(LayoutInflater inflater, ViewGroup container,[m
[32m+[m[32m                             Bundle savedInstanceState) {[m
[32m+[m[32m        // Inflate the layout for this fragment[m
[32m+[m[32m        View view = inflater.inflate(R.layout.fragment_city_list, container, false);[m
[32m+[m[32m        CityExAdapter myadpter = new CityExAdapter(getActivity());[m
[32m+[m[32m        HotCityAdapter hotCityAdapter = new HotCityAdapter(getActivity());[m
[32m+[m[32m        mListView = (ListView) view.findViewById(R.id.lv_hotcity);[m
[32m+[m[32m        mExlistVIEW = (ExpandableListView) view.findViewById(R.id.el_city);[m
[32m+[m[32m        mListView.setAdapter(hotCityAdapter);[m
[32m+[m[32m        mExlistVIEW.setAdapter(myadpter);[m
[32m+[m[32m        mListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {[m
[32m+[m[32m                String city = HotCity.get(position);[m
[32m+[m[32m                String cityid = (String) getcity(city).get("cityid");[m
[32m+[m[32m                mCallback.onArticleSelected(cityid);[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        mExlistVIEW.setOnChildClickListener(new ExpandableListView.OnChildClickListener() {[m
[32m+[m[32m            @Override[m
[32m+[m[32m            public boolean onChildClick(ExpandableListView parent, View v, int groupPosition, int childPosition, long id) {[m
[32m+[m[32m                String city = AllCity.get(City.get(groupPosition)).get(childPosition);[m
[32m+[m[32m                String cityid= (String) getcity(city).get("cityid");[m
[32m+[m[32m                mCallback.onArticleSelected(cityid);[m
[32m+[m[32m                return false;[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m[32m        return view;[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        Bundle bundle = getArguments();[m
[32m+[m[32m        if (bundle != null) {[m
[32m+[m[32m            HotCity = new ArrayList<String>();[m
[32m+[m[32m            City = new ArrayList<String>();[m
[32m+[m[32m            AllCity = new HashMap<String, List<String>>();[m
[32m+[m[32m            City = bundle.getStringArrayList("city");[m
[32m+[m[32m            SerializableMap serializableMap = (SerializableMap) bundle.get("map");[m
[32m+[m[32m            AllCity = serializableMap.getMap();[m
[32m+[m[32m            HotCity = bundle.getStringArrayList("hotcity");[m
[32m+[m[32m            for (int i = 0; i < HotCity.size(); i++) {[m
[32m+[m[32m                Log.d("CY", HotCity.get(i));[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public static CityList_Fragment newInstance(List<String> citylist, Map<String, List<String>> childcitylist, List<String> hotcity) {[m
[32m+[m[32m        CityList_Fragment f = new CityList_Fragment();[m
[32m+[m[32m        Bundle args = new Bundle();[m
[32m+[m[32m        args.putStringArrayList("hotcity", (ArrayList<String>) hotcity);[m
[32m+[m[32m        args.putStringArrayList("city", (ArrayList<String>) citylist);[m
[32m+[m[32m        final SerializableMap map = new SerializableMap();[m
[32m+[m[32m        map.setMap(childcitylist);[m
[32m+[m[32m        args.putSerializable("map", map);[m
[32m+[m[32m        f.setArguments(args);[m
[32m+[m[32m        return f;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public static class SerializableMap implements Serializable {[m
[32m+[m
[32m+[m[32m        private Map<String, List<String>> map;[m
[32m+[m
[32m+[m[32m        public Map<String, List<String>> getMap() {[m
[32m+[m[32m            return map;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        public void setMap(Map<String, List<String>> map) {[m
[32m+[m[32m            this.map = map;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class HotCityAdapter extends BaseAdapter {[m
[32m+[m[32m        LayoutInflater inflater;[m
[32m+[m[32m        String cityid;[m
[32m+[m
[32m+[m[32m        HotCityAdapter(Context context) {[m
[32m+[m[32m            inflater = LayoutInflater.from(context);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getCount() {[m
[32m+[m[32m            return HotCity.size();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Object getItem(int position) {[m
[32m+[m[32m            return HotCity.get(position);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public long getItemId(int position) {[m
[32m+[m[32m            return position;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public View getView(int position, View convertView, ViewGroup parent) {[m
[32m+[m[32m            if (convertView == null) {[m
[32m+[m[32m                convertView = inflater.inflate(R.layout.list_child, null);[m
[32m+[m[32m            }[m
[32m+[m[32m            Button btndown = (Button) convertView.findViewById(R.id.btn_down);[m
[32m+[m[32m            TextView tvchild = (TextView) convertView.findViewById(R.id.tv_childcity);[m
[32m+[m[32m            TextView tvsize = (TextView) convertView.findViewById(R.id.tv_size);[m
[32m+[m[32m           String city = HotCity.get(position);[m
[32m+[m[32m            Map<String, Object> map = new HashMap<String, Object>();[m
[32m+[m[32m            map = getcity(city);[m
[32m+[m[32m            tvchild.setText((String) map.get("cityname"));[m
[32m+[m[32m            tvsize.setText((String) map.get("citysize"));[m
[32m+[m[32m            cityid = (String) map.get("cityid");[m
[32m+[m[32m            Log.d("cityidhot", (String) map.get("cityid"));[m
[32m+[m[32m            return convertView;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class CityExAdapter extends BaseExpandableListAdapter {[m
[32m+[m[32m        LayoutInflater inflater;[m
[32m+[m[32m        String cityid;[m
[32m+[m
[32m+[m[32m        CityExAdapter(Context context) {[m
[32m+[m[32m            inflater = LayoutInflater.from(context);[m
[32m+[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getGroupCount() {[m
[32m+[m[32m            return City.size();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getChildrenCount(int groupPosition) {[m
[32m+[m[32m            Log.d("CITY", City.get(groupPosition));[m
[32m+[m[32m            return AllCity.get(City.get(groupPosition)).size();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Object getGroup(int groupPosition) {[m
[32m+[m[32m            return City.get(groupPosition);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Object getChild(int groupPosition, int childPosition) {[m
[32m+[m[32m            return AllCity.get(City.get(groupPosition)).get(childPosition);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public long getGroupId(int groupPosition) {[m
[32m+[m[32m            return groupPosition;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public long getChildId(int groupPosition, int childPosition) {[m
[32m+[m[32m            return childPosition;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean hasStableIds() {[m
[32m+[m[32m            return true;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) {[m
[32m+[m[32m            if (convertView == null) {[m
[32m+[m[32m                convertView = inflater.inflate(R.layout.list_parent, null);[m
[32m+[m[32m            }[m
[32m+[m[32m            TextView tv = (TextView) convertView[m
[32m+[m[32m                    .findViewById(R.id.tv_city);[m
[32m+[m[32m            tv.setText(City.get(groupPosition));[m
[32m+[m[32m            return convertView;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) {[m
[32m+[m[32m            if (convertView == null) {[m
[32m+[m[32m                convertView = inflater.inflate(R.layout.list_child, null);[m
[32m+[m[32m            }[m
[32m+[m[32m            Button btndown = (Button) convertView.findViewById(R.id.btn_down);[m
[32m+[m[32m            TextView tvchild = (TextView) convertView.findViewById(R.id.tv_childcity);[m
[32m+[m[32m            TextView tvsize = (TextView) convertView.findViewById(R.id.tv_size);[m
[32m+[m[32m            String city = AllCity.get(City.get(groupPosition)).get(childPosition);[m
[32m+[m[32m            tvchild.setText((String) getcity(city).get("cityname"));[m
[32m+[m[32m            tvsize.setText((String) getcity(city).get("citysize"));[m
[32m+[m[32m            return convertView;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public boolean isChildSelectable(int groupPosition, int childPosition) {[m
[32m+[m[32m            return true;[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public Map<String, Object> getcity(String string) {[m
[32m+[m[32m        String[] city;[m
[32m+[m[32m        Map<String, Object> map = new HashMap<String, Object>();[m
[32m+[m[32m        city = string.split(",");[m
[32m+[m[32m        map.put("cityname", city[0]);[m
[32m+[m[32m        map.put("cityid", city[1]);[m
[32m+[m[32m        map.put("citysize", city[2]);[m
[32m+[m[32m        return map;[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/fragment/DownFragment.java b/app/src/main/java/com/fanweilin/coordinatemap/fragment/DownFragment.java[m
[1mnew file mode 100644[m
[1mindex 0000000..d799b1d[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/fragment/DownFragment.java[m
[36m@@ -0,0 +1,126 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.fragment;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.content.Intent;[m
[32m+[m[32mimport android.os.Bundle;[m
[32m+[m[32mimport android.support.v4.app.Fragment;[m
[32m+[m[32mimport android.view.LayoutInflater;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.view.ViewGroup;[m
[32m+[m[32mimport android.widget.BaseAdapter;[m
[32m+[m[32mimport android.widget.Button;[m
[32m+[m[32mimport android.widget.ListView;[m
[32m+[m[32mimport android.widget.TextView;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.map.offline.MKOLUpdateElement;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.Activity.Bdoffilin_activity;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.Activity.MainActivity;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m
[32m+[m[32mimport java.util.ArrayList;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2016/1/19 0019.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class DownFragment extends Fragment {[m
[32m+[m[32m    private ArrayList<MKOLUpdateElement> localMapList = null;[m
[32m+[m[32m    private LocalMapAdapter lAdapter = null;[m
[32m+[m[32m    Bdoffilin_activity bd;[m
[32m+[m[32m        private TextView stateView;[m
[32m+[m[32m    public View onCreateView(LayoutInflater inflater, ViewGroup container,[m
[32m+[m[32m                             Bundle savedInstanceState) {[m
[32m+[m[32m        View view = inflater.inflate(R.layout.frament_down, container, false);[m
[32m+[m[32m        ListView localMapListView = (ListView) view.findViewById(R.id.localmaplist);[m
[32m+[m[32m        stateView= (TextView) view.findViewById(R.id.state);[m
[32m+[m[32m        lAdapter = new LocalMapAdapter(getActivity());[m
[32m+[m[32m        localMapListView.setAdapter(lAdapter);[m
[32m+[m[32m        return view;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onCreate(Bundle savedInstanceState) {[m
[32m+[m[32m        super.onCreate(savedInstanceState);[m
[32m+[m[32m        bd=( Bdoffilin_activity)getActivity();[m
[32m+[m[32m         localMapList=bd.localMapList;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public class LocalMapAdapter extends BaseAdapter {[m
[32m+[m[32m        LayoutInflater inflater;[m
[32m+[m
[32m+[m[32m        LocalMapAdapter(Context context) {[m
[32m+[m[32m            inflater = LayoutInflater.from(context);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public int getCount() {[m
[32m+[m[32m            return localMapList.size();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public Object getItem(int index) {[m
[32m+[m[32m            return localMapList.get(index);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public long getItemId(int index) {[m
[32m+[m[32m            return index;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        @Override[m
[32m+[m[32m        public View getView(int index, View view, ViewGroup arg2) {[m
[32m+[m[32m            MKOLUpdateElement e = (MKOLUpdateElement) getItem(index);[m
[32m+[m[32m            view = inflater.inflate(R.layout.offline_localmap_list, null);[m
[32m+[m[32m            initViewItem(view, e);[m
[32m+[m[32m            return view;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        void initViewItem(View view, final MKOLUpdateElement e) {[m
[32m+[m[32m            Button display = (Button) view.findViewById(R.id.display);[m
[32m+[m[32m            Button remove = (Button) view.findViewById(R.id.remove);[m
[32m+[m[32m            TextView title = (TextView) view.findViewById(R.id.title);[m
[32m+[m[32m            TextView update = (TextView) view.findViewById(R.id.update);[m
[32m+[m[32m            TextView ratio = (TextView) view.findViewById(R.id.ratio);[m
[32m+[m[32m            ratio.setText(e.ratio + "%");[m
[32m+[m[32m            title.setText(e.cityName);[m
[32m+[m[32m            if (e.update) {[m
[32m+[m[32m                update.setText("可更新");[m
[32m+[m[32m            } else {[m
[32m+[m[32m                update.setText("最新");[m
[32m+[m[32m            }[m
[32m+[m[32m            if (e.ratio != 100) {[m
[32m+[m[32m                display.setEnabled(false);[m
[32m+[m[32m            } else {[m
[32m+[m[32m                display.setEnabled(true);[m
[32m+[m[32m            }[m
[32m+[m[32m            remove.setOnClickListener(new View.OnClickListener() {[m
[32m+[m[32m                @Override[m
[32m+[m[32m                public void onClick(View arg0) {[m
[32m+[m[32m                    bd.mOffline.remove(e.cityID);[m
[32m+[m[32m                    updateView();[m
[32m+[m[32m                }[m
[32m+[m[32m            });[m
[32m+[m[32m            display.setOnClickListener(new View.OnClickListener() {[m
[32m+[m[32m                @Override[m
[32m+[m[32m                public void onClick(View v) {[m
[32m+[m[32m                    Intent intent = new Intent();[m
[32m+[m[32m                    intent.putExtra("x", e.geoPt.longitude);[m
[32m+[m[32m                    intent.putExtra("y", e.geoPt.latitude);[m
[32m+[m[32m                    intent.setClass(getActivity(), MainActivity.class);[m
[32m+[m[32m                    startActivity(intent);[m
[32m+[m[32m                }[m
[32m+[m[32m            });[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m[32m//[m
[32m+[m[32m    public void updateView() {[m
[32m+[m[32m        localMapList = bd.mOffline.getAllUpdateInfo();[m
[32m+[m[32m        if (localMapList == null) {[m
[32m+[m[32m            localMapList = new ArrayList<MKOLUpdateElement>();[m
[32m+[m[32m        }[m
[32m+[m[32m        lAdapter.notifyDataSetChanged();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/widget/CheckableRelativeLayout.java b/app/src/main/java/com/fanweilin/coordinatemap/widget/CheckableRelativeLayout.java[m
[1mnew file mode 100644[m
[1mindex 0000000..1957688[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/widget/CheckableRelativeLayout.java[m
[36m@@ -0,0 +1,42 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.widget;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.util.AttributeSet;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.widget.Checkable;[m
[32m+[m[32mimport android.widget.RelativeLayout;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2016/1/1 0001.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class CheckableRelativeLayout extends RelativeLayout implements Checkable {[m
[32m+[m[32m    public CheckableRelativeLayout(Context context, AttributeSet attrs) {[m
[32m+[m[32m        super(context, attrs);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private boolean mChecked = false;[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void toggle() {[m
[32m+[m[32m        setChecked(!mChecked);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public boolean isChecked() {[m
[32m+[m[32m        return mChecked;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void setChecked(boolean checked) {[m
[32m+[m[32m        if (mChecked != checked) {[m
[32m+[m[32m            mChecked = checked;[m
[32m+[m[32m            refreshDrawableState();[m
[32m+[m[32m            for (int i = 0, len = getChildCount(); i < len; i++) {[m
[32m+[m[32m                View child = getChildAt(i);[m
[32m+[m[32m                if(child instanceof Checkable){[m
[32m+[m[32m                    ((Checkable) child).setChecked(checked);[m
[32m+[m[32m                }[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/app/src/main/java/com/fanweilin/coordinatemap/widget/ZoomControlsView.java b/app/src/main/java/com/fanweilin/coordinatemap/widget/ZoomControlsView.java[m
[1mnew file mode 100644[m
[1mindex 0000000..ab0421b[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/java/com/fanweilin/coordinatemap/widget/ZoomControlsView.java[m
[36m@@ -0,0 +1,90 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap.widget;[m
[32m+[m
[32m+[m[32mimport android.content.Context;[m
[32m+[m[32mimport android.util.AttributeSet;[m
[32m+[m[32mimport android.view.LayoutInflater;[m
[32m+[m[32mimport android.view.View;[m
[32m+[m[32mimport android.widget.ImageButton;[m
[32m+[m[32mimport android.widget.RelativeLayout;[m
[32m+[m
[32m+[m[32mimport com.baidu.mapapi.map.BaiduMap;[m
[32m+[m[32mimport com.baidu.mapapi.map.MapStatus;[m
[32m+[m[32mimport com.baidu.mapapi.map.MapStatusUpdateFactory;[m
[32m+[m[32mimport com.baidu.mapapi.map.MapView;[m
[32m+[m[32mimport com.fanweilin.coordinatemap.R;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * Created by Administrator on 2015/12/27 0027.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class ZoomControlsView extends RelativeLayout implements View.OnClickListener {[m
[32m+[m[32m    private MapView mapView;[m
[32m+[m[32m    private MapStatus mapStatus;[m
[32m+[m[32m    private BaiduMap baiduMap;[m
[32m+[m[32m    private ImageButton zoomIn;[m
[32m+[m[32m    private ImageButton zoomOut;[m
[32m+[m[32m    private float maxZoomLevel;[m
[32m+[m[32m    private float minZoomLevel;[m
[32m+[m
[32m+[m[32m    public ZoomControlsView(Context context, AttributeSet attrs) {[m
[32m+[m[32m        super(context, attrs, 0);[m
[32m+[m[32m        init();[m
[32m+[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m
[32m+[m[32m    public ZoomControlsView(Context context, AttributeSet attrs, int defStyleAttr) {[m
[32m+[m[32m        super(context, attrs, defStyleAttr);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void init() {[m
[32m+[m[32m        LayoutInflater inflater = LayoutInflater.from(getContext());[m
[32m+[m[32m        RelativeLayout view = (RelativeLayout) inflater.inflate(R.layout.zoom_controls, null);[m
[32m+[m[32m        zoomIn = (ImageButton) view.findViewById(R.id.btn_zoom_in);[m
[32m+[m[32m        zoomOut = (ImageButton) view.findViewById(R.id.btn_zoom_out);[m
[32m+[m[32m        zoomIn.setOnClickListener(this);[m
[32m+[m[32m        zoomOut.setOnClickListener(this);[m
[32m+[m[32m        addView(view);[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    public void setBaiduMap(MapView mapView) {[m
[32m+[m[32m        if (mapView != null) {[m
[32m+[m[32m            this.mapView = mapView;[m
[32m+[m[32m            baiduMap = mapView.getMap();[m
[32m+[m[32m            mapStatus = baiduMap.getMapStatus();[m
[32m+[m[32m            maxZoomLevel = baiduMap.getMaxZoomLevel();[m
[32m+[m[32m            minZoomLevel = baiduMap.getMinZoomLevel();[m
[32m+[m[32m        } else {[m
[32m+[m[32m            throw new NullPointerException("you should call setMapView(MapView mapView) at first");[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    @Override[m
[32m+[m[32m    public void onClick(View view) {[m
[32m+[m[32m        mapStatus = baiduMap.getMapStatus();[m
[32m+[m[32m        switch (view.getId()) {[m
[32m+[m[32m            case R.id.btn_zoom_in:[m
[32m+[m[32m                baiduMap.animateMapStatus(MapStatusUpdateFactory.zoomIn());[m
[32m+[m[32m                break;[m
[32m+[m[32m            case R.id.btn_zoom_out:[m
[32m+[m[32m                baiduMap.animateMapStatus(MapStatusUpdateFactory.zoomOut());[m
[32m+[m[32m                break;[m
[32m+[m[32m        }[m
[32m+[m[32m        mapStatus = mapView.getMap().getMapStatus();[m
[32m+[m[32m        controlZoomShow();[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private void controlZoomShow() {[m
[32m+[m[32m        float zoom = baiduMap.getMapStatus().zoom;[m
[32m+[m[32m        if (zoom >= maxZoomLevel) {[m
[32m+[m[32m            zoomIn.setEnabled(false);[m
[32m+[m[32m        } else {[m
[32m+[m[32m            zoomIn.setEnabled(true);[m
[32m+[m[32m        }[m
[32m+[m[32m        if (zoom <= minZoomLevel) {[m
[32m+[m[32m            zoomOut.setEnabled(false);[m
[32m+[m[32m        } else {[m
[32m+[m[32m            zoomOut.setEnabled(true);[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[32m+[m
[1mdiff --git a/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_base_v3_6_1.so b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_base_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..8be82a1[m
Binary files /dev/null and b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_base_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_map_v3_6_1.so b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_map_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..05c93fd[m
Binary files /dev/null and b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_map_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_search_v3_6_1.so b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_search_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..d75497c[m
Binary files /dev/null and b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_search_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_util_v3_6_1.so b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_util_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..9d0bb31[m
Binary files /dev/null and b/app/src/main/jniLibs/armeabi-v7a/libBaiduMapSDK_util_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/armeabi-v7a/liblocSDK6a.so b/app/src/main/jniLibs/armeabi-v7a/liblocSDK6a.so[m
[1mnew file mode 100644[m
[1mindex 0000000..56278b2[m
Binary files /dev/null and b/app/src/main/jniLibs/armeabi-v7a/liblocSDK6a.so differ
[1mdiff --git a/app/src/main/jniLibs/x86/libBaiduMapSDK_base_v3_6_1.so b/app/src/main/jniLibs/x86/libBaiduMapSDK_base_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..3215ad9[m
Binary files /dev/null and b/app/src/main/jniLibs/x86/libBaiduMapSDK_base_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/x86/libBaiduMapSDK_map_v3_6_1.so b/app/src/main/jniLibs/x86/libBaiduMapSDK_map_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..59ea7d4[m
Binary files /dev/null and b/app/src/main/jniLibs/x86/libBaiduMapSDK_map_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/x86/libBaiduMapSDK_search_v3_6_1.so b/app/src/main/jniLibs/x86/libBaiduMapSDK_search_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..51bb34b[m
Binary files /dev/null and b/app/src/main/jniLibs/x86/libBaiduMapSDK_search_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/x86/libBaiduMapSDK_util_v3_6_1.so b/app/src/main/jniLibs/x86/libBaiduMapSDK_util_v3_6_1.so[m
[1mnew file mode 100644[m
[1mindex 0000000..aeef840[m
Binary files /dev/null and b/app/src/main/jniLibs/x86/libBaiduMapSDK_util_v3_6_1.so differ
[1mdiff --git a/app/src/main/jniLibs/x86/liblocSDK6a.so b/app/src/main/jniLibs/x86/liblocSDK6a.so[m
[1mnew file mode 100644[m
[1mindex 0000000..2809bc1[m
Binary files /dev/null and b/app/src/main/jniLibs/x86/liblocSDK6a.so differ
[1mdiff --git a/app/src/main/res/anim/menu_bottombar_in.xml b/app/src/main/res/anim/menu_bottombar_in.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..78f37ea[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/anim/menu_bottombar_in.xml[m
[36m@@ -0,0 +1,7 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<set xmlns:android="http://schemas.android.com/apk/res/android" >[m
[32m+[m[32m    <translate[m
[32m+[m[32m        android:duration="250"[m
[32m+[m[32m        android:fromYDelta="100.0%"[m
[32m+[m[32m        android:toYDelta="0.0" />[m
[32m+[m[32m</set>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/anim/menu_bottombar_out.xml b/app/src/main/res/anim/menu_bottombar_out.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..deb8750[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/anim/menu_bottombar_out.xml[m
[36m@@ -0,0 +1,8 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<set xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m[32m    <translate[m
[32m+[m[32m        android:duration="250"[m
[32m+[m[32m        android:fromYDelta="0.0"[m
[32m+[m[32m        android:toYDelta="100%" />[m
[32m+[m[32m</set>[m
[32m+[m[41m  [m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/button_style.xml b/app/src/main/res/drawable/button_style.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..0381182[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/button_style.xml[m
[36m@@ -0,0 +1,7 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<selwarning: LF will be replaced by CRLF in app/src/main/java/com/baidu/mapapi/clusterutil/ui/SquareTextView.java.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/res/drawable/ic_menu_camera.xml.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/res/drawable/ic_menu_gallery.xml.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/res/drawable/ic_menu_manage.xml.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/res/drawable/ic_menu_send.xml.
The file will have its original line endings in your working directory.
ector xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m
[32m+[m[32m    <item android:drawable="@mipmap/button_down" android:state_pressed="true"/>[m
[32m+[m[32m    <item android:drawable="@mipmap/button_down" android:state_focused="true"/>[m
[32m+[m[32m    <item android:drawable="@mipmap/button_on"/>[m
[32m+[m[32m</selector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/ic_menu_camera.xml b/app/src/main/res/drawable/ic_menu_camera.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..0d9ea10[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/ic_menu_camera.xml[m
[36m@@ -0,0 +1,12 @@[m
[32m+[m[32m<vector xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:width="24dp"[m
[32m+[m[32m    android:height="24dp"[m
[32m+[m[32m    android:viewportHeight="24.0"[m
[32m+[m[32m    android:viewportWidth="24.0">[m
[32m+[m[32m    <path[m
[32m+[m[32m        android:fillColor="#FF000000"[m
[32m+[m[32m        android:pathData="M12,12m-3.2,0a3.2,3.2 0,1 1,6.4 0a3.2,3.2 0,1 1,-6.4 0" />[m
[32m+[m[32m    <path[m
[32m+[m[32m        android:fillColor="#FF000000"[m
[32m+[m[32m        android:pathData="M9,2L7.17,4H4c-1.1,0 -2,0.9 -2,2v12c0,1.1 0.9,2 2,2h16c1.1,0 2,-0.9 2,-2V6c0,-1.1 -0.9,-2 -2,-2h-3.17L15,2H9zm3,15c-2.76,0 -5,-2.24 -5,-5s2.24,-5 5,-5 5,2.24 5,5 -2.24,5 -5,5z" />[m
[32m+[m[32m</vector>[m
[1mdiff --git a/app/src/main/res/drawable/ic_menu_gallery.xml b/app/src/main/res/drawable/ic_menu_gallery.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..f6872c4[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/ic_menu_gallery.xml[m
[36m@@ -0,0 +1,9 @@[m
[32m+[m[32m<vector xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:width="24dp"[m
[32m+[m[32m    android:height="24dp"[m
[32m+[m[32m    android:viewportHeight="24.0"[m
[32m+[m[32m    android:viewportWidth="24.0">[m
[32m+[m[32m    <path[m
[32m+[m[32m        android:fillColor="#FF000000"[m
[32m+[m[32m        android:pathData="M22,16V4c0,-1.1 -0.9,-2 -2,-2H8c-1.1,0 -2,0.9 -2,2v12c0,1.1 0.9,2 2,2h12c1.1,0 2,-0.9 2,-2zm-11,-4l2.03,2.71L16,11l4,5H8l3,-4zM2,6v14c0,1.1 0.9,2 2,2h14v-2H4V6H2z" />[m
[32m+[m[32m</vector>[m
[1mdiff --git a/app/src/main/res/drawable/ic_menu_manage.xml b/app/src/main/res/drawable/ic_menu_manage.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..c1be60b[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/ic_menu_manage.xml[m
[36m@@ -0,0 +1,9 @@[m
[32m+[m[32m<vector xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:width="24dp"[m
[32m+[m[32m    android:height="24dp"[m
[32m+[m[32m    android:viewportHeight="24.0"[m
[32m+[m[32m    android:viewportWidth="24.0">[m
[32m+[m[32m    <path[m
[32m+[m[32m        android:fillColor="#FF000000"[m
[32m+[m[32m        android:pathData="M22.7,19l-9.1,-9.1c0.9,-2.3 0.4,-5 -1.5,-6.9 -2,-2 -5,-2.4 -7.4,-1.3L9,6 6,9 1.6,4.7C0.4,7.1 0.9,10.1 2.9,12.1c1.9,1.9 4.6,2.4 6.9,1.5l9.1,9.1c0.4,0.4 1,0.4 1.4,0l2.3,-2.3c0.5,-0.4 0.5,-1.1 0.1,-1.4z" />[m
[32m+[m[32m</vector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/ic_menu_send.xml b/app/src/main/res/drawable/ic_menu_send.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..00c668c[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/ic_menu_send.xml[m
[36m@@ -0,0 +1,9 @@[m
[32m+[m[32m<vector xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:width="24dp"[m
[32m+[m[32m    android:height="24dp"[m
[32m+[m[32m    android:viewportHeight="24.0"[m
[32m+[m[32m    android:viewportWidth="24.0">[m
[32m+[m[32m    <path[m
[32m+[m[32m        android:fillColor="#FF000000"[m
[32m+[m[32m        android:pathData="M2.01,21L23,12 2.01,3 2,10l15,2 -15,2z" />[m
[32m+[m[32m</vector>[m
[1mdiff --git a/app/src/main/res/drawable/ic_menu_share.xml b/app/src/main/res/drawable/ic_menu_share.xmlwarning: LF will be replaced by CRLF in app/src/main/res/drawable/ic_menu_share.xml.
The file will have its original line endings in your working directory.
warning: LF will be replaced by CRLF in app/src/main/res/drawable/ic_menu_slideshow.xml.
The file will have its original line endings in your working directory.
[m
[1mnew file mode 100644[m
[1mindex 0000000..a28fb9e[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/ic_menu_share.xml[m
[36m@@ -0,0 +1,9 @@[m
[32m+[m[32m<vector xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:width="24dp"[m
[32m+[m[32m    android:height="24dp"[m
[32m+[m[32m    android:viewportHeight="24.0"[m
[32m+[m[32m    android:viewportWidth="24.0">[m
[32m+[m[32m    <path[m
[32m+[m[32m        android:fillColor="#FF000000"[m
[32m+[m[32m        android:pathData="M18,16.08c-0.76,0 -1.44,0.3 -1.96,0.77L8.91,12.7c0.05,-0.23 0.09,-0.46 0.09,-0.7s-0.04,-0.47 -0.09,-0.7l7.05,-4.11c0.54,0.5 1.25,0.81 2.04,0.81 1.66,0 3,-1.34 3,-3s-1.34,-3 -3,-3 -3,1.34 -3,3c0,0.24 0.04,0.47 0.09,0.7L8.04,9.81C7.5,9.31 6.79,9 6,9c-1.66,0 -3,1.34 -3,3s1.34,3 3,3c0.79,0 1.5,-0.31 2.04,-0.81l7.12,4.16c-0.05,0.21 -0.08,0.43 -0.08,0.65 0,1.61 1.31,2.92 2.92,2.92 1.61,0 2.92,-1.31 2.92,-2.92s-1.31,-2.92 -2.92,-2.92z" />[m
[32m+[m[32m</vector>[m
[1mdiff --git a/app/src/main/res/drawable/ic_menu_slideshow.xml b/app/src/main/res/drawable/ic_menu_slideshow.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..209aa64[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/ic_menu_slideshow.xml[m
[36m@@ -0,0 +1,9 @@[m
[32m+[m[32m<vector xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:width="24dp"[m
[32m+[m[32m    android:height="24dp"[m
[32m+[m[32m    android:viewportHeight="24.0"[m
[32m+[m[32m    android:viewportWidth="24.0">[m
[32m+[m[32m    <path[m
[32m+[m[32m        android:fillColor="#FF000000"[m
[32m+[m[32m        android:pathData="M4,6H2v14c0,1.1 0.9,2 2,2h14v-2H4V6zm16,-4H8c-1.1,0 -2,0.9 -2,2v12c0,1.1 0.9,2 2,2h12c1.1,0 2,-0.9 2,-2V4c0,-1.1 -0.9,-2 -2,-2zm-8,12.5v-9l6,4.5 -6,4.5z" />[m
[32m+[m[32m</vector>[m
[1mdiff --git a/app/src/main/res/drawable/imagebutton.xml b/app/src/main/res/drawable/imagebutton.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..81b1265[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/imagebutton.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<selector xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m[32m    <item android:drawable="@color/gray" android:state_pressed="true"></item>[m
[32m+[m[32m    <item android:drawable="@color/gray" android:state_selected="true"></item>[m
[32m+[m[32m    <item android:drawable="@color/windowBackground"></item>[m
[32m+[m[32m</selector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/listitempress.xml b/app/src/main/res/drawable/listitempress.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..c633cad[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/listitempress.xml[m
[36m@@ -0,0 +1,12 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<selector xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m[32m  <item android:drawable="@color/unfocused" android:state_window_focused="false"/>[m
[32m+[m[32m      <!-- 非触摸模式下获得焦点并单击时的背景颜色 -->[m
[32m+[m[32m.    <item android:drawable="@color/pressed" android:state_focused="true" android:state_pressed="true"/>[m
[32m+[m[32m     <!-- 触摸模式下单击时的背景颜色 -->[m
[32m+[m[32m    <item android:drawable="@color/pressed" android:state_focused="false" android:state_pressed="true"/>[m
[32m+[m[32m  <!-- 选中时的背景颜色 -->[m
[32m+[m[32m    <item android:drawable="@color/pressed" android:state_selected="true"/>[m
[32m+[m[32m     <!-- 获得焦点时的背景  颜色 -->[m
[32m+[m[32m   <item android:drawable="@color/pressed" android:state_focused="true"/>[m
[32m+[m[32m</selector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/side_nav_bar.xml b/app/src/main/res/drawable/side_nav_bar.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..458b4b0[m
[1m--- /dev/null[m
[1m+++ warning: LF will be replaced by CRLF in app/src/main/res/drawable/side_nav_bar.xml.
The file will have its original line endings in your working directory.
b/app/src/main/res/drawable/side_nav_bar.xml[m
[36m@@ -0,0 +1,9 @@[m
[32m+[m[32m<shape xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:shape="rectangle">[m
[32m+[m[32m    <gradient[m
[32m+[m[32m        android:angle="135"[m
[32m+[m[32m        android:centerColor="#4CAF50"[m
[32m+[m[32m        android:endColor="#2E7D32"[m
[32m+[m[32m        android:startColor="#81C784"[m
[32m+[m[32m        android:type="linear" />[m
[32m+[m[32m</shape>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/topbar_back.xml b/app/src/main/res/drawable/topbar_back.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..1bf698c[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/topbar_back.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<selector xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m[32m    <item android:drawable="@mipmap/ac1" android:state_pressed="true" />[m
[32m+[m[32m    <item android:drawable="@mipmap/ac1" android:state_selected="true" />[m
[32m+[m[32m    <item android:drawable="@mipmap/ac0" />[m
[32m+[m[32m   </selector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/topbarimg.xml b/app/src/main/res/drawable/topbarimg.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..290862b[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/topbarimg.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<selector xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m[32m    <item android:drawable="@color/colorPrimaryDark" android:state_pressed="true"></item>[m
[32m+[m[32m    <item android:drawable="@color/colorPrimaryDark" android:state_selected="true"></item>[m
[32m+[m[32m    <item android:drawable="@color/topbarimg"></item>[m
[32m+[m[32m</selector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/topbarligtht_back.xml b/app/src/main/res/drawable/topbarligtht_back.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..2487cfd[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/topbarligtht_back.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<selector xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m[32m    <item android:drawable="@mipmap/ac0" android:state_pressed="true" />[m
[32m+[m[32m    <item android:drawable="@mipmap/ac0" android:state_selected="true" />[m
[32m+[m[32m    <item android:drawable="@mipmap/ac1" />[m
[32m+[m[32m</selector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/drawable/zoom_out.xml b/app/src/main/res/drawable/zoom_out.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..81b1265[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/drawable/zoom_out.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<selector xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m[32m    <item android:drawable="@color/gray" android:state_pressed="true"></item>[m
[32m+[m[32m    <item android:drawable="@color/gray" android:state_selected="true"></item>[m
[32m+[m[32m    <item android:drawable="@color/windowBackground"></item>[m
[32m+[m[32m</selector>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/activity_add_file.xml b/app/src/main/res/layout/activity_add_file.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..e401ffb[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_add_file.xml[m
[36m@@ -0,0 +1,46 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:tools="http://schemas.android.com/tools"[m
[32m+[m[32m    xmlns:app="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="vertical"[m
[32m+[m[32m    tools:context=".Activity.AddFileActivity">[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:id="@+id/data_manager_topbar"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/colorPrimary">[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/data_manager_iv_back"[m
[32m+[m[32m            android:layout_width="40dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentLeft="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:onClick="back"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@drawable/topbar_back" />[m
[32m+[m[32m        <android.support.v7.widget.AppCompatButton[m
[32m+[m[32m            android:id="@+id/btn_help"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:gravity="center"[m
[32m+[m[32m            android:text="@string/help"[m
[32m+[m[32m            android:textColor="@color/white"[m
[32m+[m[32m            android:background="@color/topbarimg"[m
[32m+[m[32m            android:layout_marginLeft="16dp"[m
[32m+[m[32m            android:layout_marginRight="16dp"[m
[32m+[m[32m            android:layout_alignParentBottom="true"[m
[32m+[m[32m            android:layout_alignParentTop="true" />[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m[32m    <ListView[m
[32m+[m[32m        android:id="@android:id/list"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"></ListView>[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/activity_bdoffline.xml b/app/src/main/res/layout/activity_bdoffline.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..28ebf99[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_bdoffline.xml[m
[36m@@ -0,0 +1,59 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:id="@+id/data_manager_topbar"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/white">[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/data_manager_iv_back"[m
[32m+[m[32m            android:layout_width="40dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentLeft="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:onClick="back"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@drawable/topbarligtht_back" />[m
[32m+[m
[32m+[m[32m        <info.hoang8f.android.segmented.SegmentedGroup xmlns:segmentedgroup="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m            android:id="@+id/segmented2"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_centerInParent="true"[m
[32m+[m[32m            android:layout_margin="10dp"[m
[32m+[m[32m            android:orientation="horizontal"[m
[32m+[m[32m            segmentedgroup:sc_border_width="1dp"[m
[32m+[m[32m            segmentedgroup:sc_checked_text_color="@color/white"[m
[32m+[m[32m            segmentedgroup:sc_corner_radius="5dp"[m
[32m+[m[32m            segmentedgroup:sc_tint_color="@color/colorPrimary">[m
[32m+[m
[32m+[m[32m            <RadioButton[m
[32m+[m[32m                android:id="@+id/rb_down"[m
[32m+[m[32m                style="@style/RadioButton"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:text="@string/downmanager" />[m
[32m+[m
[32m+[m[32m            <RadioButton[m
[32m+[m[32m                android:id="@+id/rb_city"[m
[32m+[m[32m                style="@style/RadioButton"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:checked="true"[m
[32m+[m[32m                android:text="@string/citylist" />[m
[32m+[m[32m        </info.hoang8f.android.segmented.SegmentedGroup>[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m[32m    <android.support.v4.view.ViewPager[m
[32m+[m[32m        android:id="@+id/viewpager"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent"></android.support.v4.view.ViewPager>[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/activity_convert.xml b/app/src/main/res/layout/activity_convert.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..e0ad3a4[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_convert.xml[m
[36m@@ -0,0 +1,158 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="wrap_content"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:id="@+id/data_manager_topbar"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/colorPrimary">[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/data_manager_iv_back"[m
[32m+[m[32m            android:layout_width="40dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentLeft="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:onClick="back"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@drawable/topbar_back" />[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m
[32m+[m[32m    <TextView[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="100dp"[m
[32m+[m[32m        android:gravity="center"[m
[32m+[m[32m        android:text="@string/dufenmiao"[m
[32m+[m[32m        android:textColor="@color/colorPrimary"[m
[32m+[m[32m        android:textSize="30sp" />[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:orientation="horizontal">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:gravity="center_vertical"[m
[32m+[m[32m            android:text="@string/du"[m
[32m+[m[32m            android:textSize="20sp" />[m
[32m+[m
[32m+[m[32m        <EditText[m
[32m+[m[32m            android:id="@+id/et_dic"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:inputType="numberDecimal"[m
[32m+[m[32m            android:singleLine="true" />[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/btn_dci"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="@string/computer" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="50dp"[m
[32m+[m[32m            android:gravity="center_vertical"[m
[32m+[m[32m            android:text="@string/result"[m
[32m+[m[32m            android:textSize="20sp" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/tv_dic"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:gravity="center_vertical"[m
[32m+[m[32m            android:textSize="20sp" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:orientation="horizontal">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:gravity="center_vertical"[m
[32m+[m[32m            android:text="度分秒"[m
[32m+[m[32m            android:textSize="20sp" />[m
[32m+[m
[32m+[m[32m        <EditText[m
[32m+[m[32m            android:id="@+id/et_du"[m
[32m+[m[32m            android:layout_width="50dp"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:inputType="numberDecimal"[m
[32m+[m[32m            android:singleLine="true" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="度" />[m
[32m+[m
[32m+[m[32m        <EditText[m
[32m+[m[32m            android:id="@+id/et_fen"[m
[32m+[m[32m            android:layout_width="50dp"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:inputType="numberDecimal"[m
[32m+[m[32m            android:singleLine="true" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="50dp"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="分" />[m
[32m+[m
[32m+[m[32m        <EditText[m
[32m+[m[32m            android:id="@+id/et_miao"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:inputType="numberDecimal"[m
[32m+[m[32m            android:singleLine="true" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="秒" />[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/btn_dms"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="计算" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="50dp"[m
[32m+[m[32m            android:gravity="center_vertical"[m
[32m+[m[32m            android:text="结果:"[m
[32m+[m[32m            android:textSize="20sp" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/tv_dms"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:gravity="center_vertical"[m
[32m+[m[32m            android:textSize="20sp" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/activity_file_manager.xml b/app/src/main/res/layout/activity_file_manager.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..fe4943e[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_file_manager.xml[m
[36m@@ -0,0 +1,89 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:tools="http://schemas.android.com/tools"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:background="@color/windowBackground"[m
[32m+[m[32m    android:orientation="vertical"[m
[32m+[m[32m    tools:context=".Activity.FileManagerActivity">[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:id="@+id/file_manager_topbar"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/colorPrimary">[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/file_manager_iv_back"[m
[32m+[m[32m            android:layout_width="40dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentLeft="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:onClick="back"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@drawable/topbar_back" />[m
[32m+[m
[32m+[m
[32m+[m[32m        <View[m
[32m+[m[32m            android:layout_width="1dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_marginBottom="12dp"[m
[32m+[m[32m            android:layout_marginTop="12dp"[m
[32m+[m[32m            android:layout_toRightOf="@id/file_manager_iv_back"[m
[32m+[m[32m            android:background="@color/listdiver" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_centerInParent="true"[m
[32m+[m[32m            android:textColor="@color/white"[m
[32m+[m[32m            android:text="文件管理" />[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/file_manager_iv_add"[m
[32m+[m[32m            android:layout_width="40dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:background="@drawable/topbarimg"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:onClick="add"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@mipmap/ic_add_white_36dp" />[m
[32m+[m
[32m+[m[32m        <!--<View-->[m
[32m+[m[32m            <!--android:id="@+id/file_manager_iv_temp"-->[m
[32m+[m[32m            <!--android:layout_width="1dp"-->[m
[32m+[m[32m            <!--android:layout_height="match_parent"-->[m
[32m+[m[32m            <!--android:layout_marginBottom="8dp"-->[m
[32m+[m[32m            <!--android:layout_marginTop="8dp"-->[m
[32m+[m[32m            <!--android:layout_toLeftOf="@+id/file_manager_iv_more"-->[m
[32m+[m[32m            <!--android:background="@color/listdiver" />-->[m
[32m+[m
[32m+[m[32m        <!--<ImageView-->[m
[32m+[m[32m            <!--android:id="@+id/file_manager_iv_more"-->[m
[32m+[m[32m            <!--android:layout_width="40dp"-->[m
[32m+[m[32m            <!--android:layout_height="match_parent"-->[m
[32m+[m[32m            <!--android:layout_alignParentRight="true"-->[m
[32m+[m[32m            <!--android:layout_centerVertical="true"-->[m
[32m+[m[32m            <!--android:onClick="more"-->[m
[32m+[m[32m            <!--android:paddingBottom="7dp"-->[m
[32m+[m[32m            <!--android:paddingLeft="7dp"-->[m
[32m+[m[32m            <!--android:paddingRight="7dp"-->[m
[32m+[m[32m            <!--android:paddingTop="7dp"-->[m
[32m+[m[32m            <!--android:scaleType="centerInside"-->[m
[32m+[m[32m            <!--android:src="@mipmap/actionbar_more_icon" />-->[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m
[32m+[m[32m    <ListView[m
[32m+[m[32m        android:id="@+id/file_manager_listview"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"></ListView>[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/activity_main.xml b/app/src/main/res/layout/activity_main.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..ada3155[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_main.xml[m
[36m@@ -0,0 +1,24 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<android.support.v4.widget.DrawerLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:app="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m    xmlns:tools="http://schemas.android.com/tools"[m
[32m+[m[32m    android:id="@+id/drawerlayout"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:fitsSystemWindows="true"[m
[32m+[m[32m    tools:openDrawer="start">[m
[32m+[m
[32m+[m[32m    <include[m
[32m+[m[32m        layout="@layout/activity_main_content"/>[m
[32m+[m
[32m+[m[32m    <android.support.design.widget.NavigationView[m
[32m+[m[32m        android:id="@+id/nav_view"[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:layout_gravity="start"[m
[32m+[m[32m        android:fitsSystemWindows="true"[m
[32m+[m[32m        app:headerLayout="@layout/navigation_header"[m
[32m+[m[32m        app:menu="@menu/activity_main_drawer"[m
[32m+[m[32m        />[m
[32m+[m[32m</android.support.v4.widget.DrawerLayout>[m
[32m+[m
[1mdiff --git a/app/src/main/res/layout/activity_main_content.xml b/app/src/main/res/layout/activity_main_content.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..e98577b[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_main_content.xml[m
[36m@@ -0,0 +1,76 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:app="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m[32m    <android.support.v7.widget.Toolbar[m
[32m+[m[32m        android:id="@+id/toolbar"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:background="@color/colorPrimary"[m
[32m+[m[32m        app:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar"></android.support.v7.widget.Toolbar>[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent">[m
[32m+[m
[32m+[m[32m        <com.baidu.mapapi.map.MapView[m
[32m+[m[32m            android:id="@+id/bmapView"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:clickable="true" />[m
[32m+[m
[32m+[m[32m        <com.fanweilin.coordinatemap.widget.ZoomControlsView[m
[32m+[m[32m            android:id="@+id/activity_main_zoomcontrols"[m
[32m+[m[32m            android:layout_width="@dimen/imgbtn"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_alignParentBottom="true"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:layout_marginBottom="80dp"[m
[32m+[m[32m            android:layout_marginRight="10dp"></com.fanweilin.coordinatemap.widget.ZoomControlsView>[m
[32m+[m
[32m+[m[32m        <ImageButton[m
[32m+[m[32m            android:id="@+id/imgbtn_layer"[m
[32m+[m[32m            android:layout_width="@dimen/imgbtn"[m
[32m+[m[32m            android:layout_height="@dimen/imgbtn"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:layout_alignParentTop="true"[m
[32m+[m[32m            android:layout_marginRight="10dp"[m
[32m+[m[32m            android:layout_marginTop="10dp"[m
[32m+[m[32m            android:background="@drawable/imagebutton"[m
[32m+[m[32m            android:padding="5dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@mipmap/ic_layers_grey600_36dp"[m
[32m+[m[32m            android:tint="@color/colorPrimary" />[m
[32m+[m
[32m+[m[32m        <ImageButton[m
[32m+[m[32m            android:id="@+id/imgbtn_clearall"[m
[32m+[m[32m            android:layout_width="@dimen/imgbtn"[m
[32m+[m[32m            android:layout_height="@dimen/imgbtn"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:layout_below="@+id/imgbtn_layer"[m
[32m+[m[32m            android:layout_marginRight="10dp"[m
[32m+[m[32m            android:layout_marginTop="10dp"[m
[32m+[m[32m            android:background="@drawable/imagebutton"[m
[32m+[m[32m            android:padding="5dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@mipmap/ic_clear_all_grey600_36dp"[m
[32m+[m[32m            android:tint="@color/colorPrimary" />[m
[32m+[m
[32m+[m[32m        <ImageButton[m
[32m+[m[32m            android:id="@+id/imgbtn_mylocation"[m
[32m+[m[32m            android:layout_width="@dimen/imgbtn"[m
[32m+[m[32m            android:layout_height="@dimen/imgbtn"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:layout_below="@+id/imgbtn_clearall"[m
[32m+[m[32m            android:layout_marginRight="10dp"[m
[32m+[m[32m            android:layout_marginTop="10dp"[m
[32m+[m[32m            android:background="@drawable/imagebutton"[m
[32m+[m[32m            android:padding="5dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@mipmap/ic_my_location_grey600_36dp"[m
[32m+[m[32m            android:tint="@color/colorPrimary" />[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/activity_offline.xml b/app/src/main/res/layout/activity_offline.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..74e5305[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_offline.xml[m
[36m@@ -0,0 +1,157 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="vertical" >[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="50dip"[m
[32m+[m[32m        android:orientation="horizontal" >[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/cityid"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:text="131" />[m
[32m+[m[32m        <!-- 隐藏输入法用 -->[m
[32m+[m
[32m+[m[32m        <LinearLayout[m
[32m+[m[32m            android:layout_width="0px"[m
[32m+[m[32m            android:layout_height="0px"[m
[32m+[m[32m            android:focusable="true"[m
[32m+[m[32m            android:focusableInTouchMode="true" />[m
[32m+[m
[32m+[m[32m        <EditText[m
[32m+[m[32m            android:id="@+id/city"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:text="北京" />[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/search"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:background="@drawable/button_style"[m
[32m+[m[32m            android:onClick="search"[m
[32m+[m[32m            android:text="搜索" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="50dip"[m
[32m+[m[32m        android:orientation="horizontal" >[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/state"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:text="已下载:--" />[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/start"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:background="@drawable/button_style"[m
[32m+[m[32m            android:onClick="start"[m
[32m+[m[32m            android:text="开始" />[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/stop"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:background="@drawable/button_style"[m
[32m+[m[32m            android:onClick="stop"[m
[32m+[m[32m            android:text="停止" />[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/del"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:background="@drawable/button_style"[m
[32m+[m[32m            android:onClick="remove"[m
[32m+[m[32m            android:text="删除" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m        android:id="@+id/city_list"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="50dip"[m
[32m+[m[32m        android:orientation="horizontal" >[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/clButton"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:background="@drawable/button_style"[m
[32m+[m[32m            android:onClick="clickCityListButton"[m
[32m+[m[32m            android:text="城市列表" />[m
[32m+[m
[32m+[m[32m        <Button[m
[32m+[m[32m            android:id="@+id/localButton"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:background="@drawable/button_style"[m
[32m+[m[32m            android:onClick="clickLocalMapListButton"[m
[32m+[m[32m            android:text="下载管理" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m        android:id="@+id/citylist_layout"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:orientation="vertical" >[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="热门城市" />[m
[32m+[m
[32m+[m[32m        <ListView[m
[32m+[m[32m            android:id="@+id/hotcitylist"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="200dip" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="全国" />[m
[32m+[m
[32m+[m[32m        <ListView[m
[32m+[m[32m            android:id="@+id/allcitylist"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="fill_parent" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m        android:id="@+id/localmap_layout"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:orientation="vertical" >[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="已下载城市 " />[m
[32m+[m
[32m+[m[32m        <ListView[m
[32m+[m[32m            android:id="@+id/localmaplist"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/activity_search.xml b/app/src/main/res/layout/activity_search.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..adfe6e0[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/activity_search.xml[m
[36m@@ -0,0 +1,19 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:tools="http://schemas.android.com/tools"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    tools:context=".Activity.SearchActivity"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m[32m    <SearchView[m
[32m+[m[32m        android:id="@+id/search_view"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:iconifiedByDefault="false"[m
[32m+[m[32m        android:imeOptions="actionSearch"[m
[32m+[m
[32m+[m[32m       />[m
[32m+[m[32m    <ListView[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent"></ListView>[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/avtivity_data_manager.xml b/app/src/main/res/layout/avtivity_data_manager.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..f5a8414[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/avtivity_data_manager.xml[m
[36m@@ -0,0 +1,148 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:app="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:id="@+id/data_manager_topbar"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/colorPrimary">[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/data_manager_iv_back"[m
[32m+[m[32m            android:layout_width="40dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentLeft="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:onClick="back"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@drawable/topbar_back" />[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/data_manager_text_filname"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_centerInParent="true"[m
[32m+[m[32m            android:gravity="center"[m
[32m+[m[32m            android:textColor="@color/icons"[m
[32m+[m[32m            android:textSize="20sp" />[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/data_navigation"[m
[32m+[m[32m            android:layout_width="40dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:layout_toLeftOf="@+id/data_search"[m
[32m+[m[32m            android:background="@drawable/topbarimg"[m
[32m+[m[32m            android:onClick="navigation"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@mipmap/ic_pin_drop_white_36dp" />[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/data_search"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:background="@drawable/topbarimg"[m
[32m+[m[32m            android:iconifiedByDefault="true"[m
[32m+[m[32m            android:onClick="search"[m
[32m+[m[32m            android:paddingBottom="7dp"[m
[32m+[m[32m            android:paddingLeft="7dp"[m
[32m+[m[32m            android:paddingRight="7dp"[m
[32m+[m[32m            android:paddingTop="7dp"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@mipmap/ic_search_white_36dp" />[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:id="@+id/rl_search"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/secondprimary"[m
[32m+[m[32m        android:visibility="gone">[m
[32m+[m
[32m+[m[32m        <SearchView[m
[32m+[m[32m            android:id="@+id/search_view"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:iconifiedByDefault="false"[m
[32m+[m[32m            android:queryHint="@string/contains"></SearchView>[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m
[32m+[m[32m    <com.fanweilin.coordinatemap.widget.CheckableRelativeLayout[m
[32m+[m[32m        android:id="@+id/select_all"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/subbar"[m
[32m+[m[32m        android:onClick="checkall"[m
[32m+[m[32m        android:visibility="gone">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:layout_marginLeft="@dimen/maginparent"[m
[32m+[m[32m            android:text="@string/all"[m
[32m+[m[32m            android:textColor="@color/textcolor"[m
[32m+[m[32m            android:textSize="18sp" />[m
[32m+[m
[32m+[m[32m        <android.support.v7.widget.AppCompatCheckBox[m
[32m+[m[32m            android:id="@+id/iv_check"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:layout_marginRight="@dimen/maginparent"[m
[32m+[m[32m            android:clickable="false"[m
[32m+[m[32m            android:focusable="false" />[m
[32m+[m[32m    </com.fanweilin.coordinatemap.widget.CheckableRelativeLayout>[m
[32m+[m
[32m+[m[32m    <ListView[m
[32m+[m[32m        android:id="@+id/data_manager_list"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="0dp"[m
[32m+[m[32m        android:layout_weight="1"[m
[32m+[m[32m        android:choiceMode="multipleChoice"[m
[32m+[m[32m        android:divider="@color/listdiver"[m
[32m+[m[32m        android:dividerHeight="1dp"></ListView>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:id="@+id/layoutshow"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="48dp"[m
[32m+[m[32m        android:background="@color/subbar"[m
[32m+[m[32m        android:orientation="horizontal"[m
[32m+[m[32m        android:visibility="gone">[m
[32m+[m
[32m+[m[32m        <android.support.v7.widget.AppCompatButton[m
[32m+[m[32m            android:id="@+id/btn_cancel"[m
[32m+[m[32m            android:layout_width="0dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:gravity="center"[m
[32m+[m[32m            android:text="@string/cancle"[m
[32m+[m[32m            android:textSize="14sp" />[m
[32m+[m
[32m+[m[32m        <android.support.v7.widget.AppCompatButton[m
[32m+[m[32m            android:id="@+id/btn_show"[m
[32m+[m[32m            android:layout_width="0dp"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_gravity="center"[m
[32m+[m[32m            android:layout_weight="1"[m
[32m+[m[32m            android:gravity="center"[m
[32m+[m[32m            android:text="@string/show"[m
[32m+[m[32m            android:textSize="14sp" />[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/dialog_data.xml b/app/src/main/res/layout/dialog_data.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..3c5d339[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/dialog_data.xml[m
[36m@@ -0,0 +1,101 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m
[32m+[m[32m    <RadioGroup[m
[32m+[m[32m        android:id="@+id/radgroup"[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_gravity="center_horizontal"[m
[32m+[m[32m        android:orientation="horizontal">[m
[32m+[m
[32m+[m[32m        <RadioButton[m
[32m+[m[32m            android:id="@+id/radio_decimal"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="@string/decimal"[m
[32m+[m[32m            android:checked="true"/>[m
[32m+[m
[32m+[m[32m        <RadioButton[m
[32m+[m[32m            android:id="@+id/radio_dms"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:text="@string/dms" />[m
[32m+[m[32m    </RadioGroup>[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:layout_marginLeft="24dp"[m
[32m+[m[32m        android:layout_marginRight="24dp"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/tv_coord_system"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:textSize="18sp"[m
[32m+[m[32m            android:text="坐标系:" />[m
[32m+[m
[32m+[m[32m        <Spinner[m
[32m+[m[32m            android:id="@+id/spn_cds"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_toRightOf="@+id/tv_coord_system"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:entries="@array/coordstyle"[m
[32m+[m[32m            android:layout_centerVertical="true"/>[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:layout_marginLeft="24dp"[m
[32m+[m[32m        android:layout_marginRight="24dp"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/tv_latitude"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:textSize="18sp"[m
[32m+[m[32m            android:text="纬度:" />[m
[32m+[m
[32m+[m[32m        <EditText[m
[32m+[m[32m            android:id="@+id/edt_latitude"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_toRightOf="@+id/tv_latitude"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:inputType="numberDecimal"[m
[32m+[m[32m            android:singleLine="true"[m
[32m+[m[32m            android:textColorHint="@color/textcontent"[m
[32m+[m[32m            android:hint="39.9631757745"/>[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:layout_marginRight="24dp"[m
[32m+[m[32m        android:layout_marginLeft="24dp"[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="wrap_content">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:id="@+id/tv_longtitude"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:singleLine="true"[m
[32m+[m[32m            android:textSize="18sp"[m
[32m+[m[32m            android:text="经度:" />[m
[32m+[m
[32m+[m[32m        <EditText[m
[32m+[m[32m            android:id="@+id/edt_longtitude"[m
[32m+[m[32m            android:layout_toRightOf="@+id/tv_longtitude"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:hint="116.4002442204"[m
[32m+[m[32m            android:inputType="numberDecimal"[m
[32m+[m[32m            android:singleLine="true"[m
[32m+[m[32m            android:textColorHint="@color/textcontent"[m
[32m+[m[32m            android:layout_height="wrap_content" />[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/dialog_file_setting.xml b/app/src/main/res/layout/dialog_file_setting.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..8af68ab[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/dialog_file_setting.xml[m
[36m@@ -0,0 +1,58 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent">[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_centerHorizontal="true">[m
[32m+[m
[32m+[m[32m        <RadioGroup[m
[32m+[m[32m            android:id="@+id/rg_codstyle"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:orientation="vertical">[m
[32m+[m
[32m+[m[32m            <RadioButton[m
[32m+[m[32m                android:id="@+id/rb_wgs84"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:checked="true"[m
[32m+[m[32m                android:text="WGS84坐标系" />[m
[32m+[m
[32m+[m[32m            <RadioButton[m
[32m+[m[32m                android:id="@+id/rb_bd"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:text="百度坐标系" />[m
[32m+[m
[32m+[m[32m            <RadioButton[m
[32m+[m[32m                android:id="@+id/rb_other"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:text="其他坐标系" />[m
[32m+[m[32m        </RadioGroup>[m
[32m+[m[32m        <RadioGroup[m
[32m+[m[32m            android:id="@+id/rg_datastyle"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_toRightOf="@+id/rg_codstyle"[m
[32m+[m[32m            android:orientation="vertical">[m
[32m+[m
[32m+[m[32m            <RadioButton[m
[32m+[m[32m                android:id="@+id/rb_decimal"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:checked="true"[m
[32m+[m[32m                android:text="小数" />[m
[32m+[m
[32m+[m[32m            <RadioButton[m
[32m+[m[32m                android:id="@+id/rb_dms"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:text="度分秒" />[m
[32m+[m[32m        </RadioGroup>[m
[32m+[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m[32m</RelativeLayout>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/fragment_city_list.xml b/app/src/main/res/layout/fragment_city_list.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..4a487aa[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/fragment_city_list.xml[m
[36m@@ -0,0 +1,28 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:app="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m    xmlns:tools="http://schemas.android.com/tools"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent">[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:orientation="vertical">[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="48dp"[m
[32m+[m[32m            android:gravity="center_vertical"[m
[32m+[m[32m            android:text="@string/hotcity"[m
[32m+[m[32m            tools:ignore="HardcodedText"/>[m
[32m+[m[32m        <ListView[m
[32m+[m[32m            android:id="@+id/lv_hotcity"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="200dp"[m
[32m+[m[32m            />[m
[32m+[m[32m        <ExpandableListView[m
[32m+[m[32m            android:id="@+id/el_city"[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"></ExpandableListView>[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/frament_down.xml b/app/src/main/res/layout/frament_down.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..645ca1c[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/frament_down.xml[m
[36m@@ -0,0 +1,21 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m        android:id="@+id/localmap_layout"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:orientation="vertical" >[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:background="@color/listdiver"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_gravity="center_vertical"[m
[32m+[m[32m            android:text="已下载城市 " />[m
[32m+[m
[32m+[m[32m        <ListView[m
[32m+[m[32m            android:id="@+id/localmaplist"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content" />[m
[32m+[m[32m    </LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/list_child.xml b/app/src/main/res/layout/list_child.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..acaa28d[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/list_child.xml[m
[36m@@ -0,0 +1,48 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="50dp"[m
[32m+[m[32m    android:background="@color/windowBackground">[m
[32m+[m
[32m+[m[32m    <TextView[m
[32m+[m[32m        android:id="@+id/tv_childcity"[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_alignParentLeft="true"[m
[32m+[m[32m        android:layout_centerVertical="true"[m
[32m+[m[32m        android:gravity="center"[m
[32m+[m[32m        android:layout_marginLeft="@dimen/maginparent"[m
[32m+[m[32m        android:textColor="@color/textcolor" />[m
[32m+[m
[32m+[m[32m    <TextView[m
[32m+[m[32m        android:paddingLeft="10dp"[m
[32m+[m[32m        android:id="@+id/tv_size"[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_centerVertical="true"[m
[32m+[m[32m        android:gravity="center"[m
[32m+[m[32m        android:layout_toRightOf="@+id/tv_childcity"[m
[32m+[m[32m        android:textColor="@color/textcontent"[m
[32m+[m[32m        android:textSize="13sp" />[m
[32m+[m
[32m+[m[32m    <View[m
[32m+[m[32m        android:id="@+id/temp"[m
[32m+[m[32m        android:layout_width="1dp"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:layout_toLeftOf="@+id/btn_down"[m
[32m+[m[32m        android:layout_marginBottom="7dp"[m
[32m+[m[32m        android:layout_marginTop="7dp"[m
[32m+[m[32m        android:background="@color/listdiver" />[m
[32m+[m
[32m+[m[32m    <Button[m
[32m+[m[32m        android:id="@+id/btn_down"[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:layout_alignParentRight="true"[m
[32m+[m[32m        android:background="@color/topbarimg"[m
[32m+[m[32m        android:text="@string/down"[m
[32m+[m[32m        android:focusable="false"[m
[32m+[m[32m        android:clickable="false"[m
[32m+[m[32m        android:textColor="@color/colorPrimary"[m
[32m+[m[32m        android:textSize="14sp" />[m
[32m+[m[32m</RelativeLayout>[m
[1mdiff --git a/app/src/main/res/layout/list_data.xml b/app/src/main/res/layout/list_data.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..1dd054c[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/list_data.xml[m
[36m@@ -0,0 +1,55 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<com.fanweilin.coordinatemap.widget.CheckableRelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="match_parent"[m
[32m+[m[32m        android:orientation="vertical"[m
[32m+[m[32m        android:paddingBottom="4dp"[m
[32m+[m[32m        android:paddingTop="4dp">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/name"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_marginLeft="@dimen/maginparent"[m
[32m+[m[32m            android:textColor="@color/textcolor"[m
[32m+[m[32m            android:textSize="18sp" />[m
[32m+[m
[32m+[m[32m        <RelativeLayout[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="wrap_content">[m
[32m+[m
[32m+[m[32m            <TextView[m
[32m+[m[32m                android:id="@+id/latitude"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:layout_marginLeft="@dimen/maginparent"[m
[32m+[m[32m                android:textColor="@color/textcontent"[m
[32m+[m[32m                android:textSize="14sp" />[m
[32m+[m
[32m+[m[32m            <TextView[m
[32m+[m[32m                android:id="@+id/longitude"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:layout_toRightOf="@+id/latitude"[m
[32m+[m[32m                android:textColor="@color/textcontent"[m
[32m+[m[32m                android:textSize="14sp" />[m
[32m+[m[32m        </RelativeLayout>[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m    <android.support.v7.widget.AppCompatCheckBox[m
[32m+[m[32m        android:id="@+id/checkbox"[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_alignParentRight="true"[m
[32m+[m[32m        android:layout_centerVertical="true"[m
[32m+[m[32m        android:layout_marginRight="@dimen/maginparent"[m
[32m+[m[32m        android:clickable="false"[m
[32m+[m[32m        android:focusable="false"[m
[32m+[m[32m        android:visibility="gone"[m
[32m+[m[32m        />[m
[32m+[m[32m</com.fanweilin.coordinatemap.widget.CheckableRelativeLayout>[m
[1mdiff --git a/app/src/main/res/layout/list_file.xml b/app/src/main/res/layout/list_file.xml[mwarning: LF will be replaced by CRLF in app/src/main/res/layout/activity_add_file.xml.
The file will have its original line endings in your working directory.

[1mnew file mode 100644[m
[1mindex 0000000..8fe2048[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/list_file.xml[m
[36m@@ -0,0 +1,41 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="fill_parent"[m
[32m+[m[32m    android:layout_height="fill_parent"[m
[32m+[m[32m    android:orientation="horizontal" >[m
[32m+[m
[32m+[m[32m    <ImageView[m
[32m+[m[32m        android:id="@+id/img"[m
[32m+[m[32m        android:layout_width="48dip"[m
[32m+[m[32m        android:layout_height="48dip"[m
[32m+[m[32m        android:layout_margin="5dip"/>[m
[32m+[m
[32m+[m[32m    <LinearLayout[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_margin="5dip"[m
[32m+[m[32m        android:orientation="vertical" >[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/title"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:textColor="@color/textcolor"[m
[32m+[m[32m            android:textSize="18sp" />[m
[32m+[m
[32m+[m[32m        <RelativeLayout[m
[32m+[m[32m            android:id="@+id/drawview"[m
[32m+[m[32m            android:layout_width="fill_parent"[m
[32m+[m[32m            android:layout_height="wrap_content" >[m
[32m+[m
[32m+[m[32m            <TextView[m
[32m+[m[32m                android:id="@+id/path"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:layout_alignParentRight="true"[m
[32m+[m[32m                android:textColor="@color/textcontent"[m
[32m+[m[32m                android:textSize="14sp" />[m
[32m+[m[32m        </RelativeLayout>[m
[32m+[m[32m    </LinearLayout>[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/list_parent.xml b/app/src/main/res/layout/list_parent.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..1b003e9[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/list_parent.xml[m
[36m@@ -0,0 +1,12 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="50dp">[m
[32m+[m[32m<TextView[m
[32m+[m[32m    android:layout_alignParentLeft="true"[m
[32m+[m[32m    android:id="@+id/tv_city"[m
[32m+[m[32m    android:layout_marginLeft="50dp"[m
[32m+[m[32m    android:layout_width="wrap_content"[m
[32m+[m[32m    android:layout_height="40dp" />[m
[32m+[m
[32m+[m[32m</RelativeLayout>[m
[1mdiff --git a/app/src/main/res/layout/markerpopup.xml b/app/src/main/res/layout/markerpopup.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..f9504c9[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/markerpopup.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent">[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
[1mdiff --git a/app/src/main/res/layout/navigation_header.xml b/app/src/main/res/layout/navigation_header.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..8692e5c[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/navigation_header.xml[m
[36m@@ -0,0 +1,31 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:app="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="192dp"[m
[32m+[m[32m    android:background="?attr/colorPrimaryDark"[m
[32m+[m[32m    android:gravity="center"[m
[32m+[m[32m    android:orientation="vertical"[m
[32m+[m[32m    android:padding="16dp"[m
[32m+[m[32m    android:theme="@style/ThemeOverlay.AppCompat.Dark">[m
[32m+[m
[32m+[m
[32m+[m[32m    <de.hdodenhof.circleimageview.CircleImageView[m
[32m+[m[32m        android:id="@+id/profile_image"[m
[32m+[m[32m        android:layout_width="72dp"[m
[32m+[m[32m        android:layout_height="72dp"[m
[32m+[m[32m        android:layout_marginTop="20dp"[m
[32m+[m[32m        android:src="@mipmap/earth_global"[m
[32m+[m[32m        app:border_color="@color/primary_light"[m
[32m+[m[32m        app:border_width="2dp" />[m
[32m+[m
[32m+[m[32m    <TextView[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_marginTop="10dp"[m
[32m+[m[32m        android:gravity="center"[m
[32m+[m[32m        android:text="@string/app_name"[m
[32m+[m[32m        android:textAppearance="@style/TextAppearance.AppCompat.Body1"[m
[32m+[m[32m        android:textSize="18sp" />[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/offline_localmap_list.xml b/app/src/main/res/layout/offline_localmap_list.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..df6a9e4[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/offline_localmap_list.xml[m
[36m@@ -0,0 +1,46 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:orientation="horizontal"[m
[32m+[m[32m    android:padding="10dip" >[m
[32m+[m
[32m+[m[32m    <TextView[m
[32m+[m[32m        android:id="@+id/title"[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_weight="1"[m
[32m+[m[32m        android:text="已下载城市 " />[m
[32m+[m
[32m+[m[32m    <TextView[m
[32m+[m[32m        android:id="@+id/update"[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_weight="1"[m
[32m+[m[32m        android:text=""[m
[32m+[m[32m        android:textColor="#FF0000" />[m
[32m+[m
[32m+[m[32m    <TextView[m
[32m+[m[32m        android:id="@+id/ratio"[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_weight="1"[m
[32m+[m[32m        android:text="" />[m
[32m+[m
[32m+[m[32m    <Button[m
[32m+[m[32m        android:id="@+id/display"[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_weight="1"[m
[32m+[m[32m        android:textSize="14sp"[m
[32m+[m[32m        android:text="查看" />[m
[32m+[m
[32m+[m[32m    <Button[m
[32m+[m[32m        android:id="@+id/remove"[m
[32m+[m[32m        android:layout_width="fill_parent"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:layout_weight="1"[m
[32m+[m[32m        android:textSize="14sp"[m
[32m+[m[32m        android:text="删除" />[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/popupwindow.xml b/app/src/main/res/layout/popupwindow.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..630062f[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/popupwindow.xml[m
[36m@@ -0,0 +1,77 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<android.support.v7.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:id="@+id/card_popup"[m
[32m+[m[32m    android:layout_width="match_parent"[m
[32m+[m[32m    android:layout_height="match_parent"[m
[32m+[m[32m    android:focusable="true"[m
[32m+[m[32m    android:focusableInTouchMode="true">[m
[32m+[m
[32m+[m[32m    <RelativeLayout[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="wrap_content">[m
[32m+[m
[32m+[m[32m        <LinearLayout[m
[32m+[m[32m            android:layout_width="match_parent"[m
[32m+[m[32m            android:layout_height="match_parent"[m
[32m+[m[32m            android:layout_alignParentLeft="true"[m
[32m+[m[32m            android:layout_marginLeft="16dp"[m
[32m+[m[32m            android:orientation="vertical">[m
[32m+[m
[32m+[m[32m            <TextView[m
[32m+[m[32m                android:id="@+id/tv_name"[m
[32m+[m[32m                android:layout_width="wrap_content"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:textColor="@color/textcolor"[m
[32m+[m[32m                android:textSize="18sp" />[m
[32m+[m
[32m+[m[32m            <LinearLayout[m
[32m+[m[32m                android:layout_width="match_parent"[m
[32m+[m[32m                android:layout_height="wrap_content"[m
[32m+[m[32m                android:orientation="horizontal">[m
[32m+[m
[32m+[m[32m                <TextView[m
[32m+[m[32m                    android:layout_width="wrap_content"[m
[32m+[m[32m                    android:layout_height="wrap_content"[m
[32m+[m[32m                    android:text="LAT:"[m
[32m+[m[32m                    android:textColor="@color/textcontent" />[m
[32m+[m
[32m+[m[32m                <TextView[m
[32m+[m[32m                    android:id="@+id/tv_lat"[m
[32m+[m[32m                    android:layout_width="wrap_content"[m
[32m+[m[32m                    android:layout_height="wrap_content"[m
[32m+[m[32m                    android:textColor="@color/textcontent" />[m
[32m+[m
[32m+[m[32m                <TextView[m
[32m+[m[32m                    android:layout_width="wrap_content"[m
[32m+[m[32m                    android:layout_height="wrap_content"[m
[32m+[m[32m                    android:text=" LNG:"[m
[32m+[m[32m                    android:textColor="@color/textcontent" />[m
[32m+[m
[32m+[m[32m                <TextView[m
[32m+[m[32m                    android:id="@+id/tv_lng"[m
[32m+[m[32m                    android:layout_width="wrap_content"[m
[32m+[m[32m                    android:layout_height="wrap_content"[m
[32m+[m[32m                    android:textColor="@color/textcontent" />[m
[32m+[m
[32m+[m[32m                <TextView[m
[32m+[m[32m                    android:id="@+id/tv_address"[m
[32m+[m[32m                    android:layout_width="wrap_content"[m
[32m+[m[32m                    android:layout_height="wrap_content"[m
[32m+[m[32m                    android:textColor="@color/textcolor" />[m
[32m+[m[32m            </LinearLayout>[m
[32m+[m[32m        </LinearLayout>[m
[32m+[m
[32m+[m[32m        <ImageView[m
[32m+[m[32m            android:id="@+id/iv_goto"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_alignParentRight="true"[m
[32m+[m[32m            android:layout_centerVertical="true"[m
[32m+[m[32m            android:layout_marginRight="16dp"[m
[32m+[m[32m            android:background="@drawable/imagebutton"[m
[32m+[m[32m            android:clickable="true"[m
[32m+[m[32m            android:scaleType="centerInside"[m
[32m+[m[32m            android:src="@mipmap/ic_warning: LF will be replaced by CRLF in app/src/main/res/layout/navigation_header.xml.
The file will have its original line endings in your working directory.
trending_up_grey600_36dp" />[m
[32m+[m[32m    </RelativeLayout>[m
[32m+[m
[32m+[m[32m</android.support.v7.widget.CardView>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/text_bubble.xml b/app/src/main/res/layout/text_bubble.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..fe11805[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/text_bubble.xml[m
[36m@@ -0,0 +1,27 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<!--[m
[32m+[m[32m  ~ Copyright (C) 2015 Baidu, Inc. All Rights Reserved.[m
[32m+[m[32m  -->[m
[32m+[m[32m<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="wrap_content"[m
[32m+[m[32m    android:layout_height="wrap_content"[m
[32m+[m[32m    android:orientation="vertical">[m
[32m+[m
[32m+[m[32m    <com.baidu.mapapi.clusterutil.ui.RotationLayout[m
[32m+[m[32m        android:layout_width="wrap_content"[m
[32m+[m[32m        android:layout_height="wrap_content"[m
[32m+[m[32m        android:orientation="vertical">[m
[32m+[m
[32m+[m[32m        <TextView[m
[32m+[m[32m            android:id="@+id/text"[m
[32m+[m[32m            android:layout_width="wrap_content"[m
[32m+[m[32m            android:layout_height="wrap_content"[m
[32m+[m[32m            android:layout_gravity="center_horizontal"[m
[32m+[m[32m            android:paddingBottom="5dp"[m
[32m+[m[32m            android:paddingLeft="10dp"[m
[32m+[m[32m            android:paddingRight="10dp"[m
[32m+[m[32m            android:paddingTop="5dp"/>[m
[32m+[m
[32m+[m[32m    </com.baidu.mapapi.clusterutil.ui.RotationLayout>[m
[32m+[m
[32m+[m[32m</LinearLayout>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/layout/zoom_controls.xml b/app/src/main/res/layout/zoom_controls.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..439abb7[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/layout/zoom_controls.xml[m
[36m@@ -0,0 +1,36 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:layout_width="wrap_content"[m
[32m+[m[32m    android:layout_height="wrap_content"[m
[32m+[m[32m    android:background="@color/windowBackground">[m
[32m+[m
[32m+[m[32m    <ImageButton[m
[32m+[m[32m        android:id="@+id/btn_zoom_in"[m
[32m+[m[32m        android:layout_width="40dp"[m
[32m+[m[32m        android:layout_height="45dp"[m
[32m+[m[32m        android:layout_centerHorizontal="true"[m
[32m+[m[32m        android:background="@drawable/imagebutton"[m
[32m+[m[32m        android:padding="5dp"[m
[32m+[m[32m        android:scaleType="centerInside"[m
[32m+[m[32m        android:src="@mipmap/ic_add_grey600_48dp" />[m
[32m+[m
[32m+[m[32m    <View[m
[32m+[m[32m        android:id="@+id/temp"[m
[32m+[m[32m        android:layout_width="match_parent"[m
[32m+[m[32m        android:layout_height="1dp"[m
[32m+[m[32m        android:layout_below="@+id/btn_zoom_in"[m
[32m+[m[32m        android:layout_marginLeft="8dp"[m
[32m+[m[32m        android:layout_marginRight="8dp"[m
[32m+[m[32m        android:background="@color/listdiver" />[m
[32m+[m
[32m+[m[32m    <ImageButton[m
[32m+[m[32m        android:id="@+id/btn_zoom_out"[m
[32m+[m[32m        android:layout_width="40dp"[m
[32m+[m[32m        android:layout_height="45dp"[m
[32m+[m[32m        android:layout_below="@+id/temp"[m
[32m+[m[32m        android:layout_centerHorizontal="true"[m
[32m+[m[32m        android:background="@drawable/imagebutton"[m
[32m+[m[32m        android:padding="5dp"[m
[32m+[m[32m        android:scaleType="centerInside"[m
[32m+[m[32m        android:src="@mipmap/ic_remove_grey600_48dp" />[m
[32m+[m[32m</RelativeLayout>[m
[1mdiff --git a/app/src/main/res/menu/activity_main_drawer.xml b/app/src/main/res/menu/activity_main_drawer.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..4dc4f5c[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/menu/activity_main_drawer.xml[m
[36m@@ -0,0 +1,24 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<menu xmlns:android="http://schemas.android.com/apk/res/android">[m
[32m+[m
[32m+[m[32m    <group android:checkableBehavior="single">[m
[32m+[m[32m        <item[m
[32m+[m[32m            android:id="@+id/nav_computer"[m
[32m+[m[32m            android:icon="@drawable/ic_menu_manage"[m
[32m+[m[32m            android:title="计算工具" />[m
[32m+[m[32m        <item[m
[32m+[m[32m            android:id="@+id/nav_down"[m
[32m+[m[32m            android:icon="@mipmap/ic_file_download_black_36dp"[m
[32m+[m[32m            android:title="下载离线地图" />[m
[32m+[m[32m        <item[m
[32m+[m[32m            android:id="@+id/nav_about"[m
[32m+[m[32m            android:icon="@mipmap/ic_person_black_36dp"[m
[32m+[m[32m            android:title="关于" />[m
[32m+[m[32m        <item[m
[32m+[m[32m            android:id="@+id/nav_quit"[m
[32m+[m[32m            android:icon="@mipmap/ic_assignment_return_black_36dp"[m
[32m+[m[32m            android:title="退出" />[m
[32m+[m[32m    </group>[m
[32m+[m
[32m+[m
[32m+[m[32m</menu>[m
[1mdiff --git a/app/src/main/res/menu/menu_main.xml b/app/src/main/res/menu/menu_main.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..1c93fd7[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/menu/menu_main.xml[m
[36m@@ -0,0 +1,13 @@[m
[32m+[m[32m<menu xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    xmlns:app="http://schemas.android.com/apk/res-auto"[m
[32m+[m[32m    xmlns:tools="http://schemas.android.com/tools"[m
[32m+[m[32m  >[m
[32m+[m[32m    <item android:id="@+id/menu_search"[m
[32m+[m[32m          android:title="search"[m
[32m+[m[32m        android:icon="@mipmap/ic_search_white_36dp"[m
[32m+[m[32m        android:orderInCategory="120"[m
[32m+[m[32m        app:showAsAction="ifRoom"/>[m
[32m+[m[32m    <item android:id="@+id/add_file"[m
[32m+[m[32m        android:title="@string/add_file"[m
[32m+[m[32m        app:showAsAction="ifRoom" />[m
[32m+[m[32m</menu>[m
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ac0.png b/app/src/main/res/mipmap-hdpi/ac0.png[m
[1mnew file mode 100644[m
[1mindex 0000000..c2669d9[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ac0.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ac1.png b/app/src/main/res/mipmap-hdpi/ac1.png[m
[1mnew file mode 100644[m
[1mindex 0000000..c8d5abb[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ac1.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ex_doc.png b/app/src/main/res/mipmap-hdpi/ex_doc.png[m
[1mnew file mode 100644[m
[1mindex 0000000..6b188dc[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ex_doc.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ex_folder.png b/app/src/main/res/mipmap-hdpi/ex_folder.png[m
[1mnew file mode 100644[m
[1mindex 0000000..1a986c3[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ex_folder.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_add_black_48dp.png b/app/src/main/res/mipmap-hdpi/ic_add_black_48dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..a633259[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_add_black_48dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_add_grey600_48dp.png b/app/src/main/res/mipmap-hdpi/ic_add_grey600_48dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..70e4e86[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_add_grey600_48dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_assignment_return_black_36dp.png b/app/src/main/res/mipmap-hdpi/ic_assignment_return_black_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..999a073[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_assignment_return_black_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_clear_all_grey600_36dp.png b/app/src/main/res/mipmap-hdpi/ic_clear_all_grey600_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..623e505[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_clear_all_grey600_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_file_download_black_18dp.png b/app/src/main/res/mipmap-hdpi/ic_file_download_black_18dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..a2fc35c[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_file_download_black_18dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_file_download_black_36dp.png b/app/src/main/res/mipmap-hdpi/ic_file_download_black_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..a2fc35c[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_file_download_black_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_launcher.png b/app/src/main/res/mipmap-hdpi/ic_launcher.png[m
[1mnew file mode 100644[m
[1mindex 0000000..c133a0c[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_launcher.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_layers_grey600_36dp.png b/app/src/main/res/mipmap-hdpi/ic_layers_grey600_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..a509bf9[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_layers_grey600_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_my_location_grey600_36dp.png b/app/src/main/res/mipmap-hdpi/ic_my_location_grey600_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..9d27f30[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_my_location_grey600_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_person_black_36dp.png b/app/src/main/res/mipmap-hdpi/ic_person_black_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..13ab78a[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_person_black_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_person_grey600_36dp.png b/app/src/main/res/mipmap-hdpi/ic_person_grey600_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..0e8563b[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_person_grey600_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_pin_drop_white_36dp.png b/app/src/main/res/mipmap-hdpi/ic_pin_drop_white_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..fa99f75[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_pin_drop_white_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_remove_black_48dp.png b/app/src/main/res/mipmap-hdpi/ic_remove_black_48dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..f5997a4[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_remove_black_48dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_remove_grey600_48dp.png b/app/src/main/res/mipmap-hdpi/ic_remove_grey600_48dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..3d5136f[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_remove_grey600_48dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_search_white_36dp.png b/app/src/main/res/mipmap-hdpi/ic_search_white_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..a2fc5b2[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_search_white_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/ic_trending_up_grey600_36dp.png b/app/src/main/res/mipmap-hdpi/ic_trending_up_grey600_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..e668e07[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/ic_trending_up_grey600_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-hdpi/location_pin.png b/app/src/main/res/mipmap-hdpi/location_pin.png[m
[1mnew file mode 100644[m
[1mindex 0000000..3b954dc[m
Binary files /dev/null and b/app/src/main/res/mipmap-hdpi/location_pin.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/actionbar_add_icon.png b/app/src/main/res/mipmap-mdpi/actionbar_add_icon.png[m
[1mnew file mode 100644[m
[1mindex 0000000..a24c303[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/actionbar_add_icon.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/actionbar_more_icon.png b/app/src/main/res/mipmap-mdpi/actionbar_more_icon.png[m
[1mnew file mode 100644[m
[1mindex 0000000..b9d64a1[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/actionbar_more_icon.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/actionbar_search_icon.png b/app/src/main/res/mipmap-mdpi/actionbar_search_icon.png[m
[1mnew file mode 100644[m
[1mindex 0000000..8b7daaf[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/actionbar_search_icon.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/button_down.png b/app/src/main/res/mipmap-mdpi/button_down.png[m
[1mnew file mode 100644[m
[1mindex 0000000..e8bd757[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/button_down.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/button_on.png b/app/src/main/res/mipmap-mdpi/button_on.png[m
[1mnew file mode 100644[m
[1mindex 0000000..3731bba[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/button_on.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/earth_global.png b/app/src/main/res/mipmap-mdpi/earth_global.png[m
[1mnew file mode 100644[m
[1mindex 0000000..2c688a7[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/earth_global.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/exdoc.png b/app/src/main/res/mipmap-mdpi/exdoc.png[m
[1mnew file mode 100644[m
[1mindex 0000000..4b21fdd[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/exdoc.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/ic_add_box_white_36dp.png b/app/src/main/res/mipmap-mdpi/ic_add_box_white_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..4d054c9[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/ic_add_box_white_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/ic_add_white_36dp.png b/app/src/main/res/mipmap-mdpi/ic_add_white_36dp.png[m
[1mnew file mode 100644[m
[1mindex 0000000..481643e[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/ic_add_white_36dp.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/ic_file.png b/app/src/main/res/mipmap-mdpi/ic_file.png[m
[1mnew file mode 100644[m
[1mindex 0000000..62105a9[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/ic_file.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/ic_folder.png b/app/src/main/res/mipmap-mdpi/ic_folder.png[m
[1mnew file mode 100644[m
[1mindex 0000000..6d1c2eb[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/ic_folder.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/ic_location.png b/app/src/main/res/mipmap-mdpi/ic_location.png[m
[1mnew file mode 100644[m
[1mindex 0000000..4599fa8[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/ic_location.png differ
[1mdiff --git a/app/src/main/res/mipmap-mdpi/location.png b/app/src/main/res/mipmap-mdpi/location.png[m
[1mnew file mode 100644[m
[1mindex 0000000..b06c0de[m
Binary files /dev/null and b/app/src/main/res/mipmap-mdpi/location.png differ
[1mdiff --git a/app/src/main/res/mipmap-xhdpi/ic_launcher.png b/app/src/main/res/mipmap-xhdpi/ic_launcher.png[m
[1mnew file mode 100644[m
[1mindex 0000000..bfa42f0[m
Binary files /dev/null and b/app/src/main/res/mipmap-xhdpi/ic_launcher.png differ
[1mdiff --git a/app/src/main/res/mipmap-xxhdpi/ic_launcher.png b/app/src/main/res/mipmap-xxhdpi/ic_launcher.png[m
[1mnew file mode 100644[m
[1mindex 0000000..324e72c[m
Binary files /dev/null and b/app/src/main/res/mipmap-xxhdpi/ic_launcher.png differ
[1mdiff --git a/app/src/main/res/mipmap-xxxhdpi/ic_launcher.png b/app/src/main/res/mipmap-xxxhdpi/ic_launcher.png[m
[1mnew file mode 100644[m
[1mindex 0000000..aee44e1[m
Binary files /dev/null and b/app/src/main/res/mipmap-xxxhdpi/ic_launcher.png differ
[1mdiff --git a/app/src/main/res/values-v21/strings.xml b/app/src/main/res/values-v21/strings.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..1b6d458[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values-v21/strings.xml[m
[36m@@ -0,0 +1,4 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<resources>[m
[32m+[m[32m    <string name="searchLabel">搜索</string>[m
[32m+[m[32m</resources>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/values-v21/styles.xml b/app/src/main/res/values-v21/styles.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..6ff32d8[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values-v21/styles.xml[m
[36m@@ -0,0 +1,7 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<resources>[m
[32m+[m[32m    <style name="AppTheme" parent="AppTheme.Base">[m
[32m+[m[32m        <!--Navigation bar color-->[m
[32m+[m[32m        <item name="android:navigationBarColor">@color/accent_material_light</item>[m
[32m+[m[32m    </style>[m
[32m+[m[32m</resources>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/values-w820dp/dimens.xml b/app/src/main/res/values-w820dp/dimens.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..63fc816[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values-w820dp/dimens.xml[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32m<resources>[m
[32m+[m[32m    <!-- Example customization of dimensions originally defined in res/values/dimens.xml[m
[32m+[m[32m         (such as screen margins) for screens with more than 820dp of available width. This[m
[32m+[m[32m         would include 7" and 10" devices in landscape (~960dp and ~1280dp respectively). -->[m
[32m+[m[32m    <dimen name="activity_horizontal_margin">64dp</dimen>[m
[32m+[m[32m</resources>[m
[1mdiff --git a/app/src/main/res/values/arrays.xml b/app/src/main/res/values/arrays.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..c0bc56e[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values/arrays.xml[m
[36m@@ -0,0 +1,8 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<resources>[m
[32m+[m[32m    <string-array name="coordstyle">[m
[32m+[m[32m        <item>WGS84坐标系</item>[m
[32m+[m[32m        <item> 百度坐标系</item>[m
[32m+[m[32m        <item> GCJ-02</item>[m
[32m+[m[32m    </string-array>[m
[32m+[m[32m</resources>[m
\ No newline at end of file[m
[1mdiff --git a/app/src/main/res/values/colors.xml b/app/src/main/res/values/colors.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..2b99339[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values/colors.xml[m
[36m@@ -0,0 +1,20 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<resources>[m
[32m+[m[32m    <color name="colorPrimary">#2196F3</color>[m
[32m+[m[32m    <color name="colorPrimaryDark">#1976D2</color>[m
[32m+[m[32m    <color name="colorAccent">#00b0ff</color>[m
[32m+[m[32m    <color name="windowBackground">#FAFAFA</color>[m
[32m+[m[32m    <color name="subbar">#EEEEEE</color>[m
[32m+[m[32m    <color name="textcolor">#212121</color>[m
[32m+[m[32m    <color name="textcontent">#727272</color>[m
[32m+[m[32m    <color name="listdiver">#B6B6B6</color>[m
[32m+[m[32m    <color name="listdatabackground">#f8c7edcc</color>[m
[32m+[m[32m    <color name="unfocused">#ffffff</color>[m
[32m+[m[32m    <color name="pressed">#085974</color>[m
[32m+[m[32m    <color name="white">#FFFFFF</color>[m
[32m+[m[32m    <color name="gray">#dad1d1</color>[m
[32m+[m[32m    <color name="topbarimg">#00FFFFFF</color>[m
[32m+[m[32m    <color name="primary_light">#BBDEFB</color>[m
[32m+[m[32m    <color name="icons">#FFFFFF</color>[m
[32m+[m[32m    <color name="secondprimary">#F5F5F5</color>[m
[32m+[m[32m</resources>[m
[1mdiff --git a/app/src/main/res/values/dimens.xml b/app/src/main/res/values/dimens.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..75fb05e[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values/dimens.xml[m
[36m@@ -0,0 +1,7 @@[m
[32m+[m[32m<resources>[m
[32m+[m[32m    <!-- Default screen margins, per the Android Design guidelines. -->[m
[32m+[m[32m    <dimen name="activity_horizontal_margin">16dp</dimen>[m
[32m+[m[32m    <dimen name="activity_vertical_margin">16dp</dimen>[m
[32m+[m[32m    <dimen name="maginparent">16dp</dimen>[m
[32m+[m[32m    <dimen name="imgbtn">40dp</dimen>[m
[32m+[m[32m</resources>[m
[1mdiff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..dc556db[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values/strings.xml[m
[36m@@ -0,0 +1,26 @@[m
[32m+[m[32m<resources>[m
[32m+[m[32m    <string name="app_name">经纬度定位</string>[m
[32m+[m[32m    <string name="open">打开</string>[m
[32m+[m[32m    <string name="close">关闭</string>[m
[32m+[m[32m    <string name="action_settings">setting</string>[m
[32m+[m[32m    <string name="add_file">文件管理</string>[m
[32m+[m[32m    <string name="datamanager">数据管理</string>[m
[32m+[m[32m    <string name="cancle">取消</string>[m
[32m+[m[32m    <string name="show">显示</string>[m
[32m+[m[32m    <string name="all">全部</string>[m
[32m+[m[32m    <string name="decimal">小 数</string>[m
[32m+[m[32m    <string name="dms">度分秒</string>[m
[32m+[m[32m    <string name="searchLabel">搜索</string>[m
[32m+[m[32m    <string name="searchHint">名称</string>[m
[32m+[m[32m    <string name="name">mingc</string>[m
[32m+[m[32m    <string name="contains">输入包含文字</string>[m
[32m+[m[32m    <string name="help">帮助</string>[m
[32m+[m[32m    <string name="down">下载</string>[m
[32m+[m[32m    <string name="hotcity">热门城市</string>[m
[32m+[m[32m    <string name="downmanager">下载管理</string>[m
[32m+[m[32m    <string name="citylist">城市列表</string>[m
[32m+[m[32m    <string name="dufenmiao">度分秒转换</string>[m
[32m+[m[32m    <string name="du">度数</string>[m
[32m+[m[32m    <string name="computer">计算</string>[m
[32m+[m[32m    <string name="result">结果:</string>[m
[32m+[m[32m</resources>[m
[1mdiff --git a/app/src/main/res/values/styles.xml b/app/src/main/res/values/styles.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..344b8c3[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/values/styles.xml[m
[36m@@ -0,0 +1,37 @@[m
[32m+[m[32m<resources>[m
[32m+[m
[32m+[m[32m    <!-- Base application theme. -->[m
[32m+[m[32m    <style name="AppTheme" parent="AppTheme.Base">[m
[32m+[m[32m    </style>[m
[32m+[m
[32m+[m[32m    <style name="AppTheme.Base" parent="Theme.AppCompat.Light.DarkActionBar">[m
[32m+[m[32m        <item name="windowActionBar">false</item>[m
[32m+[m[32m        <item name="windowNoTitle">true</item>[m
[32m+[m[32m        <item name="colorPrimary">@color/colorPrimary</item>[m
[32m+[m[32m        <!--   darker variant for the status bar and contextual app bars -->[m
[32m+[m[32m        <item name="colorPrimaryDark">@color/colorPrimaryDark</item>[m
[32m+[m[32m        <!--   theme UI controls like checkboxes and text fields -->[m
[32m+[m[32m        <item name="colorAccent">@color/colorAccent</item>[m
[32m+[m
[32m+[m[32m    </style>[m
[32m+[m[32m    <style name="Bubble.TextAppearance.Dark" parent="android:TextAppearance.Medium">[m
[32m+[m[32m        <item name="android:textSize">14sp</item>[m
[32m+[m[32m        <item name="android:textColor">#ff7f7f7f</item>[m
[32m+[m[32m    </style>[m
[32m+[m
[32m+[m[32m    <style name="Bubble.TextAppearance.Light" parent="Bubble.TextAppearance.Dark">[m
[32m+[m[32m        <item name="android:textColor">#ffeeeeee</item>[m
[32m+[m[32m    </style>[m
[32m+[m
[32m+[m[32m    <style name="ClusterIcon.TextAppearance" parent="android:TextAppearance">[m
[32m+[m[32m        <item name="android:textColor">#ffeeeeee</item>[m
[32m+[m[32m        <item name="android:textSize">16sp</item>[m
[32m+[m[32m        <item name="android:textStyle">bold</item>[m
[32m+[m[32m    </style>[m
[32m+[m[32m    <style name="AppTheme.Dialog.Alert" parent="Theme.AppCompat.Light.Dialog.Alert">[m
[32m+[m[32m    </style>[m
[32m+[m[32m    <style name="anim_menu_bottombar">[m
[32m+[m[32m        <item name="android:windowEnterAnimation">@anim/menu_bottombar_in</item>[m
[32m+[m[32m        <item name="android:windowExitAnimation">@anim/menu_bottombar_out</item>[m
[32m+[m[32m    </style>[m
[32m+[m[32m</resources>[m
[1mdiff --git a/app/src/main/res/xml/searchable.xml b/app/src/main/res/xml/searchable.xml[m
[1mnew file mode 100644[m
[1mindex 0000000..f742952[m
[1m--- /dev/null[m
[1m+++ b/app/src/main/res/xml/searchable.xml[m
[36m@@ -0,0 +1,7 @@[m
[32m+[m[32m<?xml version="1.0" encoding="utf-8"?>[m
[32m+[m[32m<searchable xmlns:android="http://schemas.android.com/apk/res/android"[m
[32m+[m[32m    android:label="@string/searchLabel" android:hint="@string/searchHint"[m
[32m+[m[32m    android:icon="@mipmap/ic_launcher"[m
[32m+[m[32m    android:queryAfterZeroResults="false"[m
[32m+[m[32m    android:searchSuggestSelection=" ? ">[m
[32m+[m[32m</searchable>[m[41m  [m
\ No newline at end of file[m
[1mdiff --git a/app/src/test/java/com/fanweilin/coordinatemap/ExampleUnitTest.java b/app/src/test/java/com/fanweilin/coordinatemap/ExampleUnitTest.java[m
[1mnew file mode 100644[m
[1mindex 0000000..eca9465[m
[1m--- /dev/null[m
[1m+++ b/app/src/test/java/com/fanweilin/coordinatemap/ExampleUnitTest.java[m
[36m@@ -0,0 +1,15 @@[m
[32m+[m[32mpackage com.fanweilin.coordinatemap;[m
[32m+[m
[32m+[m[32mimport org.junit.Test;[m
[32m+[m
[32m+[m[32mimport static org.junit.Assert.*;[m
[32m+[m
[32m+[m[32m/**[m
[32m+[m[32m * To work on unit tests, switch the Test Artifact in the Build Variants view.[m
[32m+[m[32m */[m
[32m+[m[32mpublic class ExampleUnitTest {[m
[32m+[m[32m    @Test[m
[32m+[m[32m    public void addition_isCorrect() throws Exception {[m
[32m+[m[32m        assertEquals(4, 2 + 2);[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/build.gradle b/build.gradle[m
[1mnew file mode 100644[m
[1mindex 0000000..e0b366a[m
[1m--- /dev/null[m
[1m+++ b/build.gradle[m
[36m@@ -0,0 +1,23 @@[m
[32m+[m[32m// Top-level build file where you can add configuration options common to all sub-projects/modules.[m
[32m+[m
[32m+[m[32mbuildscript {[m
[32m+[m[32m    repositories {[m
[32m+[m[32m        jcenter()[m
[32m+[m[32m    }[m
[32m+[m[32m    dependencies {[m
[32m+[m[32m        classpath 'com.android.tools.build:gradle:1.5.0'[m
[32m+[m
[32m+[m[32m        // NOTE: Do not place your application dependencies here; they belong[m
[32m+[m[32m        // in the individual module build.gradle files[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32mallprojects {[m
[32m+[m[32m    repositories {[m
[32m+[m[32m        jcenter()[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32mtask clean(type: Delete) {[m
[32m+[m[32m    delete rootProject.buildDir[m
[32m+[m[32m}[m
[1mdiff --git a/daogenerator/.gitignore b/daogenerator/.gitignore[m
[1mnew file mode 100644[m
[1mindex 0000000..796b96d[m
[1m--- /dev/null[m
[1m+++ b/daogenerator/.gitignore[m
[36m@@ -0,0 +1 @@[m
[32m+[m[32m/build[m
[1mdiff --git a/daogenerator/build.gradle b/daogenerator/build.gradle[m
[1mnew file mode 100644[m
[1mindex 0000000..ac1ad97[m
[1m--- /dev/null[m
[1m+++ b/daogenerator/build.gradle[m
[36m@@ -0,0 +1,6 @@[m
[32m+[m[32mapply plugin: 'java'[m
[32m+[m
[32m+[m[32mdependencies {[m
[32m+[m[32m    compile fileTree(dir: 'libs', include: ['*.jar'])[m
[32m+[m[32m    compile 'de.greenrobot:greendao-generator:1.3.1'[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/daogenerator/src/main/java/com/example/daogenerator.java b/daogenerator/src/main/java/com/example/daogenerator.java[m
[1mnew file mode 100644[m
[1mindex 0000000..f01c466[m
[1m--- /dev/null[m
[1m+++ b/daogenerator/src/main/java/com/example/daogenerator.java[m
[36m@@ -0,0 +1,57 @@[m
[32m+[m[32mpackage com.example;[m
[32m+[m
[32m+[m[32mimport de.greenrobot.daogenerator.DaoGenerator;[m
[32m+[m[32mimport de.greenrobot.daogenerator.Entity;[m
[32m+[m[32mimport de.greenrobot.daogenerator.Schema;[m
[32m+[m
[32m+[m[32mpublic class daogenerator {[m
[32m+[m[32m    public static void main(String[] args) throws Exception {[m
[32m+[m[32m        // 正如你所见的，你创建了一个用于添加实体（Entity）的模式（Schema）对象。[m
[32m+[m[32m        // 两个参数分别代表：数据库版本号与自动生成代码的包路径。[m
[32m+[m[32m        Schema schema = new Schema(1, "com.fanweilin.greendao");[m
[32m+[m[32m//      当然，如果你愿意，你也可以分别指定生成的 Bean 与 DAO 类所在的目录，只要如下所示：[m
[32m+[m[32m//      Schema schema = new Schema(1, "me.itangqi.bean");[m
[32m+[m[32m//      schema.setDefaultJavaPackageDao("me.itangqi.dao");[m
[32m+[m
[32m+[m[32m        // 模式（Schema）同时也拥有两个默认的 flags，分别用来标示 entity 是否是 activie 以及是否使用 keep sections。[m
[32m+[m[32m        // schema2.enableActiveEntitiesByDefault();[m
[32m+[m[32m        // schema2.enableKeepSectionsByDefault();[m
[32m+[m
[32m+[m[32m        // 一旦你拥有了一个 Schema 对象后，你便可以使用它添加实体（Entities）了。[m
[32m+[m[32m        addNote(schema);[m
[32m+[m[32m        addData(schema);[m
[32m+[m
[32m+[m[32m        // 最后我们将使用 DAOGenerator 类的 generateAll() 方法自动生成代码，此处你需要根据自己的情况更改输出目录（既之前创建的 java-gen)。[m
[32m+[m[32m        // 其实，输出目录的路径可以在 build.gradle 中设置，有兴趣的朋友可以自行搜索，这里就不再详解。[m
[32m+[m[32m        new DaoGenerator().generateAll(schema, "G:/gongzuo/ANDROID/CoordinateMap/app/src/main/java-gen");[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    /**[m
[32m+[m[32m     * @param schema[m
[32m+[m[32m     */[m
[32m+[m[32m    private static void addNote(Schema schema) {[m
[32m+[m[32m        // 一个实体（类）就关联到数据库中的一张表，此处表名为「Note」（既类名）[m
[32m+[m[32m        Entity note = schema.addEntity("Files");[m
[32m+[m[32m        // 你也可以重新给表命名[m
[32m+[m[32m        // note.setTableName("NODE");[m
[32m+[m
[32m+[m[32m        // greenDAO 会自动根据实体类的属性值来创建表字段，并赋予默认值[m
[32m+[m[32m        // 接下来你便可以设置表中的字段：[m
[32m+[m[32m        note.addIdProperty();[m
[32m+[m[32m        note.addStringProperty("title").notNull();[m
[32m+[m[32m        note.addStringProperty("path");[m
[32m+[m[32m        note.addStringProperty("date");[m
[32m+[m[32m        note.addIntProperty("cdstyle");[m
[32m+[m[32m        note.addIntProperty("datastyle");[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    private static void addData(Schema schema) {[m
[32m+[m[32m        Entity note = schema.addEntity("ShowData");[m
[32m+[m[32m        note.addIdProperty();[m
[32m+[m[32m        note.addStringProperty("title").notNull();[m
[32m+[m[32m        note.addStringProperty("latitude");[m
[32m+[m[32m        note.addStringProperty("longitude");[m
[32m+[m[32m        note.addIntProperty("cdstyle");[m
[32m+[m[32m        note.addIntProperty("datastyle");[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
[1mdiff --git a/gradle.properties b/gradle.properties[m
[1mnew file mode 100644[m
[1mindex 0000000..1d3591c[m
[1m--- /dev/null[m
[1m+++ b/gradle.properties[m
[36m@@ -0,0 +1,18 @@[m
[32m+[m[32m# Project-wide Gradle settings.[m
[32m+[m
[32m+[m[32m# IDE (e.g. Android Studio) users:[m
[32m+[m[32m# Gradle settings configured through the IDE *will override*[m
[32m+[m[32m# any settings specified in this filewarning: LF will be replaced by CRLF in app/src/main/res/layout/text_bubble.xml.
The file will have its original line endings in your working directory.
.[m
[32m+[m
[32m+[m[32m# For more details on how to configure your build environment visit[m
[32m+[m[32m# http://www.gradle.org/docs/current/userguide/build_environment.html[m
[32m+[m
[32m+[m[32m# Specifies the JVM arguments used for the daemon process.[m
[32m+[m[32m# The setting is particularly useful for tweaking memory settings.[m
[32m+[m[32m# Default value: -Xmx10248m -XX:MaxPermSize=256m[m
[32m+[m[32m# org.gradle.jvmargs=-Xmx2048m -XX:MaxPermSize=512m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8[m
[32m+[m
[32m+[m[32m# When configured, Gradle will run in incubating parallel mode.[m
[32m+[m[32m# This option should only be used with decoupled projects. More details, visit[m
[32m+[m[32m# http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects[m
[32m+[m[32m# org.gradle.parallel=true[m
\ No newline at end of file[m
[1mdiff --git a/gradlew b/gradlew[m
[1mnew file mode 100644[m
[1mindex 0000000..9d82f78[m
[1m--- /dev/null[m
[1m+++ b/gradlew[m
[36m@@ -0,0 +1,160 @@[m
[32m+[m[32m#!/usr/bin/env bash[m
[32m+[m
[32m+[m[32m##############################################################################[m
[32m+[m[32m##[m
[32m+[m[32m##  Gradle start up script for UN*X[m
[32m+[m[32m##[m
[32m+[m[32m##############################################################################[m
[32m+[m
[32m+[m[32m# Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.[m
[32m+[m[32mDEFAULT_JVM_OPTS=""[m
[32m+[m
[32m+[m[32mAPP_NAME="Gradle"[m
[32m+[m[32mAPP_BASE_NAME=`basename "$0"`[m
[32m+[m
[32m+[m[32m# Use the maximum available, or set MAX_FD != -1 to use that value.[m
[32m+[m[32mMAX_FD="maximum"[m
[32m+[m
[32m+[m[32mwarn ( ) {[m
[32m+[m[32m    echo "$*"[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32mdie ( ) {[m
[32m+[m[32m    echo[m
[32m+[m[32m    echo "$*"[m
[32m+[m[32m    echo[m
[32m+[m[32m    exit 1[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32m# OS specific support (must be 'true' or 'false').[m
[32m+[m[32mcygwin=false[m
[32m+[m[32mmsys=false[m
[32m+[m[32mdarwin=false[m
[32m+[m[32mcase "`uname`" in[m
[32m+[m[32m  CYGWIN* )[m
[32m+[m[32m    cygwin=true[m
[32m+[m[32m    ;;[m
[32m+[m[32m  Darwin* )[m
[32m+[m[32m    darwin=true[m
[32m+[m[32m    ;;[m
[32m+[m[32m  MINGW* )[m
[32m+[m[32m    msys=true[m
[32m+[m[32m    ;;[m
[32m+[m[32mesac[m
[32m+[m
[32m+[m[32m# Attempt to set APP_HOME[m
[32m+[m[32m# Resolve links: $0 may be a link[m
[32m+[m[32mPRG="$0"[m
[32m+[m[32m# Need this for relative symlinks.[m
[32m+[m[32mwhile [ -h "$PRG" ] ; do[m
[32m+[m[32m    ls=`ls -ld "$PRG"`[m
[32m+[m[32m    link=`expr "$ls" : '.*-> \(.*\)$'`[m
[32m+[m[32m    if expr "$link" : '/.*' > /dev/null; then[m
[32m+[m[32m        PRG="$link"[m
[32m+[m[32m    else[m
[32m+[m[32m        PRG=`dirname "$PRG"`"/$link"[m
[32m+[m[32m    fi[m
[32m+[m[32mdone[m
[32m+[m[32mSAVED="`pwd`"[m
[32m+[m[32mcd "`dirname \"$PRG\"`/" >/dev/null[m
[32m+[m[32mAPP_HOME="`pwd -P`"[m
[32m+[m[32mcd "$SAVED" >/dev/null[m
[32m+[m
[32m+[m[32mCLASSPATH=$APP_HOME/gradle/wrapper/gradle-wrapper.jar[m
[32m+[m
[32m+[m[32m# Determine the Java command to use to start the JVM.[m
[32m+[m[32mif [ -n "$JAVA_HOME" ] ; then[m
[32m+[m[32m    if [ -x "$JAVA_HOME/jre/sh/java" ] ; then[m
[32m+[m[32m        # IBM's JDK on AIX uses strange locations for the executables[m
[32m+[m[32m        JAVACMD="$JAVA_HOME/jre/sh/java"[m
[32m+[m[32m    else[m
[32m+[m[32m        JAVACMD="$JAVA_HOME/bin/java"[m
[32m+[m[32m    fi[m
[32m+[m[32m    if [ ! -x "$JAVACMD" ] ; then[m
[32m+[m[32m        die "ERROR: JAVA_HOME is set to an invalid directory: $JAVA_HOME[m
[32m+[m
[32m+[m[32mPlease set the JAVA_HOME variable in your environment to match the[m
[32m+[m[32mlocation of your Java installation."[m
[32m+[m[32m    fi[m
[32m+[m[32melse[m
[32m+[m[32m    JAVACMD="java"[m
[32m+[m[32m    which java >/dev/null 2>&1 || die "ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.[m
[32m+[m
[32m+[m[32mPlease set the JAVA_HOME variable in your environment to match the[m
[32m+[m[32mlocation of your Java installation."[m
[32m+[m[32mfi[m
[32m+[m
[32m+[m[32m# Increase the maximum file descriptors if we can.[m
[32m+[m[32mif [ "$cygwin" = "false" -a "$darwin" = "false" ] ; then[m
[32m+[m[32m    MAX_FD_LIMIT=`ulimit -H -n`[m
[32m+[m[32m    if [ $? -eq 0 ] ; then[m
[32m+[m[32m        if [ "$MAX_FD" = "maximum" -o "$MAX_FD" = "max" ] ; then[m
[32m+[m[32m            MAX_FD="$MAX_FD_LIMIT"[m
[32m+[m[32m        fi[m
[32m+[m[32m        ulimit -n $MAX_FD[m
[32m+[m[32m        if [ $? -ne 0 ] ; then[m
[32m+[m[32m            warn "Could not set maximum file descriptor limit: $MAX_FD"[m
[32m+[m[32m        fi[m
[32m+[m[32m    else[m
[32m+[m[32m        warn "Could not query maximum file descriptor limit: $MAX_FD_LIMIT"[m
[32m+[m[32m    fi[m
[32m+[m[32mfi[m
[32m+[m
[32m+[m[32m# For Darwin, add options to specify how the application appears in the dock[m
[32m+[m[32mif $darwin; then[m
[32m+[m[32m    GRADLE_OPTS="$GRADLE_OPTS \"-Xdock:name=$APP_NAME\" \"-Xdock:icon=$APP_HOME/media/gradle.icns\""[m
[32m+[m[32mfi[m
[32m+[m
[32m+[m[32m# For Cygwin, switch paths to Windows format before running java[m
[32m+[m[32mif $cygwin ; then[m
[32m+[m[32m    APP_HOME=`cygpath --path --mixed "$APP_HOME"`[m
[32m+[m[32m    CLASSPATH=`cygpath --path --mixed "$CLASSPATH"`[m
[32m+[m[32m    JAVACMD=`cygpath --unix "$JAVACMD"`[m
[32m+[m
[32m+[m[32m    # We build the pattern for arguments to be converted via cygpath[m
[32m+[m[32m    ROOTDIRSRAW=`find -L / -maxdepth 1 -mindepth 1 -type d 2>/dev/null`[m
[32m+[m[32m    SEP=""[m
[32m+[m[32m    for dir in $ROOTDIRSRAW ; do[m
[32m+[m[32m        ROOTDIRS="$ROOTDIRS$SEP$dir"[m
[32m+[m[32m        SEP="|"[m
[32m+[m[32m    done[m
[32m+[m[32m    OURCYGPATTERN="(^($ROOTDIRS))"[m
[32m+[m[32m    # Add a user-defined pattern to the cygpath arguments[m
[32m+[m[32m    if [ "$GRADLE_CYGPATTERN" != "" ] ; then[m
[32m+[m[32m        OURCYGPATTERN="$OURCYGPATTERN|($GRADLE_CYGPATTERN)"[m
[32m+[m[32m    fi[m
[32m+[m[32m    # Now convert the arguments - kludge to limit ourselves to /bin/sh[m
[32m+[m[32m    i=0[m
[32m+[m[32m    for arg in "$@" ; do[m
[32m+[m[32m        CHECK=`echo "$arg"|egrep -c "$OURCYGPATTERN" -`[m
[32m+[m[32m        CHECK2=`echo "$arg"|egrep -c "^-"`                                 ### Determine if an option[m
[32m+[m
[32m+[m[32m        if [ $CHECK -ne 0 ] && [ $CHECK2 -eq 0 ] ; then                    ### Added a condition[m
[32m+[m[32m            eval `echo args$i`=`cygpath --path --ignore --mixed "$arg"`[m
[32m+[m[32m        else[m
[32m+[m[32m            eval `echo args$i`="\"$arg\""[m
[32m+[m[32m        fi[m
[32m+[m[32m        i=$((i+1))[m
[32m+[m[32m    done[m
[32m+[m[32m    case $i in[m
[32m+[m[32m        (0) set -- ;;[m
[32m+[m[32m        (1) set -- "$args0" ;;[m
[32m+[m[32m        (2) set -- "$args0" "$args1" ;;[m
[32m+[m[32m        (3) set -- "$args0" "$args1" "$args2" ;;[m
[32m+[m[32m        (4) set -- "$args0" "$args1" "$args2" "$args3" ;;[m
[32m+[m[32m        (5) set -- "$args0" "$args1" "$args2" "$args3" "$args4" ;;[m
[32m+[m[32m        (6) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" ;;[m
[32m+[m[32m        (7) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" "$args6" ;;[m
[32m+[m[32m        (8) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" "$args6" "$args7" ;;[m
[32m+[m[32m        (9) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" "$args6" "$args7" "$args8" ;;[m
[32m+[m[32m    esac[m
[32m+[m[32mfi[m
[32m+[m
[32m+[m[32m# Split up the JVM_OPTS And GRADLE_OPTS values into an array, following the shell quoting and substitution rules[m
[32m+[m[32mfunction splitJvmOpts() {[m
[32m+[m[32m    JVM_OPTS=("$@")[m
[32m+[m[32m}[m
[32m+[m[32meval splitJvmOpts $DEFAULT_JVM_OPTS $JAVA_OPTS $GRADLE_OPTS[m
[32m+[m[32mJVM_OPTS[${#JVM_OPTS[*]}]="-Dorg.gradle.appname=$APP_BASE_NAME"[m
[32m+[m
[32m+[m[32mexec "$JAVACMD" "${JVM_OPTS[@]}" -classpath "$CLASSPATH" org.gradle.wrapper.GradleWrapperMain "$@"[m
[1mdiff --git a/gradlew.bat b/gradlew.bat[m
[1mnew file mode 100644[m
[1mindex 0000000..8a0b282[m
[1m--- /dev/null[m
[1m+++ b/gradlew.bat[m
[36m@@ -0,0 +1,90 @@[m
[32m+[m[32m@if "%DEBUG%" == "" @echo off[m
[32m+[m[32m@rem ##########################################################################[m
[32m+[m[32m@rem[m
[32m+[m[32m@rem  Gradle startup script for Windows[m
[32m+[m[32m@rem[m
[32m+[m[32m@rem ##########################################################################[m
[32m+[m
[32m+[m[32m@rem Set local scope for the variables with windows NT shell[m
[32m+[m[32mif "%OS%"=="Windows_NT" setlocal[m
[32m+[m
[32m+[m[32m@rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.[m
[32m+[m[32mset DEFAULT_JVM_OPTS=[m
[32m+[m
[32m+[m[32mset DIRNAME=%~dp0[m
[32m+[m[32mif "%DIRNAME%" == "" set DIRNAME=.[m
[32m+[m[32mset APP_BASE_NAME=%~n0[m
[32m+[m[32mset APP_HOME=%DIRNAME%[m
[32m+[m
[32m+[m[32m@rem Find java.exe[m
[32m+[m[32mif defined JAVA_HOME goto findJavaFromJavaHome[m
[32m+[m
[32m+[m[32mset JAVA_EXE=java.exe[m
[32m+[m[32m%JAVA_EXE% -version >NUL 2>&1[m
[32m+[m[32mif "%ERRORLEVEL%" == "0" goto init[m
[32m+[m
[32m+[m[32mecho.[m
[32m+[m[32mecho ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH.[m
[32m+[m[32mecho.[m
[32m+[m[32mecho Please set the JAVA_HOME variable in your environment to match the[m
[32m+[m[32mecho location of your Java installation.[m
[32m+[m
[32m+[m[32mgoto fail[m
[32m+[m
[32m+[m[32m:findJavaFromJavaHome[m
[32m+[m[32mset JAVA_HOME=%JAVA_HOME:"=%[m
[32m+[m[32mset JAVA_EXE=%JAVA_HOME%/bin/java.exe[m
[32m+[m
[32m+[m[32mif exist "%JAVA_EXE%" goto init[m
[32m+[m
[32m+[m[32mecho.[m
[32m+[m[32mecho ERROR: JAVA_HOME is set to an invalid directory: %JAVA_HOME%[m
[32m+[m[32mecho.[m
[32m+[m[32mecho Please set the JAVA_HOME variable in your environment to match the[m
[32m+[m[32mecho location of your Java installation.[m
[32m+[m
[32m+[m[32mgoto fail[m
[32m+[m
[32m+[m[32m:init[m
[32m+[m[32m@rem Get command-line arguments, handling Windowz variants[m
[32m+[m
[32m+[m[32mif not "%OS%" == "Windows_NT" goto win9xME_args[m
[32m+[m[32mif "%@eval[2+2]" == "4" goto 4NT_args[m
[32m+[m
[32m+[m[32m:win9xME_args[m
[32m+[m[32m@rem Slurp the command line arguments.[m
[32m+[m[32mset CMD_LINE_ARGS=[m
[32m+[m[32mset _SKIP=2[m
[32m+[m
[32m+[m[32m:win9xME_args_slurp[m
[32m+[m[32mif "x%~1" == "x" goto execute[m
[32m+[m
[32m+[m[32mset CMD_LINE_ARGS=%*[m
[32m+[m[32mgoto execute[m
[32m+[m
[32m+[m[32m:4NT_args[m
[32m+[m[32m@rem Get arguments from the 4NT Shell from JP Software[m
[32m+[m[32mset CMD_LINE_ARGS=%$[m
[32m+[m
[32m+[m[32m:execute[m
[32m+[m[32m@rem Setup the command line[m
[32m+[m
[32m+[m[32mset CLASSPATH=%APP_HOME%\gradle\wrapper\gradle-wrapper.jar[m
[32m+[m
[32m+[m[32m@rem Execute Gradle[m
[32m+[m[32m"%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %GRADLE_OPTS% "-Dorg.gradle.appname=%APP_BASE_NAME%" -classpath "%CLASSPATH%" org.gradle.wrapper.GradleWrapperMain %CMD_LINE_ARGS%[m
[32m+[m
[32m+[m[32m:end[m
[32m+[m[32m@rem End local scope for the variables with windows NT shell[m
[32m+[m[32mif "%ERRORLEVEL%"=="0" goto mainEnd[m
[32m+[m
[32m+[m[32m:fail[m
[32m+[m[32mrem Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of[m
[32m+[m[32mrem the _cmd.exe /c_ return code![m
[32m+[m[32mif  not "" == "%GRADLE_EXIT_CONSOLE%" exit 1[m
[32m+[m[32mexit /b 1[m
[32m+[m
[32m+[m[32m:mainEnd[m
[32m+[m[32mif "%OS%"=="Windows_NT" endlocal[m
[32m+[m
[32m+[m[32m:omega[m
[1mdiff --git a/settings.gradle b/settings.gradle[m
[1mnew file mode 100644[m
[1mindex 0000000..2b0e21a[m
[1m--- /dev/null[m
[1m+++ b/settings.gradle[m
[36m@@ -0,0 +1 @@[m
[32m+[m[32minclude ':app', ':daogenerator'[m
warning: LF will be replaced by CRLF in gradlew.
The file will have its original line endings in your working directory.
